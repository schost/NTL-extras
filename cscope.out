cscope 15 $HOME/Documents/Research/programs/cpp/NTL-extras               0000369404
	@ZZ_CRT/ZZ_CRT.h

1 #iâdeà
ZZ_CRT__H


2 
	#ZZ_CRT__H


	)

4 
	~<NTL/¥_¬™h.h
>

5 
	~<NTL/veùÜ.h
>

6 
	~<NTL/m©rix.h
>

7 
	~<NTL/ZZ.h
>

8 
	~<gmp.h
>

10 
NTL_CLIENT


30 
ä“_vec_gbigšt
(
Vec
<
_Ál_gbigšt
>& 
v
);

35 
z”o_vec_gbigšt
(
Vec
<
_Ál_gbigšt
>& 
v
);

47 şas 
	cZZ_CRT_»m
 {

48 
	mpublic
:

49 
n
;

50 
ZZ
 
	mp
;

51 
vœtu®
 
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
) = 0;

53 
	m´Ùeùed
:

55 
Vec
<> 
moduli
;

63 şas 
	cZZ_CRT_»m_tbl
 : 
public
 
ZZ_CRT_»m
 {

64 
public
:

65 
	$ZZ_CRT_»m_tbl
(){}

66 
	`ZZ_CRT_»m_tbl
(cÚ¡ 
Vec
<>& 
moduli
);

67 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

69 
´Ùeùed
:

70 
Vec
<
mp_limb_t
> 
šv_moduli
;

71 
M©
<
mp_limb_t
> 
tbl
;

72 
	}
};

78 şas 
	cZZ_CRT_»m_ç¡
 : 
public
 
ZZ_CRT_»m
 {

79 
public
:

80 
	$ZZ_CRT_»m_ç¡
(){}

81 
	`ZZ_CRT_»m_ç¡
(cÚ¡ 
Vec
<>& 
moduli
);

82 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

84 ~
	$ZZ_CRT_»m_ç¡
(){

85 
	`ä“_vec_gbigšt
(
´od_vec
);

86 
	`ä“_vec_gbigšt
(
»m_vec
);

87 
	}
}

89 
	g´Ùeùed
:

90 
Ëv–s
;

91 
	gvec_Ën
;

92 
	gVec
<> 
	gšdex_vec
;

93 
	gVec
<
	g_Ál_gbigšt
> 
	g´od_vec
;

94 
	gVec
<
	g_Ál_gbigšt
> 
	g»m_vec
;

95 
	gp_size
;

101 şas 
	cZZ_CRT_»m_medium
 : 
public
 
ZZ_CRT_»m
 {

102 
public
:

103 
	$ZZ_CRT_»m_medium
(){}

104 
	`ZZ_CRT_»m_medium
(cÚ¡ 
Vec
<>& 
moduli
);

105 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

107 ~
	$ZZ_CRT_»m_medium
(){

108 
	`ä“_vec_gbigšt
(
´od_vec
);

109 
	`ä“_vec_gbigšt
(
»m_vec
);

110 
	}
}

112 
	g´Ùeùed
:

113 
Ëv–s
;

114 
	gvec_Ën
;

115 
	gVec
<> 
	gšdex_vec
;

116 
	gVec
<> 
	gËn_vec
, 
	gcÜr_vec
;

117 
	gVec
<
	gmulmod_´ecÚ_t
> 
	gcÜ¿ux_vec
;

118 
	gVec
<
	gmp_limb_t
> 
	gšv_vec
;

119 
	gVec
<
	g_Ál_gbigšt
> 
	g´od_vec
;

120 
	gVec
<
	g_Ál_gbigšt
> 
	g»m_vec
;

127 şas 
	cZZ_CRT_»m_basic
 : 
public
 
ZZ_CRT_»m
 {

128 
public
:

129 
	$ZZ_CRT_»m_basic
(){}

130 
	`ZZ_CRT_»m_basic
(cÚ¡ 
Vec
<>& 
moduli
);

131 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

132 
	}
};

144 şas 
	cZZ_CRT_üt
{

145 
	mpublic
:

146 
vœtu®
 
üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
) = 0;

148 
	m´Ùeùed
:

149 
n
;

150 
ZZ
 
	mp
;

151 
	mVec
<> 
	mmoduli
;

152 
	mVec
<> 
	mmoduli_»c
;

153 
	mVec
<> 
	mu
;

154 
	mVec
<
	mmulmod_´ecÚ_t
> 
	muqšv
;

155 
ZZ_ReduûSŒuùAd­‹r
 
	m»duû_¡ruù
;

157 
make
();

158 
´emuÉly
(
Vec
<>& 
b
, cÚ¡ Vec<>& 
a
);

159 
vœtu®
 
š£¹
(
i
, 
_Ál_gbigšt
 
m
) = 0;

167 şas 
	cZZ_CRT_üt_tbl
 : 
public
 
ZZ_CRT_üt
 {

168 
public
:

169 
	$ZZ_CRT_üt_tbl
(){}

170 
	`ZZ_CRT_üt_tbl
(cÚ¡ 
Vec
<>& 
moduli
);

171 
	`üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
);

173 
´iv©e
:

174 
Vec
<Vec<
mp_limb_t
>> 
v
;

175 
sz
;

176 
	`š£¹
(
i
, 
_Ál_gbigšt
 
m
);

177 
	}
};

183 şas 
	cZZ_CRT_üt_ç¡
 : 
public
 
ZZ_CRT_üt
 {

184 
public
:

185 
	$ZZ_CRT_üt_ç¡
(){}

186 
	`ZZ_CRT_üt_ç¡
(cÚ¡ 
Vec
<>& 
moduli
);

187 
	`üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
);

189 ~
	$ZZ_CRT_üt_ç¡
(){

190 
	`ä“_vec_gbigšt
(
´od_vec
);

191 
	`ä“_vec_gbigšt
(
cÛff_vec
);

192 
	`ä“_vec_gbigšt
(
»m_vec
);

193 
	`ä“_vec_gbigšt
(
‹mps
);

194 
	}
}

196 
	g´iv©e
:

197 
Ëv–s
;

198 
	gvec_Ën
;

199 
	gVec
<> 
	gšv_vec
;

200 
	gVec
<> 
	gšdex_vec
;

201 
	gVec
<
	g_Ál_gbigšt
> 
	g´od_vec
;

202 
	gVec
<
	g_Ál_gbigšt
> 
	gcÛff_vec
;

203 
	gVec
<
	g_Ál_gbigšt
> 
	g»m_vec
;

204 
	gVec
<
	g_Ál_gbigšt
> 
	g‹mps
;

205 
	gVec
<> 
	gv®_vec
;

207 
š£¹
(
i
, 
_Ál_gbigšt
 
m
);

214 şas 
	cZZ_CRT_üt_basic
 : 
public
 
ZZ_CRT_üt
 {

215 
public
:

216 
	$ZZ_CRT_üt_basic
(){}

217 
	`ZZ_CRT_üt_basic
(cÚ¡ 
Vec
<>& 
moduli
);

218 
	`üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
);

220 ~
	$ZZ_CRT_üt_basic
(){

221 
	`ä“_vec_gbigšt
(
v
);

222 
	}
}

224 
	g´iv©e
:

225 
Vec
<
_Ál_gbigšt
> 
v
;

226 
	gsbuf
;

228 
š£¹
(
i
, 
_Ál_gbigšt
 
m
);

237 şas 
	cZZ_CRT
 {

238 
	mpublic
:

239 
ZZ_CRT
(cÚ¡ 
Vec
<>& 
moduli
);

241 
ev®
(
Vec
<>& 
x
, cÚ¡ 
ZZ
& 
a
){

242 
	m»m_¡ruù
->
ev®
(
x
, 
a
);

245 
üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
x
){

246 
	güt_¡ruù
->
üt
(
a
, 
x
);

250 
ZZ_CRT_üt
* 
	güt_¡ruù
;

251 
ZZ_CRT_»m
* 
	g»m_¡ruù
;

253 
ZZ_CRT_»m_tbl
 
	g»m_tbl
;

254 
ZZ_CRT_»m_ç¡
 
	g»m_ç¡
;

255 
ZZ_CRT_»m_medium
 
	g»m_medium
;

256 
ZZ_CRT_»m_basic
 
	g»m_basic
;

258 #ià((
defšed
(
NTL_VIABLE_LL
)è&& (defšed(
NTL_CRT_ALTCODE
))è|| ((defšed(NTL_VIABLE_LL)è&& (
	$defšed
(
NTL_CRT_ALTCODE_SMALL
)))

259 
ZZ_CRT_üt_tbl
 
üt_tbl
;

261 
ZZ_CRT_üt_ç¡
 
üt_ç¡
;

262 
ZZ_CRT_üt_basic
 
üt_basic
;

267 
	`bud_»m_¡ruù
(cÚ¡ 
Vec
<>& 
moduli
);

268 
	`bud_üt_¡ruù
(cÚ¡ 
Vec
<>& 
moduli
);

269 
	}
};

	@ZZ_CRT/ratrecon.h

1 #iâdeà
RATRECON__H


2 
	#RATRECON__H


	)

4 
	~<NTL/ZZ.h
>

5 
	~<NTL/veùÜ.h
>

7 
NTL_CLIENT


23 
šlše


24 
	$mulmod
 (
ZZ
& 
a
, cÚ¡ ZZ& 
b
, cÚ¡ ZZ& 
d
, cÚ¡ ZZ& 
m
){

25 
	`MulMod
(
a
, 
b
, 
d
, 
m
);

26 
	}
}

32 
	g‹m¶©e
 <
şass
 
	gT
>

33 
mulmod
(
Vec
<
T
>& 
a
, cÚ¡ Vec<T>& 
b
, cÚ¡ 
ZZ
& 
d
, cÚ¡ ZZ& 
m
){

34 
	gn
 = 
b
.
Ëngth
();

35 
	ga
.
S‘L’gth
(
n
);

36 
	gi
 = 0; i < 
	gn
; i++)

37 
mulmod
(
a
[
i
], 
b
[i], 
d
, 
m
);

46 
šlše


47 
boŞ
 
	$Ëss_thª
(cÚ¡ 
ZZ
& 
a
, cÚ¡ ZZ& 
bound
){

48  
	`abs
(
a
è< 
bound
;

49 
	}
}

56 
	g‹m¶©e
 <
şass
 
	gT
>

57 
boŞ
 
Ëss_thª
(cÚ¡ 
Vec
<
T
>& 
a
, cÚ¡ 
ZZ
& 
bound
){

58 
	gi
 = 0; i < 
	ga
.
Ëngth
(); i++)

59 ià(!
Ëss_thª
(
a
[
i
], 
bound
))

60  
	gçl£
;

61  
	gŒue
;

70 
šlše


71 
	$ûÁ”
(
ZZ
& 
ac
, cÚ¡ ZZ& 
a
, cÚ¡ ZZ& 
m
){

72 ià((
m
-
a
) <‡)

73 
ac
 = 
a
-
m
;

75 
ac
 = 
a
;

76 
	}
}

83 
	g‹m¶©e
 <
şass
 
	gT
>

84 
ûÁ”
(
Vec
<
T
>& 
ac
, cÚ¡ Vec<T>& 
a
, cÚ¡ 
ZZ
& 
m
){

85 
	gac
.
S‘L’gth
(
a
.
Ëngth
());

86 
	gi
 = 0; i < 
	ga
.
Ëngth
(); i++)

87 
ûÁ”
(
ac
[
i
], 
a
[i], 
m
);

95 
	g‹m¶©e
 <
şass
 
	gT
>

96 
mul
(
Vec
<
T
>& 
a
, cÚ¡ Vec<T>& 
b
, cÚ¡ 
ZZ
& 
d
){

97 
	gn
 = 
b
.
Ëngth
();

98 
	ga
.
S‘L’gth
(
n
);

99 
	gi
 = 0; i < 
	gn
; i++)

100 
mul
(
a
[
i
], 
b
[i], 
d
);

109 
šlše


110 
boŞ
 
	$check_mod
(cÚ¡ 
ZZ
& 
a
, cÚ¡ 
d’om
, cÚ¡ & 
w™Ãss
, cÚ¡ 
´ime
){

111  (
a
 % 
´ime
è=ğ
	`MulMod
(
d’om
, 
w™Ãss
,…rime);

112 
	}
}

119 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gU
>

120 
boŞ
 
check_mod
(cÚ¡ 
Vec
<
T
>& 
a
, cÚ¡ 
d’om
, cÚ¡ Vec<
U
>& 
w™Ãss
, cÚ¡ 
´ime
){

121 
	gn
 = 
a
.
Ëngth
();

122 ià(
	gw™Ãss
.
Ëngth
(è!ğ
n
)

123  
çl£
;

124 
	gi
 = 0; i < 
	gn
; i++){

125 
boŞ
 
	gb
 = 
check_mod
(
a
[
i
], 
d’om
, 
w™Ãss
[i], 
´ime
);

126 ià(
	gb
 =ğ
çl£
)

127  
çl£
;

129  
	gŒue
;

144 
šlše


145 
	$RecÚ¡ruùR©iÚ®_ªd_check
(
ZZ
& 
a
, ZZ& 
b
, cÚ¡ ZZ& 
x
, cÚ¡ ZZ& 
m
, cÚ¡ ZZ& 
h®f
, cÚ¡ ZZ& 
mo¡
,

146 cÚ¡ & 
w™Ãss
, cÚ¡ 
´ime
, 
muÉl›r
){

147 
s
 = 
	`RecÚ¡ruùR©iÚ®
(
a
, 
b
, 
x
, 
m
, 
h®f
, half);

148 ià(
s
 == 0)

150 ià((
a
 % 
´ime
è=ğ
	`MulMod
(MulMod(
b
 %…rime, 
w™Ãss
,…rime), 
muÉl›r
,…rime))

154 
	}
}

169 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gU
>

170 
RecÚ¡ruùR©iÚ®_ªd_check
(
Vec
<
T
>& 
a
, 
ZZ
& 
b
, cÚ¡ Vec<T>& 
u
, cÚ¡ ZZ& 
m
, cÚ¡ ZZ& 
h®f_´ec
, cÚ¡ ZZ& 
mo¡_´ec
,

171 cÚ¡ 
Vec
<
U
>& 
w™Ãss
, cÚ¡ 
´ime
, 
muÉl›r
){

172 
	gn
 = 
u
.
Ëngth
();

173 
	ga
.
S‘L’gth
(
n
);

175 
	gVec
<
	gZZ
> 
	gd’s
, 
	g´od
, 
	gšv_´od
;

176 
	g´od
.
S‘L’gth
(
n
+1);

177 
	g´od
[
n
] = 
to_ZZ
(1);

178 
	gd’s
.
S‘L’gth
(
n
);

180 
	gVec
<> 
	g´od_mod
;

181 
	g´od_mod
.
S‘L’gth
(
n
+1);

182 
	g´od_mod
[
n
] = 
muÉl›r
;

184 
	gVec
<
	gT
> 
	gtmp_a1
, 
	gtmp_a1_ûÁ”
, 
	gtmp_a2
;

185 
	gtmp_a1
.
S‘L’gth
(
n
);

186 
	gtmp_a1_ûÁ”
.
S‘L’gth
(
n
);

187 
	gtmp_a2
.
S‘L’gth
(
n
);

189 
	gi
 = 
n
-1; i >= 0; i--){

190 
mulmod
(
tmp_a1
[
i
], 
u
[i], 
´od
[i+1], 
m
);

191 
ûÁ”
(
tmp_a1_ûÁ”
[
i
], 
tmp_a1
[i], 
m
);

193 ià(
Ëss_thª
(
tmp_a1_ûÁ”
[
i
], 
mo¡_´ec
)){

195 
	gtmp_a2
[
i
] = 
tmp_a1_ûÁ”
[i];

196 
boŞ
 
	gboo
 = 
check_mod
(
tmp_a2
[
i
], 
´od_mod
[i+1], 
w™Ãss
[i], 
´ime
);

197 ià(
	gboo
 =ğ
çl£
)

199 
	gd’s
[
i
] = 
to_ZZ
(1);

200 
	g´od
[
i
] = 
´od
[i+1];

201 
	g´od_mod
[
i
] = 
´od_mod
[i+1];

204 
	gs
 = 
RecÚ¡ruùR©iÚ®_ªd_check
(
tmp_a2
[
i
], 
d’s
[i], 
tmp_a1
[i], 
m
, 
h®f_´ec
, 
mo¡_´ec
, 
w™Ãss
[i], 
´ime
, 
´od_mod
[i+1]);

208 ià(
	gs
 == 0)

210 
	g´od
[
i
] = 
d’s
[i]*
´od
[i+1];

211 
	g´od_mod
[
i
] = 
MulMod
(
d’s
[i] % 
´ime
, 
´od_mod
[i+1],…rime);

216 
ZZ
 
	gçc
 = 
to_ZZ
(1);

217 
	ga
[0] = 
tmp_a2
[0];

218 
	gi
 = 1; i < 
	gn
; i++){

219 
	gçc
 = 
çc
*
d’s
[
i
-1];

220 
mul
(
a
[
i
], 
tmp_a2
[i], 
çc
);

222 
	gb
 = 
´od
[0];

235 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gU
>

236 
RecÚ¡ruùR©iÚ®
(
Vec
<
T
>& 
a
, 
ZZ
& 
b
, cÚ¡ Vec<T>& 
u
, cÚ¡ ZZ& 
m
, cÚ¡ Vec<
U
>& 
w™Ãss
, cÚ¡ 
´ime
){

237 
ZZ
 
	gh®f
 = 
SqrRoÙ
(
m
/2);

238 
ZZ
 
	gmo¡
 = 
h®f
*
SqrRoÙ
(half);

240  
RecÚ¡ruùR©iÚ®_ªd_check
(
a
, 
b
, 
u
, 
m
, 
h®f
, 
mo¡
, 
w™Ãss
, 
´ime
, 1L);

	@ZZ_CRT/src/ZZ_CRT.cpp

1 
	~<NTL/¥_¬™h.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/ZZ.h
>

5 
	~<gmp.h
>

7 
	~"ZZ_CRT.h
"

9 
	gNTL_CLIENT


25 
	#NTL_MAX_REM_TBL
 800

	)

26 
	#NTL_MIN_REM_FAST
 256

	)

27 
	#NTL_MIN_REM_MEDIUM
 32

	)

29 
	#NTL_MAX_CRT_TBL
 600

	)

40 
ä“_vec_gbigšt
(
Vec
<
_Ál_gbigšt
>& 
v
){

41 
	gi
 = 0; i < 
	gv
.
Ëngth
(); i++)

42 
_Ál_gä“
(&
v
[
i
]);

48 
z”o_vec_gbigšt
(
Vec
<
_Ál_gbigšt
>& 
v
){

49 
	gi
 = 0; i < 
	gv
.
Ëngth
(); i++)

50 
	gv
[
i
] = 0;

57 
šlše
 & 
	$ALLOC
(
_Ál_gbigšt
 
p
) {

58  (((*è
p
)[0]);

59 
	}
}

62 
šlše
 & 
	$SIZE
(
_Ál_gbigšt
 
p
) {

63  (((*è
p
)[1]);

64 
	}
}

67 
šlše
 
mp_limb_t
 * 
	$DATA
(
_Ál_gbigšt
 
p
) {

68  ((
mp_limb_t
 *è(((*è(
p
)) + 2));

69 
	}
}

75 
šlše
 
	$STRIP
(& 
sz
, 
mp_limb_t
 *
p
) {

76 
i
;

77 
i
 = 
sz
 - 1;

78 
i
 >ğ0 && 
p
[i] == 0) i--;

79 
sz
 = 
i
 + 1;

80 
	}
}

86 
šlše
 
	$ZEROP
(
_Ál_gbigšt
 
p
) {

87  !
p
 || !
	`SIZE
(p);

88 
	}
}

94 
šlše
 
	$Mu¡AÎoc
(
_Ál_gbigšt
 
c
, 
Ën
) {

95  (!(
c
è|| (
	`ALLOC
(cè>> 2è< (
Ën
));

96 
	}
}

102 
mp_limb_t
 
	$Ãg_šv_mod_limb
(
mp_limb_t
 
m0
) {

103 
mp_limb_t
 
x
;

104 
k
;

106 
x
 = 1;

107 
k
 = 1;

108 
k
 < 
NTL_ZZ_NBITS
) {

109 
x
 +ğx * (1 - x * 
m0
);

110 
k
 <<= 1;

112  - 
x
;

113 
	}
}

118 
	$S³cŸlPow”
(
e
, 
p
) {

119 
a
;

120 
x
, 
y
;

122 
a
 = (è((((
mp_limb_t
è1è<< (
NTL_ZZ_NBITS
-2)è% ((mp_limb_tè
p
));

123 
a
 = 
	`MulMod
×, 2, 
p
);

124 
a
 = 
	`MulMod
×, 2, 
p
);

126 
x
 = 1;

127 
y
 = 
a
;

128 
e
) {

129 ià(
e
 & 1è
x
 = 
	`MulMod
(x, 
y
, 
p
);

130 
y
 = 
	`MulMod
(y, y, 
p
);

131 
e
 =ƒ >> 1;

134  
x
;

135 
	}
}

140 
	$¥_ext_euş
(*
dd
, *
ss
, *
‰
, 
a
, 
b
){

141 
u
, 
v
, 
u0
, 
v0
, 
u1
, 
v1
, 
u2
, 
v2
, 
q
, 
r
;

143 
ªeg
 = 0, 
bÃg
 = 0;

145 ià(
a
 < 0) {

146 ià(
a
 < -
NTL_MAX_LONG
è
	`ResourûE¼Ü
("integer overflow");

147 
a
 = -a;

148 
ªeg
 = 1;

151 ià(
b
 < 0) {

152 ià(
b
 < -
NTL_MAX_LONG
è
	`ResourûE¼Ü
("integer overflow");

153 
b
 = -b;

154 
bÃg
 = 1;

157 
u1
=1; 
v1
=0;

158 
u2
=0; 
v2
=1;

159 
u
 = 
a
; 
v
 = 
b
;

161 
v
 != 0) {

162 
q
 = 
u
 / 
v
;

163 
r
 = 
u
 % 
v
;

164 
u
 = 
v
;

165 
v
 = 
r
;

166 
u0
 = 
u2
;

167 
v0
 = 
v2
;

168 
u2
 = 
u1
 - 
q
*u2;

169 
v2
 = 
v1
- 
q
*v2;

170 
u1
 = 
u0
;

171 
v1
 = 
v0
;

174 ià(
ªeg
)

175 
u1
 = -u1;

177 ià(
bÃg
)

178 
v1
 = -v1;

180 *
dd
 = 
u
;

181 *
ss
 = 
u1
;

182 *
‰
 = 
v1
;

183 
	}
}

188 
	$¥_šv_mod
(
a
, 
n
){

189 
d
, 
s
, 
t
;

191 
	`¥_ext_euş
(&
d
, &
s
, &
t
, 
a
, 
n
);

192 ià(
d
 !ğ1è
	`Ar™hm‘icE¼Ü
("inverse undefined");

193 ià(
s
 < 0)

194  
s
 + 
n
;

196  
s
;

197 
	}
}

202 
	$»dc
(
_Ál_gbigšt
 
T
, _Ál_gbigšˆ
N
, 
m
, 
mp_limb_t
 
šv
, _Ál_gbigšˆ
»s
) {

203 
n
, 
sT
, 
i
;

204 
mp_limb_t
 *
Nd©a
, *
Td©a
, *
»sd©a
, 
q
, 
d
, 
t
, 
c
;

206 
n
 = 
	`SIZE
(
N
);

207 
Nd©a
 = 
	`DATA
(
N
);

208 
sT
 = 
	`SIZE
(
T
);

209 
Td©a
 = 
	`DATA
(
T
);

210 
»sd©a
 = 
	`DATA
(
»s
);

212 
i
 = 
sT
; i < 
m
+
n
; i++)

213 
Td©a
[
i
] = 0;

215 
c
 = 0;

216 
i
 = 0; i < 
m
; i++) {

217 
q
 = 
Td©a
[
i
]*
šv
;

218 
d
 = 
	`m²_addmul_1
(
Td©a
+
i
, 
Nd©a
, 
n
, 
q
);

220 
t
 = 
Td©a
[
i
+
n
] + 
d
;

221 
Td©a
[
i
+
n
] = 
t
 + 
c
;

222 ià(
t
 < 
d
 || (
c
 == 1 && + c == 0))

223 
c
 = 1;

225 
c
 = 0;

228 ià(
c
) {

229 
	`m²_sub_n
(
»sd©a
, 
Td©a
 + 
m
, 
Nd©a
, 
n
);

232 
i
 = 0; i < 
n
; i++)

233 
»sd©a
[
i
] = 
Td©a
[
m
 + i];

236 
i
 = 
n
;

237 
	`STRIP
(
i
, 
»sd©a
);

239 
	`SIZE
(
»s
èğ
i
;

240 
	`SIZE
(
T
) = 0;

241 
	}
}

246 
	$gadd_mul_mªy
(
_Ál_gbigšt
 *
»s
, _Ál_gbigšˆ*
a
, *
b
, 
n
, 
sz
){

247 
mp_limb_t
 *
xx
, *
yy
;

248 
i
, 
sx
;

249 
sy
;

250 
mp_limb_t
 
ÿ¼y
;

252 
sx
 = 
sz
 + 2;

253 ià(
	`Mu¡AÎoc
(*
»s
, 
sx
))

254 
	`_Ál_g£’gth
(
»s
, 
sx
);

256 
xx
 = 
	`DATA
(*
»s
);

258 
i
 = 0; i < 
sx
; i++)

259 
xx
[
i
] = 0;

261 
i
 = 0; i < 
n
; i++) {

262 ià(!
a
[
i
]) ;

264 
yy
 = 
	`DATA
(
a
[
i
]);

265 
sy
 = 
	`SIZE
(
a
[
i
]);

267 ià(!
sy
 || !
b
[
i
]) ;

269 
ÿ¼y
 = 
	`m²_addmul_1
(
xx
, 
yy
, 
sy
, 
b
[
i
]);

270 
yy
 = 
xx
 + 
sy
;

271 *
yy
 +ğ
ÿ¼y
;

273 ià(*
yy
 < 
ÿ¼y
) {

275 
yy
++;

276 *
yy
 += 1;

277 } *
yy
 == 0);

281 
sx
 > 0 && 
xx
[sx-1] == 0) sx--;

282 
	`SIZE
(*
»s
èğ
sx
;

283 
	}
}

288 
šlše


289 
mp_limb_t
 
	$tbl_»d_21
(
mp_limb_t
 
hi
, mp_limb_ˆ
lo
, 
d
, mp_limb_ˆ
dšv
) {

290 
H
 = (
hi
 << (
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
)è| (
lo
 >> NTL_SP_NBITS);

291 
Q
 = 
	`MulHiUL
(
H
, 
dšv
) + H;

292 
¼
 = 
lo
 - 
Q
*
	`ÿ¡_unsigÃd
(
d
);

293 
r
 = 
	`¥_CÜ»ùExûss
(
¼
, 2*
d
);

294 
r
 = 
	`¥_CÜ»ùExûss
Ô, 
d
);

295  
r
;

296 
	}
}

302 
šlše


303 
mp_limb_t
 
	$tbl_»d_31
(
mp_limb_t
 
x2
, mp_limb_ˆ
x1
, mp_limb_ˆ
x0
, 
d
, mp_limb_ˆ
dšv
) {

304 
mp_limb_t
 
ÿ¼y
 = 
	`tbl_»d_21
(
x2
, 
x1
, 
d
, 
dšv
);

305  
	`tbl_»d_21
(
ÿ¼y
, 
x0
, 
d
, 
dšv
);

306 
	}
}

315 
	$gmod_sim¶e
(
_Ál_gbigšt
 
a
, _Ál_gbigšˆ
d
, _Ál_gbigšˆ*
¼
) {

316 
_Ál_gbigšt
 
b
 = 0;

318 
§
, 
sb
, 
sd
, 
¤
;

319 
mp_limb_t
 *
ad©a
, *
dd©a
, *
bd©a
, *
rd©a
;

320 
_Ál_gbigšt
 
r
;

322 ià(
	`ZEROP
(
a
)) {

323 
	`_Ál_gz”o
(
¼
);

327 
§
 = 
	`SIZE
(
a
);

328 
sd
 = 
	`SIZE
(
d
);

330 ià(
§
 < 
sd
) {

331 
	`_Ál_gcİy
(
a
, 
¼
);

335 
sb
 = 
§
-
sd
+1;

336 ià(
	`Mu¡AÎoc
(
b
, 
sb
))

337 
	`_Ál_g£’gth
(&
b
, 
sb
);

339 
¤
 = 
sd
;

340 
r
 = *
¼
;

342 
ad©a
 = 
	`DATA
(
a
);

343 
dd©a
 = 
	`DATA
(
d
);

344 
bd©a
 = 
	`DATA
(
b
);

345 
rd©a
 = 
	`DATA
(
r
);

347 
	`m²_tdiv_qr
(
bd©a
, 
rd©a
, 0, 
ad©a
, 
§
, 
dd©a
, 
sd
);

349 
	`STRIP
(
¤
, 
rd©a
);

350 
	`SIZE
(
r
èğ
¤
;

352 
	`_Ál_gä“
(&
b
);

353 
	}
}

366 
	gZZ_CRT_»m_tbl
::
ZZ_CRT_»m_tbl
(cÚ¡ 
Vec
<>& 
q
){

368 ià(
q
.
Ëngth
(è> 
NTL_MAX_REM_TBL
)

371 
	gi
, 
	gj
;

372 
	gqq
, 
	gt
, 
	gt1
;

374 
	gmoduli
 = 
q
;

375 
	gn
 = 
moduli
.
Ëngth
();

377 
	gp
 = 
to_ZZ
(1);

378 
	gi
 = 0; i < 
	gn
; i++)

379 
	gp
 *ğ
moduli
[
i
];

380 
	gsz
 = 
SIZE
(
p
.
»p
);

382 
	gšv_moduli
.
S‘L’gth
(
n
);

383 
	gi
 = 0; i < 
	gn
; i++)

384 
	gšv_moduli
[
i
] = (èĞ((((
NTL_ULL_TYPE
è1è<< (
NTL_SP_NBITS
+
NTL_BITS_PER_LONG
))-1ULè/ ((NTL_ULL_TYPEè
moduli
[i]) );

386 
	gtbl
.
S‘Dims
(
n
, 
sz
);

388 
	gi
 = 0; i < 
	gn
; i++) {

389 
	gqq
 = 
moduli
[
i
];

390 
	gt
 = 1;

391 
	gj
 = 0; j < 
	gNTL_ZZ_NBITS
; j++) {

392 
	gt
 +ğ
t
;

393 ià(
	gt
 >ğ
qq
è
t
 -= qq;

395 
	gt1
 = 1;

396 
	gtbl
[
i
][0] = 1;

397 
	gj
 = 1; j < 
	gsz
; j++) {

398 
	gt1
 = 
MulMod
(
t1
, 
t
, 
qq
);

399 
	gtbl
[
i
][
j
] = 
t1
;

409 #ià(
NTL_SP_NBITS
 =ğ
NTL_BITS_PER_LONG
-2)

410 
	gZZ_CRT_»m_tbl
::
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
) {

412 
	gx_vec
.
S‘L’gth
(
n
);

413 * 
	gx
 = 
x_vec
.
_vec__»p
;

414 
ZZ
 
	ga_»m
 = 
a_ZZ
 % 
p
;

415 
_Ál_gbigšt
 
	ga
 = 
a_»m
.
»p
;

417 ià(
ZEROP
(
a
)) {

418 
	gi
;

419 
	gi
 = 0; i < 
	gn
; i++è
	gx
[
i
] = 0;

423 
	g§
 = 
SIZE
(
a
);

424 
mp_limb_t
 *
	gad©a
 = 
DATA
(
a
);

426 ià(
	g§
 <= 4) {

427 
i
;

428 
	gi
 = 0; i < 
	gn
; i++) {

429 
mp_limb_t
 *
	g
 = 
tbl
[
i
].
»p
;

430 
NTL_ULL_TYPE
 
	gacc
 = 
ad©a
[0];

431 
	gj
;

432 
	gj
 = 1; j < 
	g§
; j++)

433 
	gacc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[
j
]è* ((NTL_ULL_TYPEè

[j]);

435 
mp_limb_t
 
	gaccvec
[2];

436 
	gx
[
i
] = 
tbl_»d_31
(0, 
acc
 >> 
NTL_BITS_PER_LONG
,‡cc, 
moduli
[i], 
šv_moduli
[i]);

440 
	gi
;

441 
	gi
 = 0; i < 
	gn
; i++) {

442 
mp_limb_t
 *
	g­
 = 
ad©a
;

443 
mp_limb_t
 *
	g
 = 
tbl
[
i
].
»p
;

445 
NTL_ULL_TYPE
 
	gacc21
;

446 
mp_limb_t
 
	gacc0
;

449 
NTL_ULL_TYPE
 
	gsum
 = 
­
[0];

450 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè

[1]);

451 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè

[2]);

452 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè

[3]);

454 
	gacc21
 = 
sum
 >> 
NTL_BITS_PER_LONG
;

455 
	gacc0
 = 
sum
;

458 
	gm
=
§
-4;

459 
	g­
 += 4;

460 
	g
 += 4;

462 ; 
	gm
 >ğ8; m -ğ8, 
	g­
 +ğ8, 
	g
 += 8) {

464 
NTL_ULL_TYPE
 
sum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè

[0]);

465 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè

[1]);

466 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè

[2]);

467 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè

[3]);

469 
	gsum
 +ğ
acc0
;

470 
	gacc0
 = 
sum
;

471 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

475 
NTL_ULL_TYPE
 
	gsum
 = ((NTL_ULL_TYPEè
­
[4+0]è* ((NTL_ULL_TYPEè

[4+0]);

476 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4+1]è* ((NTL_ULL_TYPEè

[4+1]);

477 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4+2]è* ((NTL_ULL_TYPEè

[4+2]);

478 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4+3]è* ((NTL_ULL_TYPEè

[4+3]);

480 
	gsum
 +ğ
acc0
;

481 
	gacc0
 = 
sum
;

482 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

486 ; 
	gm
 >ğ4; m -ğ4, 
	g­
 +ğ4, 
	g
 += 4) {

487 
NTL_ULL_TYPE
 
sum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè

[0]);

488 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè

[1]);

489 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè

[2]);

490 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè

[3]);

492 
	gsum
 +ğ
acc0
;

493 
	gacc0
 = 
sum
;

494 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

497 ià(
	gm
 > 0) {

498 
NTL_ULL_TYPE
 
	gsum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè

[0]);

499 
	gm
--, 
	g­
++, 
	g
++; m > 0; m--,‡p++,p++)

500 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[0]è* ((NTL_ULL_TYPEè

[0]);

502 
	gsum
 +ğ
acc0
;

503 
	gacc0
 = 
sum
;

504 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

507 
	gx
[
i
] = 
tbl_»d_31
(
acc21
 >> 
NTL_BITS_PER_LONG
,‡cc21, 
acc0
, 
moduli
[i], 
šv_moduli
[i]);

520 
	#TBL_UNROLL
 (1)

	)

521 
	gZZ_CRT_»m_tbl
::
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
) {

522 
	gx_vec
.
S‘L’gth
(
n
);

523 * 
	gx
 = 
x_vec
.
_vec__»p
;

524 
ZZ
 
	ga_»m
 = 
a_ZZ
 % 
p
;

525 
_Ál_gbigšt
 
	ga
 = 
a_»m
.
»p
;

527 ià(
ZEROP
(
a
)) {

528 
	gi
;

529 
	gi
 = 0; i < 
	gn
; i++è
	gx
[
i
] = 0;

533 
	g§
 = 
SIZE
(
a
);

534 
mp_limb_t
 *
	gad©a
 = 
DATA
(
a
);

536 cÚ¡ 
	gBnd
 = 1L << (
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
);

538 ià(
	g§
 <ğ
Bnd
) {

539 
i
;

540 
	gi
 = 0; i < 
	gn
; i++) {

541 
mp_limb_t
 *
	g
 = 
tbl
[
i
].
_vec__»p
;

544 
NTL_ULL_TYPE
 
	gacc
 = 
ad©a
[0];

546 #ià(
TBL_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

547 
	g§
) {

548 16: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[16-1]è* ((NTL_ULL_TYPEè

[16-1]);

549 15: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[15-1]è* ((NTL_ULL_TYPEè

[15-1]);

550 14: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[14-1]è* ((NTL_ULL_TYPEè

[14-1]);

551 13: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[13-1]è* ((NTL_ULL_TYPEè

[13-1]);

552 12: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[12-1]è* ((NTL_ULL_TYPEè

[12-1]);

553 11: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[11-1]è* ((NTL_ULL_TYPEè

[11-1]);

554 10: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[10-1]è* ((NTL_ULL_TYPEè

[10-1]);

555 9: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[9-1]è* ((NTL_ULL_TYPEè

[9-1]);

556 8: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[8-1]è* ((NTL_ULL_TYPEè

[8-1]);

557 7: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[7-1]è* ((NTL_ULL_TYPEè

[7-1]);

558 6: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[6-1]è* ((NTL_ULL_TYPEè

[6-1]);

559 5: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[5-1]è* ((NTL_ULL_TYPEè

[5-1]);

560 4: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[4-1]è* ((NTL_ULL_TYPEè

[4-1]);

561 3: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[3-1]è* ((NTL_ULL_TYPEè

[3-1]);

562 2: 
acc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[2-1]è* ((NTL_ULL_TYPEè

[2-1]);

566 
	gj
;

567 
	gj
 = 1; j < 
	g§
; j++)

568 
	gacc
 +ğ((
NTL_ULL_TYPE
è
ad©a
[
j
]è* ((NTL_ULL_TYPEè

[j]);

571 
	gx
[
i
] = 
tbl_»d_31
(0, 
acc
 >> 
NTL_ZZ_NBITS
,‡cc, 
moduli
[i], 
šv_moduli
[i]);

575 
	gi
;

576 
	gi
 = 0; i < 
	gn
; i++) {

577 
mp_limb_t
 *
	g­
 = 
ad©a
;

578 
mp_limb_t
 *
	g
 = 
tbl
[
i
].
_vec__»p
;

580 
NTL_ULL_TYPE
 
	gacc21
;

581 
mp_limb_t
 
	gacc0
;

584 
NTL_ULL_TYPE
 
	gsum
 = 
­
[0];

586 #ià(
TBL_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

587 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè

[1]);

588 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè

[2]);

589 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè

[3]);

590 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4]è* ((NTL_ULL_TYPEè

[4]);

591 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[5]è* ((NTL_ULL_TYPEè

[5]);

592 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[6]è* ((NTL_ULL_TYPEè

[6]);

593 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[7]è* ((NTL_ULL_TYPEè

[7]);

594 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[8]è* ((NTL_ULL_TYPEè

[8]);

595 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[9]è* ((NTL_ULL_TYPEè

[9]);

596 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[10]è* ((NTL_ULL_TYPEè

[10]);

597 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[11]è* ((NTL_ULL_TYPEè

[11]);

598 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[12]è* ((NTL_ULL_TYPEè

[12]);

599 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[13]è* ((NTL_ULL_TYPEè

[13]);

600 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[14]è* ((NTL_ULL_TYPEè

[14]);

601 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[15]è* ((NTL_ULL_TYPEè

[15]);

603 
	gj
 = 1; j < 
	gBnd
; j++)

604 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[
j
]è* ((NTL_ULL_TYPEè

[j]);

607 
	gacc21
 = 
sum
 >> 
NTL_BITS_PER_LONG
;

608 
	gacc0
 = 
sum
;

611 
	gm
;

612 
	gm
 = 
§
-
Bnd
, 
	g­
 +ğBnd, 
	g
 += Bnd; m >= Bnd; m -= Bnd,‡p += Bnd,p += Bnd) {

614 
NTL_ULL_TYPE
 
sum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè

[0]);

616 #ià(
TBL_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

617 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè

[1]);

618 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè

[2]);

619 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè

[3]);

620 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4]è* ((NTL_ULL_TYPEè

[4]);

621 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[5]è* ((NTL_ULL_TYPEè

[5]);

622 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[6]è* ((NTL_ULL_TYPEè

[6]);

623 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[7]è* ((NTL_ULL_TYPEè

[7]);

624 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[8]è* ((NTL_ULL_TYPEè

[8]);

625 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[9]è* ((NTL_ULL_TYPEè

[9]);

626 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[10]è* ((NTL_ULL_TYPEè

[10]);

627 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[11]è* ((NTL_ULL_TYPEè

[11]);

628 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[12]è* ((NTL_ULL_TYPEè

[12]);

629 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[13]è* ((NTL_ULL_TYPEè

[13]);

630 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[14]è* ((NTL_ULL_TYPEè

[14]);

631 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[15]è* ((NTL_ULL_TYPEè

[15]);

633 
	gj
 = 1; j < 
	gBnd
; j++)

634 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[
j
]è* ((NTL_ULL_TYPEè

[j]);

636 
	gsum
 +ğ
acc0
;

637 
	gacc0
 = 
sum
;

638 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

641 ià(
	gm
 > 0) {

642 
NTL_ULL_TYPE
 
	gsum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè

[0]);

644 #ià(
TBL_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

645 
	gm
) {

646 15: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[15-1]è* ((NTL_ULL_TYPEè

[15-1]);

647 14: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[14-1]è* ((NTL_ULL_TYPEè

[14-1]);

648 13: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[13-1]è* ((NTL_ULL_TYPEè

[13-1]);

649 12: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[12-1]è* ((NTL_ULL_TYPEè

[12-1]);

650 11: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[11-1]è* ((NTL_ULL_TYPEè

[11-1]);

651 10: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[10-1]è* ((NTL_ULL_TYPEè

[10-1]);

652 9: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[9-1]è* ((NTL_ULL_TYPEè

[9-1]);

653 8: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[8-1]è* ((NTL_ULL_TYPEè

[8-1]);

654 7: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[7-1]è* ((NTL_ULL_TYPEè

[7-1]);

655 6: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[6-1]è* ((NTL_ULL_TYPEè

[6-1]);

656 5: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[5-1]è* ((NTL_ULL_TYPEè

[5-1]);

657 4: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[4-1]è* ((NTL_ULL_TYPEè

[4-1]);

658 3: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[3-1]è* ((NTL_ULL_TYPEè

[3-1]);

659 2: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[2-1]è* ((NTL_ULL_TYPEè

[2-1]);

662 
	gm
--, 
	g­
++, 
	g
++; m > 0; m--,‡p++,p++)

663 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[0]è* ((NTL_ULL_TYPEè

[0]);

665 
	gsum
 +ğ
acc0
;

666 
	gacc0
 = 
sum
;

667 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

670 
	gx
[
i
] = 
tbl_»d_31
(
acc21
 >> 
NTL_BITS_PER_LONG
,‡cc21, 
acc0
, 
moduli
[i], 
šv_moduli
[i]);

681 
	gZZ_CRT_»m_ç¡
::
ZZ_CRT_»m_ç¡
(cÚ¡ 
Vec
<>& 
q
){

683 ià(
q
.
Ëngth
(è< 
NTL_MIN_REM_FAST
)

686 
	gi
, 
	gj
;

688 
	gmoduli
 = 
q
;

689 
	gn
 = 
moduli
.
Ëngth
();

691 
	gp
 = 
to_ZZ
(1);

692 
	gi
 = 0; i < 
	gn
; i++)

693 
	gp
 *ğ
moduli
[
i
];

695 
	gp_size
 = 
_Ál_gsize
(
p
.
»p
);

696 
	gËv–s
 = 0;

697 (
	gn
 >> 
	gËv–s
è>ğ4è
Ëv–s
++;

699 
	gvec_Ën
 = (1L << 
Ëv–s
) - 1;

701 
	gšdex_vec
.
S‘L’gth
(
vec_Ën
+1);

702 
	g´od_vec
.
S‘L’gth
(
vec_Ën
);

703 
	gi
 = 0; i < 
	gvec_Ën
; i++)

704 
	g´od_vec
[
i
] = 0;

706 
	gšdex_vec
[0] = 0;

707 
	gšdex_vec
[1] = 
n
;

709 
	gi
 = 0; i <ğ
Ëv–s
-2; i++) {

710 
	g¡¬t
 = (1L << 
i
) - 1;

711 
	gfšish
 = (1L << (
i
+1)) - 2;

712 
	gj
 = 
fšish
; j >ğ
¡¬t
; j--) {

713 
	gšdex_vec
[2*
j
+2] = 
šdex_vec
[j] + (index_vec[j+1] - index_vec[j])/2;

714 
	gšdex_vec
[2*
j
+1] = 
šdex_vec
[j];

716 
	gšdex_vec
[2*
fšish
+3] = 
n
;

719 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

724 
_Ál_gÚe
(&
´od_vec
[
i
]);

725 
	gj
 = 
šdex_vec
[
i
]; j < 
	gšdex_vec
[i+1]; j++)

726 
_Ál_gsmul
(
´od_vec
[
i
], 
moduli
[
j
], &prod_vec[i]);

729 
	gi
 = (1L << (
Ëv–s
-1)) - 2; i >= 3; i--)

730 
_Ál_gmul
(
´od_vec
[2*
i
+1],…rod_vec[2*i+2], &prod_vec[i]);

732 
	g»m_vec
.
S‘L’gth
(
vec_Ën
);

733 
	gi
 = 0; i < 
	gvec_Ën
; i++)

734 
	g»m_vec
[
i
] = 0;

736 
_Ál_g£’gth
(&
»m_vec
[1], 
p_size
);

737 
_Ál_g£’gth
(&
»m_vec
[2], 
p_size
);

740 
	gi
 = 1; i < (1L << (
	gËv–s
-1)) - 1; i++) {

741 
_Ál_g£’gth
(&
»m_vec
[2*
i
+1], 
_Ál_gsize
(
´od_vec
[2*i+1]));

742 
_Ál_g£’gth
(&
»m_vec
[2*
i
+2], 
_Ál_gsize
(
´od_vec
[2*i+2]));

749 
	gZZ_CRT_»m_ç¡
::
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
){

751 
	gx_vec
.
S‘L’gth
(
n
);

752 * 
	gx
 = 
x_vec
.
_vec__»p
;

753 
ZZ
 
	ga_»m
 = 
a_ZZ
 % 
p
;

754 
_Ál_gbigšt
 
	ga
 = 
a_»m
.
»p
;

756 
	gi
, 
	gj
;

758 ià(
ZEROP
(
a
)) {

759 
	gj
 = 0; j < 
	gn
; j++)

760 
	gx
[
j
] = 0;

765 
_Ál_gcİy
(
a
, &
»m_vec
[1]);

766 
_Ál_gcİy
(
a
, &
»m_vec
[2]);

768 
	gi
 = 1; i < (1L << (
	gËv–s
-1)) - 1; i++) {

769 
gmod_sim¶e
(
»m_vec
[
i
], 
´od_vec
[2*i+1], &rem_vec[2*i+1]);

770 
gmod_sim¶e
(
»m_vec
[
i
], 
´od_vec
[2*i+2], &rem_vec[2*i+2]);

773 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

774 
	glo
 = 
šdex_vec
[
i
];

775 
	ghi
 = 
šdex_vec
[
i
+1];

776 
mp_limb_t
 *
	gs1p
 = 
DATA
(
»m_vec
[
i
]);

778 
	gs1size
 = 
SIZE
(
»m_vec
[
i
]);

779 ià(
	gs1size
 == 0) {

780 
j
 = 
lo
; 
	gj
 <
	ghi
; j++)

781 
	gx
[
j
] = 0;

784 
	gj
 = 
lo
; j < 
	ghi
; j++)

785 
	gx
[
j
] = 
m²_mod_1
(
s1p
, 
s1size
, 
moduli
[j]);

795 
	gZZ_CRT_»m_medium
::
ZZ_CRT_»m_medium
(cÚ¡ 
Vec
<>& 
q
){

797 ià(
q
.
Ëngth
(è< 
NTL_MIN_REM_MEDIUM
)

799 ià(
	gq
.
Ëngth
(è>ğ
NTL_MIN_REM_FAST
)

802 
	gi
, 
	gj
;

804 
	gmoduli
 = 
q
;

805 
	gn
 = 
moduli
.
Ëngth
();

807 
	gp
 = 
to_ZZ
(1);

808 
	gi
 = 0; i < 
	gn
; i++)

809 
	gp
 *ğ
moduli
[
i
];

811 
	gËv–s
 = 0;

812 (
	gn
 >> 
	gËv–s
) >= 4)

813 
Ëv–s
++;

814 
	gvec_Ën
 = (1L << 
Ëv–s
) - 1;

816 
	gšdex_vec
.
S‘L’gth
(
vec_Ën
+1);

817 
	gËn_vec
.
S‘L’gth
(
vec_Ën
);

818 
	gšv_vec
.
S‘L’gth
(
vec_Ën
);

819 
	gcÜr_vec
.
S‘L’gth
(
n
);

820 
	gcÜ¿ux_vec
.
S‘L’gth
(
n
);

822 
	g´od_vec
.
S‘L’gth
(
vec_Ën
);

823 
z”o_vec_gbigšt
(
´od_vec
);

825 
	gšdex_vec
[0] = 0;

826 
	gšdex_vec
[1] = 
n
;

828 
	gi
 = 0; i <ğ
Ëv–s
-2; i++) {

829 
	g¡¬t
 = (1L << 
i
) - 1;

830 
	gfšish
 = (1L << (
i
+1)) - 2;

831 
	gj
 = 
fšish
; j >ğ
¡¬t
; j--) {

832 
	gšdex_vec
[2*
j
+2] = 
šdex_vec
[j] + (index_vec[j+1] - index_vec[j])/2;

833 
	gšdex_vec
[2*
j
+1] = 
šdex_vec
[j];

835 
	gšdex_vec
[2*
fšish
+3] = 
n
;

838 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

842 
_Ál_gÚe
(&
´od_vec
[
i
]);

843 
	gj
 = 
šdex_vec
[
i
]; j < 
	gšdex_vec
[i+1]; j++)

844 
_Ál_gsmul
(
´od_vec
[
i
], 
moduli
[
j
], &prod_vec[i]);

847 
	gi
 = (1L << (
Ëv–s
-1)) - 2; i >= 3; i--){

848 
_Ál_gmul
(
´od_vec
[2*
i
+1],…rod_vec[2*i+2], &prod_vec[i]);

851 
	gi
 = 3; i < 
	gvec_Ën
; i++)

852 
	gËn_vec
[
i
] = 
_Ál_gsize
(
´od_vec
[i]);

859 
	gj
 = 
_Ál_gsize
(
p
.
»p
);

860 
	gi
 = 3; i <= 6; i++)

861 ià(
	gËn_vec
[
i
] > 
	gj
èj = 
Ën_vec
[i];

862 
	gËn_vec
[1] = 
Ën_vec
[2] = 
j
;

864 
	gi
 = 3; i < 
	gvec_Ën
; i++)

865 
	gšv_vec
[
i
] = 
Ãg_šv_mod_limb
(
DATA
(
´od_vec
[i])[0]);

868 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

869 
	gj
 = 
šdex_vec
[
i
]; j < 
	gšdex_vec
[i+1]; j++) {

870 
	gcÜr_vec
[
j
] = 
S³cŸlPow”
(
Ën_vec
[1] -†’_vec[
i
], 
moduli
[j]);

871 
	gcÜ¿ux_vec
[
j
] = 
P»pMulModP»cÚ
(
cÜr_vec
[j], 
moduli
[j]);

876 
	g»m_vec
.
S‘L’gth
(
vec_Ën
);

877 
	gi
 = 0; i < 
	gvec_Ën
; i++)

878 
	g»m_vec
[
i
] = 0;

880 
_Ál_g£’gth
(&
»m_vec
[0], 
Ën_vec
[1]);

881 
	gi
 = 1; i < 
	gvec_Ën
; i++)

882 
_Ál_g£’gth
(&
»m_vec
[
i
], 
Ën_vec
[i]);

888 
	gZZ_CRT_»m_medium
::
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
){

890 
	gx_vec
.
S‘L’gth
(
n
);

891 * 
	gx
 = 
x_vec
.
_vec__»p
;

892 
ZZ
 
	ga_»m
 = 
a_ZZ
 % 
p
;

893 
_Ál_gbigšt
 
	ga
 = 
a_»m
.
»p
;

895 
	gi
, 
	gj
;

897 ià(
ZEROP
(
a
)) {

898 
	gj
 = 0; j < 
	gn
; j++)

899 
	gx
[
j
] = 0;

904 
_Ál_gcİy
(
a
, &
»m_vec
[1]);

905 
_Ál_gcİy
(
a
, &
»m_vec
[2]);

907 
	gi
 = 1; i < (1L << (
	gËv–s
-1)) - 1; i++) {

908 
_Ál_gcİy
(
»m_vec
[
i
], &rem_vec[0]);

909 
»dc
(
»m_vec
[0], 
´od_vec
[2*
i
+1], 
Ën_vec
[i]-len_vec[2*i+1],

910 
šv_vec
[2*
i
+1], 
»m_vec
[2*i+1]);

911 
»dc
(
»m_vec
[
i
], 
´od_vec
[2*i+2], 
Ën_vec
[i]-len_vec[2*i+2],

912 
šv_vec
[2*
i
+2], 
»m_vec
[2*i+2]);

915 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

916 
	glo
 = 
šdex_vec
[
i
];

917 
	ghi
 = 
šdex_vec
[
i
+1];

918 
mp_limb_t
 *
	gs1p
 = 
DATA
(
»m_vec
[
i
]);

919 
	gs1size
 = 
SIZE
(
»m_vec
[
i
]);

920 ià(
	gs1size
 == 0) {

921 
j
 = 
lo
; 
	gj
 <
	ghi
; j++)

922 
	gx
[
j
] = 0;

925 
	gj
 = 
lo
; j < 
	ghi
; j++) {

926 
	gt
 = 
m²_mod_1
(
s1p
, 
s1size
, 
moduli
[
j
]);

927 
	gx
[
j
] = 
MulModP»cÚ
(
t
, 
cÜr_vec
[j], 
moduli
[j], 
cÜ¿ux_vec
[j]);

937 
	gZZ_CRT_»m_basic
::
ZZ_CRT_»m_basic
(cÚ¡ 
Vec
<>& 
q
){

939 ià(
q
.
Ëngth
(è>ğ
NTL_MIN_REM_MEDIUM
)

942 
	gmoduli
 = 
q
;

943 
	gn
 = 
moduli
.
Ëngth
();

945 
	gp
 = 
to_ZZ
(1);

946 
	gi
 = 0; i < 
	gn
; i++)

947 
	gp
 *ğ
moduli
[
i
];

954 
	gZZ_CRT_»m_basic
::
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
){

955 
	gx_vec
.
S‘L’gth
(
n
);

956 * 
	gx
 = 
x_vec
.
_vec__»p
;

957 
ZZ
 
	ga_»m
 = 
a_ZZ
 % 
p
;

958 
_Ál_gbigšt
 
	ga
 = 
a_»m
.
»p
;

961 
	gj
;

962 
mp_limb_t
 *
	gad©a
;

963 
	g§
;

965 ià(!
	ga
)

966 
	g§
 = 0;

968 
	g§
 = 
SIZE
(
a
);

970 ià(
	g§
 == 0) {

971 
j
 = 0; 
	gj
 < 
	gn
; j++)

972 
	gx
[
j
] = 0;

976 
	gad©a
 = 
DATA
(
a
);

978 
	gj
 = 0; j < 
	gn
; j++)

979 
	gx
[
j
] = 
m²_mod_1
(
ad©a
, 
§
, 
moduli
[j]);

997 
	gZZ_CRT_üt
::
	$make
(){

998 
moduli_»c
.
	`S‘L’gth
(
n
);

999 
u
.
	`S‘L’gth
(
n
);

1000 
uqšv
.
	`S‘L’gth
(
n
);

1002 
»duû_¡ruù
.
	`š™
(
p
, 
	`ZZ
(
n
è<< 
NTL_SP_NBITS
);

1004 
i
 = 0; i < 
n
; i++) {

1005 
q
 = 
moduli
[
i
];

1006 
mulmod_t
 
qšv
 = 
	`P»pMulMod
(
q
);

1008 
ZZ
 
M2
;

1009 
	`div
(
M2
, 
p
, 
q
);

1010 
t
 = 
	`»m
(
M2
, 
q
);

1011 
t
 = 
	`InvMod
Ñ, 
q
);

1014 
»duû_¡ruù
.
	`adju¡
(
M2
);

1015 
	`š£¹
(
i
, 
M2
.
»p
);

1017 
moduli_»c
[
i
] = 1/(
q
);

1018 
u
[
i
] = 
t
;

1019 
uqšv
[
i
] = 
	`P»pMulModP»cÚ
(
t
, 
q
, 
qšv
);

1021 
	}
}

1027 
	gZZ_CRT_üt
::
´emuÉly
(
Vec
<>& 
b
, cÚ¡ Vec<>& 
a
){

1028 
	gb
.
S‘L’gth
(
n
);

1029 
	gi
 = 0; i < 
	gn
; i++) {

1030 
	gr
 = 
MulModP»cÚ
(
a
[
i
], 
u
[i], 
moduli
[i], 
uqšv
[i]);

1031 
	gb
[
i
] = 
r
;

1040 
	gZZ_CRT_üt_tbl
::
ZZ_CRT_üt_tbl
(cÚ¡ 
Vec
<>& 
q
){

1041 ià(
q
.
Ëngth
(è> 
NTL_MAX_CRT_TBL
)

1044 
	gmoduli
 = 
q
;

1045 
	gn
 = 
moduli
.
Ëngth
();

1047 
	gp
 = 
to_ZZ
(1);

1048 
	gi
 = 0; i < 
	gn
; i++)

1049 
	gp
 *ğ
moduli
[
i
];

1051 
	gsz
 = 
SIZE
(
p
.
»p
);

1052 
	gv
.
S‘L’gth
(
sz
);

1053 
	gi
 = 0; i < 
	gsz
; i++)

1054 
	gv
[
i
].
S‘L’gth
(
n
);

1056 
make
();

1062 
	gZZ_CRT_üt_tbl
::
	$š£¹
(
i
, 
_Ál_gbigšt
 
m
){

1063 ià(!
m
)

1064 
j
 = 0; j < 
sz
; j++è
v
[j][
i
] = 0;

1066 
sm
 = 
	`SIZE
(
m
);

1067 ià(
sm
 < 0 || sm > 
sz
)

1068 
	`LogicE¼Ü
("insert: bad‡rgs");

1069 cÚ¡ 
mp_limb_t
 *
md©a
 = 
	`DATA
(
m
);

1070 
j
 = 0; j < 
sm
; j++)

1071 
v
[
j
][
i
] = 
md©a
[j];

1072 
j
 = 
sm
; j < 
sz
; j++)

1073 
v
[
j
][
i
] = 0;

1075 
	}
}

1081 
	#CRT_ALTCODE_UNROLL
 (1)

	)

1082 
	gZZ_CRT_üt_tbl
::
üt
(
ZZ
& 
x_ZZ
, cÚ¡ 
Vec
<>& 
bb_š
){

1084 
	gVec
<> 
	gb_š
;

1085 
´emuÉly
(
b_š
, 
bb_š
);

1087 
ZZ
 
	gxx1
;

1088 
_Ál_gbigšt
 *
	gx
 = &
xx1
.
»p
;

1089 
	gsx
;

1090 
_Ál_gbigšt
 
	gx1
;

1091 
	gi
;

1093 * 
	gb
 = 
b_š
.
_vec__»p
;

1099 ià(!
	gb_š
[0]) {

1100 
	gi
 = 1;

1101 
	gi
 < 
	gn
 && !
	gb_š
[
i
]) i++;

1102 ià(
	gi
 >ğ
n
) {

1103 
x_ZZ
 = 
to_ZZ
(0);

1108 
	gsx
 = 
sz
 + 2;

1109 
_Ál_g£’gth
(
x
, 
sx
);

1110 
	gx1
 = *
x
;

1111 
mp_limb_t
 * 
NTL_RESTRICT
 
	gxx
 = 
DATA
(
x1
);

1114 cÚ¡ 
	gBnd
 = 1L << (
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
);

1116 ià(
	gn
 <ğ
Bnd
) {

1117 
mp_limb_t
 
ÿ¼y
=0;

1119 
	gi
 = 0; i < 
	gsz
; i++) {

1120 cÚ¡ 
mp_limb_t
 *
	grow
 = 
v
[
i
].
_vec__»p
;

1122 
NTL_ULL_TYPE
 
	gacc
 = ((NTL_ULL_TYPEè
row
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[0]);

1124 #ià(
CRT_ALTCODE_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

1125 
	gn
) {

1126 16: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[16-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[16-1]);

1127 15: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[15-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[15-1]);

1128 14: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[14-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[14-1]);

1129 13: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[13-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[13-1]);

1130 12: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[12-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[12-1]);

1131 11: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[11-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[11-1]);

1132 10: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[10-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[10-1]);

1133 9: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[9-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[9-1]);

1134 8: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[8-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[8-1]);

1135 7: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[7-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[7-1]);

1136 6: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[6-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[6-1]);

1137 5: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[5-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[5-1]);

1138 4: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[4-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[4-1]);

1139 3: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[3-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[3-1]);

1140 2: 
acc
 +ğ((
NTL_ULL_TYPE
è
row
[2-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[2-1]);

1143 
	gj
 = 1; j < 
	gn
; j++)

1144 
	gacc
 +ğ((
NTL_ULL_TYPE
è
row
[
j
]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[j]);

1147 
	gacc
 +ğ
ÿ¼y
;

1148 
	gxx
[
i
] = 
acc
;

1149 
	gÿ¼y
 = 
acc
 >> 
NTL_BITS_PER_LONG
;

1152 
	gxx
[
sz
] = 
ÿ¼y
;

1153 
	gxx
[
sz
+1] = 0;

1156 
NTL_ULL_TYPE
 
	gÿ¼y
=0;

1158 
	gi
 = 0; i < 
	gsz
; i++) {

1159 cÚ¡ 
mp_limb_t
 *
	grow
 = 
v
[
i
].
_vec__»p
;

1161 
NTL_ULL_TYPE
 
	gacc21
;

1162 
mp_limb_t
 
	gacc0
;

1165 
NTL_ULL_TYPE
 
	gsum
 = ((NTL_ULL_TYPEè
row
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[0]);

1167 #ià(
CRT_ALTCODE_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

1168 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[1]);

1169 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[2]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[2]);

1170 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[3]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[3]);

1171 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[4]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[4]);

1172 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[5]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[5]);

1173 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[6]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[6]);

1174 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[7]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[7]);

1175 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[8]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[8]);

1176 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[9]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[9]);

1177 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[10]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[10]);

1178 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[11]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[11]);

1179 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[12]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[12]);

1180 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[13]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[13]);

1181 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[14]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[14]);

1182 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[15]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[15]);

1183 #–ià(
CRT_ALTCODE_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 2)

1184 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[1]);

1185 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[2]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[2]);

1186 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[3]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[3]);

1188 
	gj
 = 1; j < 
	gBnd
; j++)

1189 
	gsum
 +ğ((
NTL_ULL_TYPE
è
row
[
j
]è* ((NTL_ULL_TYPEè(
mp_limb_t
è
b
[j]);

1192 
	gacc21
 = 
sum
 >> 
NTL_BITS_PER_LONG
;

1193 
	gacc0
 = 
sum
;

1196 cÚ¡ 
mp_limb_t
 *
	g­
 = 
row
;

1197 cÚ¡ *
	g
 = 
b
;

1199 #ià(
CRT_ALTCODE_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 2)

1200 
	gm
 = 
n
 - 4;

1201 
	g­
 += 4;

1202 
	g
 += 4;

1204 ; 
	gm
 >ğ8; m -ğ8, 
	g­
 +ğ8, 
	g
 += 8) {

1206 
NTL_ULL_TYPE
 
sum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[0]);

1207 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[1]);

1208 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[2]);

1209 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[3]);

1210 
	gsum
 +ğ
acc0
;

1211 
	gacc0
 = 
sum
;

1212 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

1215 
NTL_ULL_TYPE
 
	gsum
 = ((NTL_ULL_TYPEè
­
[4+0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[4+0]);

1216 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4+1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[4+1]);

1217 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4+2]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[4+2]);

1218 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4+3]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[4+3]);

1219 
	gsum
 +ğ
acc0
;

1220 
	gacc0
 = 
sum
;

1221 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

1225 ; 
	gm
 >ğ4; m -ğ4, 
	g­
 +ğ4, 
	g
 += 4) {

1226 
NTL_ULL_TYPE
 
sum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[0]);

1227 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[1]);

1228 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[2]);

1229 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[3]);

1230 
	gsum
 +ğ
acc0
;

1231 
	gacc0
 = 
sum
;

1232 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

1237 
	gm
;

1238 
	gm
 = 
n
-
Bnd
, 
	g­
 +ğBnd, 
	g
 += Bnd; m >= Bnd; m -= Bnd,‡p += Bnd,p += Bnd) {

1240 
NTL_ULL_TYPE
 
sum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[0]);

1242 #ià(
CRT_ALTCODE_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

1243 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[1]);

1244 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[2]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[2]);

1245 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[3]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[3]);

1246 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[4]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[4]);

1247 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[5]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[5]);

1248 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[6]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[6]);

1249 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[7]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[7]);

1250 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[8]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[8]);

1251 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[9]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[9]);

1252 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[10]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[10]);

1253 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[11]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[11]);

1254 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[12]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[12]);

1255 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[13]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[13]);

1256 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[14]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[14]);

1257 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[15]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[15]);

1259 
	gj
 = 1; j < 
	gBnd
; j++)

1260 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[
j
]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[j]);

1263 
	gsum
 +ğ
acc0
;

1264 
	gacc0
 = 
sum
;

1265 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

1269 ià(
	gm
 > 0) {

1270 
NTL_ULL_TYPE
 
	gsum
 = ((NTL_ULL_TYPEè
­
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[0]);

1272 #ià(
CRT_ALTCODE_UNROLL
 && 
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
 == 4)

1273 
	gm
) {

1274 15: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[15-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[15-1]);

1275 14: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[14-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[14-1]);

1276 13: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[13-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[13-1]);

1277 12: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[12-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[12-1]);

1278 11: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[11-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[11-1]);

1279 10: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[10-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[10-1]);

1280 9: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[9-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[9-1]);

1281 8: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[8-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[8-1]);

1282 7: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[7-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[7-1]);

1283 6: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[6-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[6-1]);

1284 5: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[5-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[5-1]);

1285 4: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[4-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[4-1]);

1286 3: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[3-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[3-1]);

1287 2: 
sum
 +ğ((
NTL_ULL_TYPE
è
­
[2-1]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[2-1]);

1290 
	gm
--, 
	g­
++, 
	g
++; m > 0; m--,‡p++,p++)

1291 
	gsum
 +ğ((
NTL_ULL_TYPE
è
­
[0]è* ((NTL_ULL_TYPEè(
mp_limb_t
è

[0]);

1293 
	gsum
 +ğ
acc0
;

1294 
	gacc0
 = 
sum
;

1295 
	gacc21
 +ğ(
mp_limb_t
è(
sum
 >> 
NTL_BITS_PER_LONG
);

1298 
	gÿ¼y
 +ğ
acc0
;

1299 
	gxx
[
i
] = 
ÿ¼y
;

1300 
	gacc21
 +ğ((
mp_limb_t
è(
ÿ¼y
 >> 
NTL_BITS_PER_LONG
));

1301 
	gÿ¼y
 = 
acc21
;

1304 
	gxx
[
sz
] = 
ÿ¼y
;

1305 
	gxx
[
sz
+1] = 
ÿ¼y
 >> 
NTL_BITS_PER_LONG
;

1308 
	gsx
 > 0 && 
	gxx
[
sx
-1] == 0)

1309 
sx
--;

1310 
SIZE
(
x1
èğ
sx
;

1312 
	g»duû_¡ruù
.
ev®
(
x_ZZ
, 
xx1
);

1320 
	#GCRT_TMPS
 (2)

	)

1321 
	gZZ_CRT_üt_ç¡
::
ZZ_CRT_üt_ç¡
(cÚ¡ 
Vec
<>& 
q
){

1322 ià(
q
.
Ëngth
(è< 
NTL_MAX_CRT_TBL
)

1325 
	gmoduli
 = 
q
;

1326 
	gn
 = 
moduli
.
Ëngth
();

1328 
	gp
 = 
to_ZZ
(1);

1329 
	gi
 = 0; i < 
	gn
; i++)

1330 
	gp
 *ğ
moduli
[
i
];

1332 
	gËv–s
 = 0;

1333 (
	gn
 >> 
	gËv–s
) >= 16)

1334 
Ëv–s
++;

1335 
	gvec_Ën
 = (1L << 
Ëv–s
) - 1;

1337 
	gv®_vec
.
S‘L’gth
(
n
);

1338 
	g‹mps
.
S‘L’gth
(
GCRT_TMPS
);

1339 
z”o_vec_gbigšt
(
‹mps
);

1340 
	g»m_vec
.
S‘L’gth
(
vec_Ën
);

1341 
z”o_vec_gbigšt
(
»m_vec
);

1342 
	gšv_vec
.
S‘L’gth
(
n
);

1343 
	gšdex_vec
.
S‘L’gth
(
vec_Ën
+1);

1344 
	g´od_vec
.
S‘L’gth
(
vec_Ën
);

1345 
z”o_vec_gbigšt
(
´od_vec
);

1346 
	gcÛff_vec
.
S‘L’gth
(
n
);

1347 
z”o_vec_gbigšt
(
cÛff_vec
);

1349 
	gšdex_vec
[0] = 0;

1350 
	gšdex_vec
[1] = 
n
;

1352 
	gi
 = 0; i <ğ
Ëv–s
-2; i++) {

1353 
	g¡¬t
 = (1L << 
i
) - 1;

1354 
	gfšish
 = (1L << (
i
+1)) - 2;

1355 
	gj
 = 
fšish
; j >ğ
¡¬t
; j--) {

1356 
	gšdex_vec
[2*
j
+2] = 
šdex_vec
[j] + (index_vec[j+1] - index_vec[j])/2;

1357 
	gšdex_vec
[2*
j
+1] = 
šdex_vec
[j];

1359 
	gšdex_vec
[2*
fšish
+3] = 
n
;

1362 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

1366 
_Ál_gÚe
(&
´od_vec
[
i
]);

1367 
	gj
 = 
šdex_vec
[
i
]; j < 
	gšdex_vec
[i+1]; j++)

1368 
_Ál_gsmul
(
´od_vec
[
i
], 
q
[
j
], &prod_vec[i]);

1371 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

1372 
	gj
 = 
šdex_vec
[
i
]; j < 
	gšdex_vec
[i+1]; j++)

1373 
_Ál_gsdiv
(
´od_vec
[
i
], 
q
[
j
], &
cÛff_vec
[j]);

1376 
	gi
 = (1L << (
Ëv–s
-1)) - 2; i >= 0; i--)

1377 
_Ál_gmul
(
´od_vec
[2*
i
+1],…rod_vec[2*i+2], &prod_vec[i]);

1381 
_Ál_gÚe
(&
»m_vec
[0]);

1382 
	gi
 = 0; i < (1L << (
	gËv–s
-1)) - 1; i++) {

1383 
_Ál_gmod
(
»m_vec
[
i
], 
´od_vec
[2*i+1], &
‹mps
[0]);

1384 
_Ál_gmul
(
‹mps
[0], 
´od_vec
[2*
i
+2], &temps[1]);

1385 
_Ál_gmod
(
‹mps
[1], 
´od_vec
[2*
i
+1], &
»m_vec
[2*i+1]);

1387 
_Ál_gmod
(
»m_vec
[
i
], 
´od_vec
[2*i+2], &
‹mps
[0]);

1388 
_Ál_gmul
(
‹mps
[0], 
´od_vec
[2*
i
+1], &temps[1]);

1389 
_Ál_gmod
(
‹mps
[1], 
´od_vec
[2*
i
+2], &
»m_vec
[2*i+2]);

1392 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

1393 
	gj
 = 
šdex_vec
[
i
]; j < 
	gšdex_vec
[i+1]; j++) {

1394 
	g‰
, 
	g‰1
, 
	g‰2
;

1395 
_Ál_gsdiv
(
´od_vec
[
i
], 
q
[
j
], &
‹mps
[0]);

1396 
	g‰
 = 
_Ál_gsmod
(
‹mps
[0], 
q
[
j
]);

1397 
	g‰1
 = 
_Ál_gsmod
(
»m_vec
[
i
], 
q
[
j
]);

1398 
	g‰2
 = 
MulMod
(
‰
, 
‰1
, 
q
[
j
]);

1399 
	gšv_vec
[
j
] = 
¥_šv_mod
(
‰2
, 
q
[j]);

1407 
	gZZ_CRT_üt_ç¡
::
	$š£¹
(
i
, 
_Ál_gbigšt
 
m
){

1408 
	`LogicE¼Ü
("insert called improperly");

1409 
	}
}

1414 
	gZZ_CRT_üt_ç¡
::
üt
(
ZZ
& 
x_ZZ
, cÚ¡ 
Vec
<>& 
b_š
){

1416 *
	gv®_vec1
 = 
v®_vec
.
_vec__»p
;

1417 
	gi
;

1419 
	gi
 = 0; i < 
	gn
; i++) {

1420 
	gv®_vec1
[
i
] = 
MulMod
(
b_š
[i], 
šv_vec
[i], 
moduli
[i]);

1423 
	gi
 = (1L << (
Ëv–s
-1)è- 1; i < 
	gvec_Ën
; i++) {

1424 
	gj1
 = 
šdex_vec
[
i
];

1425 
	gj2
 = 
šdex_vec
[
i
+1];

1426 
gadd_mul_mªy
(&
»m_vec
[
i
], &
cÛff_vec
[
j1
], &
v®_vec1
[j1], 
j2
-j1, 
SIZE
(
´od_vec
[i]));

1429 
	gi
 = (1L << (
Ëv–s
-1)) - 2; i >= 0; i--) {

1430 
_Ál_gmul
(
´od_vec
[2*
i
+1], 
»m_vec
[2*i+2], &
‹mps
[0]);

1431 
_Ál_gmul
(
»m_vec
[2*
i
+1], 
´od_vec
[2*i+2], &
‹mps
[1]);

1432 
_Ál_gadd
(
‹mps
[0],emps[1], &
»m_vec
[
i
]);

1436 
_Ál_gmod
(
»m_vec
[0], 
´od_vec
[0], &
‹mps
[0]);

1437 
_Ál_gsub
(
‹mps
[0], 
´od_vec
[0], &temps[1]);

1438 
_Ál_gÃg©e
(&
‹mps
[1]);

1439 ià(
_Ál_gcom·»
(
‹mps
[0],emps[1]) > 0) {

1440 
_Ál_gÃg©e
(&
‹mps
[1]);

1441 
_Ál_gcİy
(
‹mps
[1], &temps[0]);

1444 
_Ál_gmod
(
‹mps
[0], 
p
.
»p
, &temps[1]);

1445 
_Ál_gcİy
(
‹mps
[1], &
x_ZZ
.
»p
);

1453 
	gZZ_CRT_üt_basic
::
ZZ_CRT_üt_basic
(cÚ¡ 
Vec
<>& 
q
){

1455 ià(
q
.
Ëngth
() >= 600)

1458 
	gmoduli
 = 
q
;

1459 
	gn
 = 
moduli
.
Ëngth
();

1461 
	gp
 = 
to_ZZ
(1);

1462 
	gi
 = 0; i < 
	gn
; i++)

1463 
	gp
 *ğ
moduli
[
i
];

1465 
	gv
.
S‘L’gth
(
n
);

1466 
	gi
 = 0; i < 
	gn
; i++)

1467 
	gv
[
i
] = 0;

1469 
	gsbuf
 = 
SIZE
(
p
.
»p
)+2;

1470 
make
();

1477 
	gZZ_CRT_üt_basic
::
üt
(
ZZ
& 
x_ZZ
, cÚ¡ 
Vec
<>& 
b_š
){

1478 
	gVec
<> 
	gb_vec
;

1479 
´emuÉly
(
b_vec
, 
b_š
);

1481 
ZZ
 
	gxx1
;

1482 
_Ál_gbigšt
* 
	gx
 = &
xx1
.
»p
;

1484 
mp_limb_t
 *
	gxx
, *
	gyy
;

1485 
_Ál_gbigšt
 
	gx1
;

1486 
	gi
, 
	gsx
;

1487 
	gsy
;

1488 
mp_limb_t
 
	gÿ¼y
;

1490 
	gsx
 = 
sbuf
;

1491 
_Ál_g£’gth
(
x
, 
sx
);

1492 
	gx1
 = *
x
;

1493 
	gxx
 = 
DATA
(
x1
);

1495 
	gi
 = 0; i < 
	gsx
; i++)

1496 
	gxx
[
i
] = 0;

1498 
	gi
 = 0; i < 
	gn
; i++) {

1499 ià(!
	gv
[
i
]) ;

1501 
	gyy
 = 
DATA
(
v
[
i
]);

1502 
	gsy
 = 
SIZE
(
v
[
i
]);

1504 ià(!
	gsy
 || !
	gb_vec
[
i
]) ;

1506 
	gÿ¼y
 = 
m²_addmul_1
(
xx
, 
yy
, 
sy
, 
b_vec
[
i
]);

1507 
	gyy
 = 
xx
 + 
sy
;

1508 *
	gyy
 +ğ
ÿ¼y
;

1510 ià(*
	gyy
 < 
	gÿ¼y
) {

1512 
	gyy
++;

1513 *
	gyy
 += 1;

1514 } *
	gyy
 == 0);

1518 
	gsx
 > 0 && 
	gxx
[
sx
-1] == 0) sx--;

1519 
SIZE
(
x1
èğ
sx
;

1521 
	g»duû_¡ruù
.
ev®
(
x_ZZ
, 
xx1
);

1527 
	gZZ_CRT_üt_basic
::
	$š£¹
(
i
, 
_Ál_gbigšt
 
m
){

1528 
	`_Ál_gcİy
(
m
, &
v
[
i
]);

1529 
	}
}

1540 
	gZZ_CRT
::
bud_»m_¡ruù
(cÚ¡ 
Vec
<>& 
moduli
) {

1542 
n
 = 
moduli
.
Ëngth
();

1544 #ià(
defšed
(
NTL_VIABLE_LL
è&& defšed(
NTL_TBL_REM
))

1545 ià(
	gn
 <ğ
NTL_MAX_REM_TBL
){

1546 
»m_¡ruù
 = &
»m_tbl
;

1550 ià(
	gn
 >ğ
NTL_MIN_REM_MEDIUM
 && 
n
 < 
NTL_MIN_REM_FAST
) {

1551 
»m_¡ruù
 = &
»m_medium
;

1554 ià(
	gn
 >ğ
NTL_MIN_REM_FAST
) {

1555 
»m_¡ruù
 = &
»m_ç¡
;

1559 
	g»m_¡ruù
 = &
»m_basic
;

1567 
	gZZ_CRT
::
bud_üt_¡ruù
(cÚ¡ 
Vec
<>& 
moduli
) {

1569 
n
 = 
moduli
.
Ëngth
();

1571 ià(
	gn
 >ğ
NTL_MAX_CRT_TBL
){

1572 
üt_¡ruù
 = &
üt_ç¡
;

1575 #ià(
defšed
(
NTL_VIABLE_LL
)è&& (defšed(
NTL_CRT_ALTCODE
))

1577 
	güt_¡ruù
 = &
üt_tbl
;

1581 #ià(
defšed
(
NTL_VIABLE_LL
)è&& (defšed(
NTL_CRT_ALTCODE_SMALL
))

1582 ià(
	gn
 <= 16){

1583 
üt_¡ruù
 = &
üt_tbl
;

1587 
	güt_¡ruù
 = &
üt_basic
;

1592 
	güt_¡ruù
 = &
üt_basic
;

1601 
	gZZ_CRT
::
ZZ_CRT
(cÚ¡ 
Vec
<>& 
moduli
) :

1602 #ià(
defšed
(
NTL_VIABLE_LL
è&& defšed(
NTL_TBL_REM
))

1603 
»m_tbl
(
moduli
),

1605 
»m_ç¡
(
moduli
),

1606 
»m_medium
(
moduli
),

1607 
»m_basic
(
moduli
),

1608 #ià((
defšed
(
NTL_VIABLE_LL
)è&& (defšed(
NTL_CRT_ALTCODE
))è|| ((defšed(NTL_VIABLE_LL)è&& (defšed(
NTL_CRT_ALTCODE_SMALL
)))

1609 
üt_tbl
(
moduli
),

1611 
üt_ç¡
(
moduli
),

1612 
	$üt_basic
(
moduli
) {

1613 
	`bud_»m_¡ruù
(
moduli
);

1614 
	`bud_üt_¡ruù
(
moduli
);

1615 
	}
}

	@ZZ_CRT/test/test_CRT_basic.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 10; j < 11; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_üt_basic
 
	`üt
(
moduli
);

26 
ZZ_CRT_»m_basic
 
	`»m
(
moduli
);

28 
Vec
<> 
»ms
;

29 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

30 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

31 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

32 
a
 = -a;

34 
»m
.
	`ev®
(
»ms
, 
a
);

35 
ZZ
 
b
;

36 
üt
.
	`üt
(
b
, 
»ms
);

39 
cout
 << 
j
 << 
’dl
;

42 
cout
 << "a:=" << 
a
 << ";\n";

43 
	`magma_assign
(
moduli
, "m");

44 
	`magma_assign
(
»ms
, "r");

45 
cout
 << "b:=" << 
b
 << ";\n";

46 
cout
 << "print bƒq (a mod &*m);\n";

50 
	}
}

52 
	$maš
(
¬gc
, ** 
¬gv
){

53 
İt
 = 0;

54 ià(
¬gc
 > 1)

55 
İt
 = 
	`©oi
(
¬gv
[1]);

56 
	`check
(
İt
);

58 
	}
}

	@ZZ_CRT/test/test_CRT_fast.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 801; j < 802; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_üt_ç¡
 
	`üt
(
moduli
);

26 
ZZ_CRT_»m_ç¡
 
	`»m
(
moduli
);

28 
Vec
<> 
»ms
;

29 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

30 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

31 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

32 
a
 = -a;

34 
»m
.
	`ev®
(
»ms
, 
a
);

35 
ZZ
 
b
;

36 
üt
.
	`üt
(
b
, 
»ms
);

39 
cout
 << 
j
 << 
’dl
;

42 
cout
 << "a:=" << 
a
 << ";\n";

43 
	`magma_assign
(
moduli
, "m");

44 
	`magma_assign
(
»ms
, "r");

45 
cout
 << "b:=" << 
b
 << ";\n";

46 
cout
 << "print bƒq (a mod &*m);\n";

50 
	}
}

52 
	$maš
(
¬gc
, ** 
¬gv
){

53 
İt
 = 0;

54 ià(
¬gc
 > 1)

55 
İt
 = 
	`©oi
(
¬gv
[1]);

56 
	`check
(
İt
);

58 
	}
}

	@ZZ_CRT/test/test_CRT_tbl.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 100; j < 101; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_üt_tbl
 
	`üt
(
moduli
);

26 
ZZ_CRT_»m_medium
 
	`»m
(
moduli
);

28 
Vec
<> 
»ms
;

29 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

30 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

31 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

32 
a
 = -a;

34 
»m
.
	`ev®
(
»ms
, 
a
);

35 
ZZ
 
b
;

36 
üt
.
	`üt
(
b
, 
»ms
);

39 
cout
 << 
j
 << 
’dl
;

42 
cout
 << "a:=" << 
a
 << ";\n";

43 
	`magma_assign
(
moduli
, "m");

44 
	`magma_assign
(
»ms
, "r");

45 
cout
 << "b:=" << 
b
 << ";\n";

46 
cout
 << "print bƒq (a mod &*m);\n";

50 
	}
}

52 
	$maš
(
¬gc
, ** 
¬gv
){

53 
İt
 = 0;

54 ià(
¬gc
 > 1)

55 
İt
 = 
	`©oi
(
¬gv
[1]);

56 
	`check
(
İt
);

58 
	}
}

	@ZZ_CRT/test/test_ZZ_CRT.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 1; j < 1000; j = (j % 900) + 1){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT
 
	`üt
(
moduli
);

27 
Vec
<> 
»ms
;

28 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

29 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

30 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

31 
a
 = -a;

33 
üt
.
	`ev®
(
»ms
, 
a
);

34 
ZZ
 
b
;

35 
üt
.
	`üt
(
b
, 
»ms
);

38 
cout
 << 
j
 << 
’dl
;

41 
cout
 << "a:=" << 
a
 << ";\n";

42 
	`magma_assign
(
moduli
, "m");

43 
	`magma_assign
(
»ms
, "r");

44 
cout
 << "b:=" << 
b
 << ";\n";

45 
cout
 << "print #m, bƒq (a mod &*m);\n";

49 
	}
}

51 
	$maš
(
¬gc
, ** 
¬gv
){

52 
İt
 = 0;

53 ià(
¬gc
 > 1)

54 
İt
 = 
	`©oi
(
¬gv
[1]);

55 
	`check
(
İt
);

57 
	}
}

	@ZZ_CRT/test/test_multimod_ZZX.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 1; j < 1000; j++){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT
 
	`üt
(
moduli
);

28 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

29 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

30 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

32 
ZZX
 
­Ş
;

33 
i
 = 0; i < 10; i++)

34 
	`S‘CÛff
(
­Ş
, 
i
, 
	`RªdomBnd
(
a
));

36 
Vec
<
zz_pX
> 
»m
;

37 
üt
.
	`muÉimod
(
»m
, 
­Ş
);

40 
cout
 << 
j
 << 
’dl
;

42 
	`magma_š™_ZZX
();

43 
	`magma_assign
(
­Ş
, "a");

44 
	`magma_assign
(
moduli
, "m");

45 
	`magma_assign
(
»m
, "XX", "r");

46 
cout
 << "´šˆ" << 
j
 << ";\n";

47 
cout
 << "print &and [PolynomialRing(Integers(m[i]))!(r[i]-a)ƒq 0 : i in [1..#m]];\n";

51 
	}
}

53 
	$maš
(
¬gc
, ** 
¬gv
){

54 
İt
 = 0;

55 ià(
¬gc
 > 1)

56 
İt
 = 
	`©oi
(
¬gv
[1]);

57 
	`check
(
İt
);

59 
	}
}

	@ZZ_CRT/test/test_multimod_basic.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 10; j < 11; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_»m_basic
 
	`üt
(
moduli
);

27 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

28 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

29 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

30 
a
 = -a;

32 
Vec
<> 
»m
;

33 
»m
.
	`S‘L’gth
(
moduli
.
	`Ëngth
());

34 
üt
.
	`ev®
(
»m
, 
a
);

37 
cout
 << 
j
 << 
’dl
;

39 
cout
 << "a:=" << 
a
 << ";\n";

40 
	`magma_assign
(
moduli
, "m");

41 
	`magma_assign
(
»m
, "r");

42 
cout
 << "print &and [r[i] mod m[i]ƒq‡ mod m[i] : i in [1..#m]];\n";

46 
	}
}

48 
	$maš
(
¬gc
, ** 
¬gv
){

49 
İt
 = 0;

50 ià(
¬gc
 > 1)

51 
İt
 = 
	`©oi
(
¬gv
[1]);

52 
	`check
(
İt
);

54 
	}
}

	@ZZ_CRT/test/test_multimod_fast.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 300; j < 301; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_»m_ç¡
 
	`üt
(
moduli
);

27 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

28 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

29 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

30 
a
 = -a;

32 
Vec
<> 
»m
;

33 
»m
.
	`S‘L’gth
(
moduli
.
	`Ëngth
());

34 
üt
.
	`ev®
(
»m
, 
a
);

37 
cout
 << 
j
 << 
’dl
;

39 
cout
 << "a:=" << 
a
 << ";\n";

40 
	`magma_assign
(
moduli
, "m");

41 
	`magma_assign
(
»m
, "r");

42 
cout
 << "print &and [r[i] mod m[i]ƒq‡ mod m[i] : i in [1..#m]];\n";

46 
	}
}

48 
	$maš
(
¬gc
, ** 
¬gv
){

49 
İt
 = 0;

50 ià(
¬gc
 > 1)

51 
İt
 = 
	`©oi
(
¬gv
[1]);

52 
	`check
(
İt
);

54 
	}
}

	@ZZ_CRT/test/test_multimod_medium.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 200; j < 201; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_»m_medium
 
	`üt
(
moduli
);

27 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

28 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

29 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

30 
a
 = -a;

32 
Vec
<> 
»m
;

33 
»m
.
	`S‘L’gth
(
moduli
.
	`Ëngth
());

34 
üt
.
	`ev®
(
»m
, 
a
);

37 
cout
 << 
j
 << 
’dl
;

39 
cout
 << "a:=" << 
a
 << ";\n";

40 
	`magma_assign
(
moduli
, "m");

41 
	`magma_assign
(
»m
, "r");

42 
cout
 << "print &and [r[i] mod m[i]ƒq‡ mod m[i] : i in [1..#m]];\n";

46 
	}
}

48 
	$maš
(
¬gc
, ** 
¬gv
){

49 
İt
 = 0;

50 ià(
¬gc
 > 1)

51 
İt
 = 
	`©oi
(
¬gv
[1]);

52 
	`check
(
İt
);

54 
	}
}

	@ZZ_CRT/test/test_multimod_tbl.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

7 
NTL_CLIENT


14 
	$check
(
İt
){

15 
Vec
<> 
moduli
;

17 
j
 = 100; j < 101; ){

18 
ba£
 = 1L << 59;

19 
moduli
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++){

21 
ba£
 = 
	`NextPrime
(base+1);

22 
moduli
[
i
] = 
ba£
;

25 
ZZ_CRT_»m_tbl
 
	`üt
(
moduli
);

27 
ZZ
 
a
 = 
	`to_ZZ
("1725436586697640946858688965569256363112777243042596638790631055949824");

28 
i
 = 0; i < 
moduli
.
	`Ëngth
(); i++)

29 
a
 *ğ(3*
	`to_ZZ
(
moduli
[
i
])/2);

30 
a
 = -a;

32 
Vec
<> 
»m
;

33 
»m
.
	`S‘L’gth
(
moduli
.
	`Ëngth
());

34 
üt
.
	`ev®
(
»m
, 
a
);

37 
cout
 << 
j
 << 
’dl
;

39 
cout
 << "a:=" << 
a
 << ";\n";

40 
	`magma_assign
(
moduli
, "m");

41 
	`magma_assign
(
»m
, "r");

42 
cout
 << "print &and [r[i] mod m[i]ƒq‡ mod m[i] : i in [1..#m]];\n";

46 
	}
}

48 
	$maš
(
¬gc
, ** 
¬gv
){

49 
İt
 = 0;

50 ià(
¬gc
 > 1)

51 
İt
 = 
	`©oi
(
¬gv
[1]);

52 
	`check
(
İt
);

54 
	}
}

	@ZZ_CRT/test/test_ratrecon.cpp

1 
	~<NTL/ZZ.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"ZZ_CRT.h
"

6 
	~"¿ŒecÚ.h
"

8 
NTL_CLIENT


15 
	$check
(
İt
){

17 
sz
 = 10;

18 
´ime
 = 101;

19 
Vec
<> 
check
;

20 
check
.
	`S‘L’gth
(3*
sz
);

21 
i
 = 0; i < 
sz
; i++)

22 
check
[
i
] = 
	`InvMod
(200 % 
´ime
,…rime);

23 
i
 = 
sz
; i < 2*sz; i++)

24 
check
[
i
] = 0;

25 
i
 = 2*
sz
; i < 3*sz; i++)

26 
check
[
i
] = 
	`InvMod
(2000 % 
´ime
,…rime);

28 
Vec
<Vec<>> 
ccheck
;

29 
ccheck
.
	`S‘L’gth
(2);

30 
ccheck
[0] = 
check
;

31 
ccheck
[1] = 
check
;

33 
boŞ
 
dÚe
 = 
çl£
;

34 
ZZ
 
m
 = 
	`to_ZZ
(100);

35 
dÚe
 =ğ
çl£
){

36 
m
 = 
	`NextPrime
(m*10);

37 
Vec
<
ZZ
> 
v
;

38 
v
.
	`S‘L’gth
(3*
sz
);

39 
i
 = 0; i < 
sz
; i++)

40 
v
[
i
] = 
	`InvMod
(
	`to_ZZ
(200è% 
m
, m);

41 
i
 = 
sz
; i < 2*sz; i++)

42 
v
[
i
] = 
	`to_ZZ
(0);

43 
i
 = 2*
sz
; i < 3*sz; i++)

44 
v
[
i
] = 
	`InvMod
(
	`to_ZZ
(2000è% 
m
, m);

46 
Vec
<Vec<
ZZ
>> 
vv
;

47 
vv
.
	`S‘L’gth
(2);

48 
vv
[0] = 
v
;

49 
vv
[1] = 
v
;

51 
Vec
<
ZZ
> 
w
;

52 
Vec
<Vec<
ZZ
>> 
ww
;

53 
ZZ
 
d’
;

55 
s
 = 
	`RecÚ¡ruùR©iÚ®
(
w
, 
d’
, 
v
, 
m
, 
check
, 
´ime
);

56 ià(
s
 == 0)

57 
cout
 << "çl£ w™h m=" << 
m
 << 
’dl
;

59 
cout
 << "Œuw™h m=" << 
m
 << 
’dl
;

60 
dÚe
 = 
Œue
;

61 
cout
 << 
d’
 << 
’dl
;

64 
cout
 << 
w
 << 
’dl
;

67 
	}
}

69 
	$maš
(
¬gc
, ** 
¬gv
){

70 
İt
 = 0;

71 ià(
¬gc
 > 1)

72 
İt
 = 
	`©oi
(
¬gv
[1]);

73 
	`check
(
İt
);

75 
	}
}

	@ZZ_pX_CRT/ZZ_pX_CRT.h

1 #iâdeà
ZZ_PX_CRT__H


2 
	#ZZ_PX_CRT__H


	)

4 
	~<NTL/ZZ_pX.h
>

5 
	~<NTL/veùÜ.h
>

6 
	~<NTL/m©rix.h
>

8 
NTL_CLIENT


23 şas 
	cZZ_pX_MuÉošt
{

24 
	mpublic
:

29 
vœtu®
 
ev®u©e
(
Vec
<
ZZ_p
>& 
v®
, cÚ¡ 
ZZ_pX
& 
f
) const = 0;

30 
vœtu®
 
š‹½Ş©e
(
ZZ_pX
& 
f
, cÚ¡ 
Vec
<
ZZ_p
>& 
v®
) const = 0;

35 
	$Ëngth
() const{

36  
n
;

43 
n
;

44 
	}
};

53 şas 
	cZZ_pX_MuÉošt_FFT
 : 
public
 
ZZ_pX_MuÉošt
{

54 
public
:

56 
	$ZZ_pX_MuÉošt_FFT
(){}

59 
	`ZZ_pX_MuÉošt_FFT
(cÚ¡ 
ZZ_p
 & 
w
, 
n
);

62 
	`ZZ_pX_MuÉošt_FFT
(cÚ¡ 
ZZ_p
 & 
w
, cÚ¡ ZZ_°& 
c
, 
n
);

67 
	`ev®u©e
(
Vec
<
ZZ_p
>& 
v®
, cÚ¡ 
ZZ_pX
& 
f
) const;

69 
	`š‹½Ş©e
(
ZZ_pX
& 
f
, cÚ¡ 
Vec
<
ZZ_p
>& 
v®
) const{

70 
	`LogicE¼Ü
("inverse TFT‚ot implemented");

71 
	}
}

73 ~
	$ZZ_pX_MuÉošt_FFT
(){
	}
};

75 
	g´iv©e
:

76 
k
, 
	gmax_n
;

77 
	gVec
<Vec<
	gZZ_p
>> 
	gpow”sW
;

78 
	gVec
<
	gZZ_p
> 
	gpow”sC
, 
	gšv_pow”sC
;

79 
	gVec
<> 
	g»v
;

86 
fšd_roÙ_of_un™y
(
p
, 
s
);

92 
liá_roÙ_of_un™y
(
ZZ
& 
Omega
, 
omega
, 
s
, 
p
, 
k
);

	@ZZ_pX_CRT/src/ZZ_pX_CRT.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/ZZ_pX.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"ZZ_pX_CRT.h
"

7 
NTL_CLIENT


20 
	$RevInc
(
a
, 
k
) {

21 
j
, 
m
;

23 
j
 = 
k
;

24 
m
 = 1L << (
k
-1);

26 
j
 && (
m
 & 
a
)) {

27 
a
 ^ğ
m
;

28 
m
 >>= 1;

29 
j
--;

31 ià(
j
è
a
 ^ğ
m
;

32  
a
;

33 
	}
}

38 
	gZZ_pX_MuÉošt_FFT
::
	$ZZ_pX_MuÉošt_FFT
(cÚ¡ 
ZZ_p
 & 
w
, 
n
){

39 
this
->
k
 = 
	`NextPow”OfTwo
(
n
);

40 
this
->
max_n
 = 1L << 
k
;

41 
this
->
n
 =‚;

43 
pow”sW
.
	`S‘L’gth
(
k
);

44 
kk
 = 0; kk < 
k
; kk++){

45 
Â
 = 1L << 
kk
;

46 
pow”sW
[
kk
].
	`S‘L’gth
(
Â
);

47 
ZZ_p
 
ww
 = 
	`pow”
(
w
, 1L << (
k
-1-
kk
));

48 
pow”sW
[
kk
][0] = 
	`to_ZZ_p
(1);

49 
i
 = 1; i < 
Â
; i++)

50 
pow”sW
[
kk
][
i
] =…ow”sW[kk][i-1] * 
ww
;

53 
»v
.
	`S‘L’gth
(
max_n
);

54 
i
, 
j
;

55 
i
 = 0, 
j
 = 0; i < 
max_n
; i++, j = 
	`RevInc
(j, 
k
))

56 
»v
[
i
] = 
j
;

57 
	}
}

62 
	gZZ_pX_MuÉošt_FFT
::
	$ZZ_pX_MuÉošt_FFT
(cÚ¡ 
ZZ_p
 & 
w
, cÚ¡ ZZ_°& 
c
, 
n
è: 
	$ZZ_pX_MuÉošt_FFT
(
w
, 
n
){

63 
pow”sC
.
	`S‘L’gth
(
n
);

64 
šv_pow”sC
.
	`S‘L’gth
(
n
);

65 
ZZ_p
 
švC
 = 1/
c
;

66 
pow”sC
[0] = 
	`to_ZZ_p
(1);

67 
šv_pow”sC
[0] = 
	`to_ZZ_p
(1);

68 
i
 = 1; i < 
n
; i++){

69 
pow”sC
[
i
] = 
c
 *…owersC[i-1];

70 
šv_pow”sC
[
i
] = 
švC
 * inv_powersC[i-1];

72 
	}
}

77 
	gZZ_pX_MuÉošt_FFT
::
ev®u©e
(
Vec
<
ZZ_p
>& 
v®
, cÚ¡ 
ZZ_pX
& 
f
) const {

79 
	gv®
.
S‘L’gth
(
n
);

80 
	gVec
<
	gZZ_p
> 
	ga
, 
	gdá_a
;

81 
	ga
.
S‘L’gth
(
max_n
);

82 
	gdá_a
.
S‘L’gth
(
max_n
);

84 ià(
	gpow”sC
.
Ëngth
() == 0)

85 
i
 = 0; 
	gi
 < 
	gn
; i++)

86 
	ga
[
i
] = 
cÛff
(
f
, i);

88 
	gi
 = 0; i < 
	gn
; i++)

89 
	ga
[
i
] = 
cÛff
(
f
, iè* 
	gpow”sC
[i];

91 
	gi
 = 
n
; i < 
	gmax_n
; i++)

92 
	ga
[
i
] = 
to_ZZ_p
(0);

94 ià(
	gk
 == 0) {

95 
v®
[0] = 
a
[0];

98 ià(
	gk
 == 1) {

99 
v®
[0] = 
a
[0] +‡[1];

100 
	gv®
[1] = 
a
[0] -‡[1];

105 
	gmax–l
 = 1L << (
k
-1);

106 
	gs
 = 0;

107 
	gt
 = 
max–l
;

108 ; 
	gs
 < 
	gmax–l
; s++, 
	gt
++){

109 
ZZ_p
 
	gas
 = 
a
[
s
];

110 
ZZ_p
 
	g©
 = 
a
[
t
];

111 
	gdá_a
[
s
] = 
as
 + 
©
;

112 
	gdá_a
[
t
] = (
as
 - 
©
è* 
pow”sW
[
k
-1][
s
];

116 
	gi
 = 1; i < 
	gk
-1; i++){

117 
	gmax–l
 = (1L << (
k
-
i
-1));

119 
	gj
 = 0; j < (1L << 
	gi
); j++){

120 
	gs
 = 
j
 << (
k
-
i
);

121 
	gt
 = 
s
 + 
max–l
;

122 
	g–l
 = 0;ƒÎ < 
	gmax–l
;ƒll++){

123 
ZZ_p
 
	gas
 = 
dá_a
[
–l
 + 
s
];

124 
ZZ_p
 
	g©
 = 
dá_a
[
–l
 + 
t
];

125 
	gdá_a
[
–l
 + 
s
] = 
as
 + 
©
;

126 
	gdá_a
[
–l
 + 
t
] = (
as
 - 
©
è* 
pow”sW
[
k
-1-
i
][ell];

132 
	gmax–l
 = 1L << 
k
;

133 
	gs
 = 0; s < 
	gmax–l
; s += 2){

134 
ZZ_p
 
as
 = 
dá_a
[
s
];

135 
ZZ_p
 
	g©
 = 
dá_a
[
s
+1];

136 
	gdá_a
[
s
] = 
as
 + 
©
;

137 
	gdá_a
[
s
+1] = 
as
 - 
©
;

140 
	gi
 = 0; i < 
	gmax_n
; i++)

141 ià(
	g»v
[
i
] < 
	gn
)

142 
	gv®
[
»v
[
i
]] = 
dá_a
[i];

149 
	$fšd_roÙ_of_un™y
(
p
, 
s
){

150 
ss
 = 
s
;

151 
log
 = 0;

152 (
ss
 & 1) == 0){

153 
log
++;

154 
ss
 = ss >> 1;

156 ià(
ss
 != 1)

157 
	`LogicE¼Ü
("FFT init with‚on…ower of 2");

159 
zz_pPush
 
push
;

160 
zz_p
::
	`U£rFFTIn™
(
p
);

161 
w
;

162 
	`IsFFTPrime
(
p
, 
w
);

163 
zz_p
 
zww
 = 
	`to_zz_p
(
w
);

165 
Üd”
 = 0;

166 
zww
 !ğ
	`to_zz_p
(1)){

167 
zww
 *= zww;

168 
Üd”
++;

171 
zww
 = 
	`pow”
(
	`to_zz_p
(
w
), 1L << (
Üd”
-
log
));

172  
	`»p
(
zww
);

173 
	}
}

179 
	$liá_roÙ_of_un™y
(
ZZ
& 
Omega
, 
omega
, 
s
, 
p
, 
k
){

180 
ZZ_pPush
 
push
;

181 
Omega
 = 
	`to_ZZ
(
omega
);

183 ià(
k
 == 1)

186 
ZZ
 
pk
 = 
	`to_ZZ
(
p
);

188 
´ec
 = 1;

190 
pk
 =…k*pk;

191 
ZZ_p
::
	`š™
(
pk
);

192 
ZZ_p
 
s_mod
 = 
	`to_ZZ_p
(
s
);

193 
ZZ_p
 
Omega_mod
 = 
	`to_ZZ_p
(
Omega
);

194 
ZZ_p
 
liá
 = 
Omega_mod
*(
	`to_ZZ_p
(1è- (
	`pow”
(Omega_mod, 
s
)-1)/
s_mod
);

195 
Omega
 = 
	`»p
(
liá
);

196 
´ec
 = 2*prec;

197 } 
´ec
 < 
k
);

199 
Omega
 = Omeg¨% 
	`pow”
(
	`to_ZZ
(
p
), 
k
);

200 
	}
}

	@ZZ_pX_CRT/test/test_ZZ_pX_CRT_FFT_evaluate.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/ZZ_pX.h
>

3 
	~<NTL/veùÜ.h
>

4 
	~<as£¹.h
>

6 
	~"ZZ_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
zz_p
::
	`FFTIn™
(1);

17 
p
 = 
zz_p
::
	`modulus
();

18 
k
 = 11;

19 
ZZ
 
pZZ
 = 
	`to_ZZ
(
p
);

20 
ZZ
 
pk
 = 
	`pow”
(
pZZ
, 
k
);

21 
ZZ_p
::
	`š™
(
pk
);

23 
i
 = 1; i < 10000; i = 2*i+3){

24 
Üd”
 = 1L << 
	`NextPow”OfTwo
(
i
);

25 
w
 = 
	`fšd_roÙ_of_un™y
(
p
, 
Üd”
);

26 
ZZ
 
W
;

27 
	`liá_roÙ_of_un™y
(
W
, 
w
, 
Üd”
, 
p
, 
k
);

28 
ZZ_p
 
omega
 = 
	`to_ZZ_p
(
W
);

30 
ZZ_pX_MuÉošt_FFT
 
	`fá
(
omega
, 
i
);

31 
ZZ_pX
 
f
 = 
	`¿ndom_ZZ_pX
(
i
);

32 
Vec
<
ZZ_p
> 
v®
;

34 ià(
İt
 == 1){

35 
fá
.
	`ev®u©e
(
v®
, 
f
);

36 
Vec
<
ZZ_p
> 
v®2
;

37 
v®2
.
	`S‘L’gth
(
i
);

38 
j
 = 0; j < 
i
; j++)

39 
v®2
[
j
] = 
	`ev®
(
f
, 
	`pow”
(
omega
, j));

40 
	`as£¹
 (
v®
 =ğ
v®2
);

43 
t
;

44 
cout
 << 
i
 << " ";

46 
t
 = 
	`G‘Time
();

47 
j
 = 0; j < 100; j++)

48 
fá
.
	`ev®u©e
(
v®
, 
f
);

49 
t
 = 
	`G‘Time
() -;

50 
cout
 << 
t
 << " ";

52 
t
 = 
	`G‘Time
();

53 
ZZ_pX
 
g
 = 
	`¿ndom_ZZ_pX
(
i
);

54 
j
 = 0; j < 100; j++)

55 
ZZ_pX
 
h
 = 
f
*
g
;

56 
t
 = 
	`G‘Time
() -;

57 
cout
 << 
t
 << " ";

59 
cout
 << 
’dl
;

62 
	}
}

64 
	$maš
(
¬gc
, ** 
¬gv
){

65 
İt
 = 0;

66 ià(
¬gc
 > 1)

67 
İt
 = 
	`©oi
(
¬gv
[1]);

68 
	`check
(
İt
);

70 
	}
}

	@ZZ_pX_CRT/test/test_ZZ_pX_CRT_FFT_evaluate_shifted.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/ZZ_pX.h
>

3 
	~<NTL/veùÜ.h
>

4 
	~<as£¹.h
>

6 
	~"ZZ_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
zz_p
::
	`FFTIn™
(1);

17 
p
 = 
zz_p
::
	`modulus
();

18 
k
 = 11;

19 
ZZ
 
pZZ
 = 
	`to_ZZ
(
p
);

20 
ZZ
 
pk
 = 
	`pow”
(
pZZ
, 
k
);

21 
ZZ_p
::
	`š™
(
pk
);

23 
i
 = 1; i < 10000; i = 2*i+3){

24 
Üd”
 = 1L << 
	`NextPow”OfTwo
(
i
);

25 
w
 = 
	`fšd_roÙ_of_un™y
(
p
, 
Üd”
);

26 
ZZ
 
W
;

27 
	`liá_roÙ_of_un™y
(
W
, 
w
, 
Üd”
, 
p
, 
k
);

28 
ZZ_p
 
omega
 = 
	`to_ZZ_p
(
W
);

30 
ZZ_p
 
c
 = 
	`¿ndom_ZZ_p
();

31 
ZZ_pX_MuÉošt_FFT
 
	`fá
(
omega
, 
c
, 
i
);

32 
ZZ_pX
 
f
 = 
	`¿ndom_ZZ_pX
(
i
);

33 
Vec
<
ZZ_p
> 
v®
;

35 
fá
.
	`ev®u©e
(
v®
, 
f
);

36 
Vec
<
ZZ_p
> 
v®2
;

37 
v®2
.
	`S‘L’gth
(
i
);

38 
j
 = 0; j < 
i
; j++)

39 
v®2
[
j
] = 
	`ev®
(
f
, 
c
*
	`pow”
(
omega
, j));

40 
	`as£¹
 (
v®
 =ğ
v®2
);

41 
cout
 << 
i
 << 
’dl
;

43 
	}
}

45 
	$maš
(
¬gc
, ** 
¬gv
){

46 
İt
 = 0;

47 ià(
¬gc
 > 1)

48 
İt
 = 
	`©oi
(
¬gv
[1]);

49 
	`check
(
İt
);

51 
	}
}

	@ZZ_pX_CRT/test/test_find_root_of_unity.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/ZZ_pX.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"ZZ_pX_CRT.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

15 
p
, 
w
;

16 
zz_p
::
	`FFTIn™
(1);

17 
p
 = 
zz_p
::
	`modulus
();

19 
w
 = 
	`fšd_roÙ_of_un™y
(
p
, 1L << 10);

20 
cout
 << 
p
 << 
’dl
;

21 
cout
 << 
w
 << 
’dl
;

22 
	}
}

24 
	$maš
(
¬gc
, ** 
¬gv
){

25 
İt
 = 0;

26 ià(
¬gc
 > 1)

27 
İt
 = 
	`©oi
(
¬gv
[1]);

28 
	`check
(
İt
);

30 
	}
}

	@ZZ_pX_CRT/test/test_lift_root_of_unity.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/ZZ_pX.h
>

3 
	~<NTL/veùÜ.h
>

4 
	~<as£¹.h
>

6 
	~"ZZ_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
, 
w
, 
s
;

17 
s
 = 1L << 1;

18 
zz_p
::
	`FFTIn™
(1);

19 
p
 = 
zz_p
::
	`modulus
();

20 
w
 = 
	`fšd_roÙ_of_un™y
(
p
, 
s
);

22 
k
 = 100;

23 
ZZ
 
Omega
;

24 
	`liá_roÙ_of_un™y
(
Omega
, 
w
, 
s
, 
p
, 
k
);

26 
ZZ_p
::
	`š™
(
	`pow”
(
	`to_ZZ
(
p
), 
k
));

27 
ZZ_p
 
W
 = 
	`to_ZZ_p
(
Omega
);

28 
	`as£¹
 (
	`pow”
(
W
, 
s
 >> 1è!ğ
	`to_ZZ_p
(1));

29 
	`as£¹
 (
	`pow”
(
W
, 
s
è=ğ
	`to_ZZ_p
(1));

30 
	}
}

32 
	$maš
(
¬gc
, ** 
¬gv
){

33 
İt
 = 0;

34 ià(
¬gc
 > 1)

35 
İt
 = 
	`©oi
(
¬gv
[1]);

36 
	`check
(
İt
);

38 
	}
}

	@bivariate/ZZXY.h

1 #iâdeà
ZZXY__H


2 
	#ZZXY__H


	)

4 
	~<f¡»am
>

5 
	~<io¡»am
>

6 
	~<¡ršg.h
>

8 
	~<NTL/ZZX.h
>

9 
	~<NTL/veùÜ.h
>

11 
NTL_CLIENT


22 şas 
	cZZXY
{

23 
	mpublic
:

24 
Vec
<
ZZX
> 
cÛffX
;

29 
	$tdeg
() const;

33 
	$degY
() const;

37 
	$degX
() const;

44 
	`nÜm®ize
();

46 
	$ZZXY
(){}

51 
	`ZZXY
(cÚ¡ 
Vec
<
ZZX
> & 
cÛff
){

52 
cÛffX
 = 
cÛff
;

53 
	`nÜm®ize
();

54 
	}
}

61 
»ad_äom_fe
(cÚ¡ 
¡ršg
& 
f’ame
);

63 ~
	$ZZXY
(){
	}
}

69 
	gi¡»am
& 
	gİ”©Ü
>>(i¡»am& 
	gs
, 
	gZZXY
& 
	gx
);

70 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gs
, cÚ¡ 
	gZZXY
& 
	ga
);

75 
magma_š™_bi_QQ
();

80 
magma_ouut
(cÚ¡ 
ZZXY
 & 
a
);

85 
magma_assign
(cÚ¡ 
ZZXY
 & 
a
, cÚ¡ 
¡ršg
 & 
Çme
);

90 
diffY
(
ZZXY
 & 
dyF
, cÚ¡ ZZXY & 
F
);

99 
	sZZ_biv¬Ÿ‹_»guÏr_chaš
{

100 
ZZX
 
	mT1
;

101 
ZZXY
 
	mT2
;

107 
magma_ouut
(cÚ¡ 
ZZ_biv¬Ÿ‹_»guÏr_chaš
& 
T
);

112 
magma_assign
(cÚ¡ 
ZZ_biv¬Ÿ‹_»guÏr_chaš
& 
T
, cÚ¡ 
¡ršg
& 
Çme
);

117 
magma_ouut
(cÚ¡ 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
>& 
T
);

122 
magma_assign
(cÚ¡ 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
>& 
T
, cÚ¡ 
¡ršg
& 
Çme
);

131 
sŞve
(
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
> & 
sŞs
, cÚ¡ 
ZZXY
 & 
FZ
, cÚ¡ ZZXY & 
GZ
);

	@bivariate/lzz_pEX_augmented.h

1 #iâdeà
LZZ_PX_AUGMENTED__H


2 
	#LZZ_PX_AUGMENTED__H


	)

4 
	~<f¡»am
>

5 
	~<io¡»am
>

6 
	~<s¡»am
>

7 
	~<¡ršg.h
>

8 
	~<®gÜ™hm
>

10 
	~<NTL/ZZX.h
>

11 
	~<NTL/lzz_pX.h
>

12 
	~<NTL/lzz_pEX.h
>

13 
	~<NTL/veùÜ.h
>

15 
	~"lzz_pX_CRT.h
"

17 
NTL_CLIENT


26 
¥l™
(
zz_pX
 & 
mod_z”o
, zz_pX & 
mod_un™
, zz_pX & 
šv”£
, cÚ¡ zz_pX & 
–t
, cÚ¡ zz_pX & 
modulus
);

37 
¥l™_fÜ_»guÏrize
(
Vec
<
zz_pX
> & 
çùÜ_modulus
, cÚ¡ Vec<zz_pX> & 
–ts
, cÚ¡ zz_pX & 
modulus
);

46 şas 
	czz_pEX_augm’‹d
{

47 
	mpublic
:

48 
zz_pX
 
T1X
;

49 
zz_pECÚ‹xt
 
	mT1
;

50 
zz_pEX
 
	mT2
;

52 
	$zz_pEX_augm’‹d
(){}

54 
	$zz_pEX_augm’‹d
(cÚ¡ 
zz_pEX
 & 
t2
){

55 
T1X
 = 
zz_pE
::
	`modulus
();

56 
T1
 = 
	`zz_pECÚ‹xt
(
T1X
);

57 
T2
 = 
t2
;

58 
	}
}

60 
	$zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
zz_pXY
 & 
t2
){

61 
T1X
 = 
t1
;

62 
T1
 = 
	`zz_pECÚ‹xt
(
t1
);

63 
zz_pEPush
 
	`push
(
T1
);

64 
	`cÚv
(
T2
, 
t2
);

65 
	}
}

67 
zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
Vec
<zz_pX> & 
t2
){

68 
	gT1X
 = 
t1
;

69 
	gT1
 = 
zz_pECÚ‹xt
(
t1
);

70 
zz_pEPush
 
push
(
T1
);

72 
	gVec
<
	gzz_pE
> 
	gt2E
;

73 
cÚv
(
t2E
, 
t2
);

74 
cÚv
(
T2
, 
t2E
);

77 ~
	$zz_pEX_augm’‹d
(){
	}
}

83 
magma_ouuts
(cÚ¡ 
zz_pEX_augm’‹d
 & 
F
);

88 
magma_assign
(cÚ¡ 
zz_pEX_augm’‹d
 & 
F
, cÚ¡ 
¡ršg
 & 
Çme
);

93 
¿ndom_mÚic_zz_pEX_augm’‹d
(
zz_pEX_augm’‹d
 & 
»s
, 
dX
, 
dY
);

98 
mod
(
zz_pEX_augm’‹d
 & 
»duûd
, cÚ¡ zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX
 & 
Ãw_mod
);

103 
muÉimod
(
Vec
<
zz_pEX_augm’‹d
> & 
»duûd
, cÚ¡ zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX_CRT
 & 
Ãw_mod
);

109 
combše
(
zz_pEX_augm’‹d
 & 
»suÉ
, cÚ¡ 
Vec
<zz_pEX_augm’‹d> & 
»ms
);

114 
make_mÚic_ªd_¥l™
(
Vec
<
zz_pEX_augm’‹d
> & 
mÚic_F
, cÚ¡ zz_pEX_augm’‹d & 
F
);

120 
squ¬eä“
(
Vec
<
zz_pEX_augm’‹d
> & 
sqä“
, cÚ¡ zz_pEX_augm’‹d & 
f
);

126 
squ¬eä“
(
Vec
<
zz_pEX_augm’‹d
> & 
sqä“
, cÚ¡ Vec<zz_pEX_augm’‹d> & 
f
);

132 
sŞve
(
Vec
<
zz_pEX_augm’‹d
> & 
sŞs
, cÚ¡ 
zz_pXY
 & 
f
, cÚ¡ zz_pXY & 
g
);

140 şas 
	c·œ_zz_pEX_augm’‹d
{

141 
	mpublic
:

142 
zz_pX
 
T1X
;

143 
zz_pECÚ‹xt
 
	mT1
;

144 
zz_pEX
 
	mT20
, 
	mT21
;

146 
	$·œ_zz_pEX_augm’‹d
(){}

148 
	$·œ_zz_pEX_augm’‹d
(cÚ¡ 
zz_pEX
 & 
t2_0
, cÚ¡ zz_pEX & 
t2_1
){

149 
T1X
 = 
zz_pE
::
	`modulus
();

150 
T1
 = 
	`zz_pECÚ‹xt
(
T1X
);

151 
T20
 = 
t2_0
;

152 
T21
 = 
t2_1
;

153 
	}
}

155 
	$·œ_zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
zz_pXY
 & 
t2_0
, cÚ¡ zz_pXY & 
t2_1
){

156 
T1X
 = 
t1
;

157 
T1
 = 
	`zz_pECÚ‹xt
(
t1
);

158 
zz_pEPush
 
	`push
(
T1
);

159 
	`cÚv
(
T20
, 
t2_0
);

160 
	`cÚv
(
T21
, 
t2_1
);

161 
	}
}

163 
·œ_zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
Vec
<zz_pX> & 
t2_0
, cÚ¡ Vec<zz_pX> & 
t2_1
){

164 
	gT1X
 = 
t1
;

165 
	gT1
 = 
zz_pECÚ‹xt
(
t1
);

166 
zz_pEPush
 
push
(
T1
);

167 
	gVec
<
	gzz_pE
> 
	gt2E0
, 
	gt2E1
;

169 
cÚv
(
t2E0
, 
t2_0
);

170 
cÚv
(
T20
, 
t2E0
);

171 
cÚv
(
t2E1
, 
t2_1
);

172 
cÚv
(
T21
, 
t2E1
);

175 ~
	$·œ_zz_pEX_augm’‹d
(){
	}
}

181 
magma_ouut
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
F
);

186 
magma_assign
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
F
, cÚ¡ 
¡ršg
 & 
Çme
);

191 
¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
·œ_zz_pEX_augm’‹d
 & 
»s
, 
dX
, 
dY0
, 
dY1
);

196 
mod
(
·œ_zz_pEX_augm’‹d
 & 
»duûd
, cÚ¡…aœ_zz_pEX_augm’‹d & 
Üig
, cÚ¡ 
zz_pX
 & 
Ãw_mod
);

201 
muÉimod
(
Vec
<
·œ_zz_pEX_augm’‹d
> & 
»duûd
, cÚ¡…aœ_zz_pEX_augm’‹d & 
Üig
, cÚ¡ 
zz_pX_CRT
 & 
Ãw_mod
);

206 
combše
(
·œ_zz_pEX_augm’‹d
 & 
»suÉ
, cÚ¡ 
Vec
<·œ_zz_pEX_augm’‹d> & 
»ms
);

211 
make_mÚic_ªd_¥l™
(
Vec
<
·œ_zz_pEX_augm’‹d
> & 
mÚic_F
, cÚ¡…aœ_zz_pEX_augm’‹d & 
F
, 
idx
);

216 
»guÏr_gcd
(
Vec
<
zz_pEX_augm’‹d
> & 
h
, cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
a_b
);

	@bivariate/lzz_pXY.h

1 #iâdeà
LZZ_PXY__H


2 
	#LZZ_PXY__H


	)

4 
	~<NTL/ZZX.h
>

5 
	~<NTL/lzz_pX.h
>

6 
	~<NTL/lzz_pEX.h
>

7 
	~<NTL/veùÜ.h
>

9 
	~"lzz_pX_CRT.h
"

10 
	~"ZZXY.h
"

12 
NTL_CLIENT


24 şas 
	czz_pXY
{

25 
	mpublic
:

26 
Vec
<
zz_pX
> 
cÛffX
;

31 
	$tdeg
() const;

36 
	$degX
() const;

41 
	$degY
() const;

47 
	`nÜm®ize
();

49 
	$zz_pXY
(){}

54 
	`zz_pXY
(cÚ¡ 
Vec
<
zz_pX
> & 
cÛff
){

55 
cÛffX
 = 
cÛff
;

56 
	`nÜm®ize
();

57 
	}
}

59 ~
	$zz_pXY
(){
	}
}

65 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gs
, cÚ¡ 
	gzz_pXY
& 
	ga
);

70 
magma_š™_Y
();

75 
magma_š™_bi
();

80 
magma_ouut
(cÚ¡ 
zz_pXY
 & 
a
);

85 
magma_assign
(cÚ¡ 
zz_pXY
 & 
a
, cÚ¡ 
¡ršg
 & 
n
);

90 
magma_ouut_bi
(cÚ¡ 
zz_pXY
 & 
a
);

95 
magma_assign_bi
(cÚ¡ 
zz_pXY
 & 
a
, cÚ¡ 
¡ršg
 & 
Çme
);

100 
¿ndom_zz_pXY
(
zz_pXY
 & 
f
, 
dx
, 
dy
);

106 
ev®u©e
(
Vec
<
zz_pX
> & 
v®ues
, cÚ¡ 
zz_pXY
 & 
f
, cÚ¡ 
zz_pX_MuÉošt
 & 
ev
);

112 
»suÉªt
(
zz_pX
 & 
»s
, zz_pX& 
sub»s0
, zz_pX& 
sub»s1
, cÚ¡ 
zz_pXY
& 
f
, cÚ¡ zz_pXY& 
g
);

118 
diffY
(
zz_pXY
 & 
dyF
, cÚ¡ zz_pXY & 
F
);

123 
cÚv
(
zz_pEX
 & 
fEX
, cÚ¡ 
zz_pXY
 & 
f
);

124 
cÚv
(
zz_pXY
 & 
f
, cÚ¡ 
zz_pEX
 & 
fEX
);

125 
cÚv
(
zz_pXY
 & 
f
, cÚ¡ 
ZZXY
 & 
fZ
);

130 
»duû_Çive
(
zz_pX
 & 
»m
, cÚ¡ zz_pX& 
R
, cÚ¡ zz_pX& 
S
, cÚ¡ 
zz_pXY
 & 
F
);

131 
»duû
(
zz_pX
 & 
»m
, cÚ¡ zz_pX& 
R
, cÚ¡ zz_pX& 
S
, cÚ¡ 
zz_pXY
 & 
F
);

	@bivariate/src/ZZXY.cpp

1 
	~<s¡»am
>

2 
	~<®gÜ™hm
>

3 
	~<NTL/toŞs.h
>

4 
	~<NTL/veùÜ.h
>

6 
	~"ZZ_CRT.h
"

7 
	~"¿ŒecÚ.h
"

8 
	~"ZZXY.h
"

9 
	~"lzz_pXY.h
"

10 
	~"lzz_pEX_augm’‹d.h
"

11 
	~"magma_ouut.h
"

13 
NTL_CLIENT


28 
	gZZXY
::
	$tdeg
() const {

29 
»s
 = -1;

30 
i
 = 0; i < 
cÛffX
.
	`Ëngth
(); i++)

31 
»s
 = 
	`max
Ôes, 
	`deg
(
cÛffX
[
i
]) + i);

32  
»s
;

33 
	}
}

38 
	gZZXY
::
	$degY
() const {

39  
cÛffX
.
	`Ëngth
()-1;

40 
	}
}

45 
	gZZXY
::
	$degX
() const {

46 
d
 = -1;

47 
i
 = 0; i < 
cÛffX
.
	`Ëngth
(); i++)

48 
d
 = 
	`max
(d, 
	`deg
(
cÛffX
[
i
]));

49  
d
;

50 
	}
}

56 
	gZZXY
::
	$nÜm®ize
(){

57 
idx
 = 
cÛffX
.
	`Ëngth
()-1;

58 
idx
 >ğ0 && 
cÛffX
[idx] == 0)

59 
idx
--;

60 
cÛffX
.
	`S‘L’gth
(
idx
+1);

61 
	}
}

68 
	gZZXY
::
	$»ad_äom_fe
(cÚ¡ 
¡ršg
& 
f’ame
){

69 
if¡»am
 
šput
;

70 
šput
.
	`İ’
(
f’ame
);

71 
¡ršg
 
lše
;

72 
	`g‘lše
(
šput
, 
lše
);

73 
	`»¶aû
(
lše
.
	`begš
(),†še.
	`’d
(), ',', ' ');

74 
¡ršg¡»am
 
lše_¡»am
;

75 
lše_¡»am
.
	`¡r
(
lše
);

77 
lše_¡»am
 >> 
cÛffX
;

78 
šput
.
	`şo£
();

79 
	}
}

85 
	gi¡»am
& 
	gİ”©Ü
>>(i¡»am& 
	gs
, 
	gZZXY
& 
	gx
){

86 
NTL_INPUT_CHECK_RET
(
s
, s >> 
x
.
cÛffX
);

87 
	gx
.
nÜm®ize
();

88  
	gs
;

94 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gs
, cÚ¡ 
	gZZXY
& 
	ga
){

95  
	gs
 << 
	ga
.
	gcÛffX
;

101 
	$magma_š™_bi_QQ
(){

102 
cout
 << "M<YYY,XXX> := PolynomialRing(Rationals(),2);\n";

103 
	}
}

109 
	$magma_ouut
(cÚ¡ 
ZZXY
 & 
a
){

110 
cout
 << "(M!(0)";

111 
d
 = 
a
.
	`degY
();

112 
i
 = 0; i <ğ
d
; i++){

113 
cout
 << "+(";

114 
	`magma_ouut
(
a
.
cÛffX
[
i
], "XXX");

115 
cout
 << ")*YYY^" << 
i
;

117 
cout
 << ")";

118 
	}
}

123 
	$magma_assign
(cÚ¡ 
ZZXY
 & 
a
, cÚ¡ 
¡ršg
 & 
Çme
){

124 
cout
 << 
Çme
 << " := ";

125 
	`magma_ouut
(
a
);

126 
cout
 << ";" << 
’dl
;

127 
	}
}

132 
	$diffY
(
ZZXY
 & 
dyF
, cÚ¡ ZZXY & 
F
){

133 
dy
 = 
F
.
	`degY
();

134 
Vec
<
ZZX
> 
cÛffs_dyF
;

136 ià(
dy
 <= 0){

137 
cÛffs_dyF
.
	`S‘L’gth
(0);

140 
cÛffs_dyF
.
	`S‘L’gth
(
dy
);

141 
i
 = 0; i < 
dy
; i++)

142 
cÛffs_dyF
[
i
] = (i+1)*
F
.
cÛffX
[i+1];

144 
dyF
 = 
	`ZZXY
(
cÛffs_dyF
);

145 
	}
}

152 
	$magma_ouut
(cÚ¡ 
ZZ_biv¬Ÿ‹_»guÏr_chaš
& 
T
){

153 
cout
 << "[";

154 
	`magma_ouut
(
T
.
T1
, "XXX");

155 
cout
 << ", ";

156 
	`magma_ouut
(
T
.
T2
);

157 
cout
 << "]";

158 
	}
}

163 
	$magma_assign
(cÚ¡ 
ZZ_biv¬Ÿ‹_»guÏr_chaš
& 
T
, cÚ¡ 
¡ršg
& 
Çme
){

164 
cout
 << 
Çme
 << " := ";

165 
	`magma_ouut
(
T
);

166 
cout
 << ";" << 
’dl
;

167 
	}
}

172 
magma_ouut
(cÚ¡ 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
>& 
T
){

173 
	gcout
 << "[";

174 
	gi
 = 0; i < 
	gT
.
Ëngth
(); i++){

175 
magma_ouut
(
T
[
i
]);

176 ià(
	gi
 < 
	gT
.
Ëngth
()-1)

177 
	gcout
 << ", ";

179 
	gcout
 << "]";

185 
magma_assign
(cÚ¡ 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
>& 
T
, cÚ¡ 
¡ršg
& 
Çme
){

186 
	gcout
 << 
	gÇme
 << " := ";

187 
magma_ouut
(
T
);

188 
	gcout
 << ";" << 
	g’dl
;

200 
šlše


201 
cÚv
(
Vec
<>& 
®Úg
, cÚ¡ Vec<
zz_p
>& 
a
){

202 
	g®Úg
.
S‘L’gth
(
a
.
Ëngth
());

203 
	gi
 = 0; i < 
	ga
.
Ëngth
(); i++)

204 
	g®Úg
[
i
] = 
a
[i].
_zz_p__»p
;

211 
	g‹m¶©e
 <
şass
 
	gT
>

212 
šlše
 
£t_®l_Ëngths
(
Vec
<Vec<Vec<
T
>>>& 
¬
, 
sz
, cÚ¡ Vec<>& 
deg_X
, cÚ¡ Vec<>& 
deg_Y
){

213 
	g¬
.
S‘L’gth
(
sz
);

214 
	gj
 = 0; j < 
	gsz
; j++){

215 
	gdX
 = 
deg_X
[
j
];

216 
	gdY
 = 
deg_Y
[
j
];

217 
	g¬
[
j
].
S‘L’gth
(
dY
+2);

218 
	g¬
[
j
][0].
S‘L’gth
(
dX
+1);

219 
	g–l
 = 0;ƒÎ <ğ
dY
;ƒll++)

220 
	g¬
[
j
][
–l
+1].
S‘L’gth
(
dX
);

227 
šlše


228 
add_to
(
Vec
<Vec<Vec<Vec<>>>> & 
images_T2
, cÚ¡ Vec<
zz_pEX_augm’‹d
>& 
sŞs
, cÚ¡ Vec<>& 
deg_X
, cÚ¡ Vec<>& 
deg_Y
){

229 
	gVec
<> 
	gtmp
;

230 
	gsz
 = 
sŞs
.
Ëngth
();

231 
	gj
 = 0; j < 
	gsz
; j++){

232 
	gdX
 = 
deg_X
[
j
];

233 
	gdY
 = 
deg_Y
[
j
];

234 
cÚv
(
tmp
, 
sŞs
[
j
].
T1X
.
»p
);

235 
	gk
 = 0; k <ğ
dX
; k++)

236 
	gimages_T2
[
j
][0][
k
].
­³nd
(
tmp
[k]);

237 
	g–l
 = 0;ƒÎ <ğ
dY
;ƒll++){

238 
cÚv
(
tmp
, 
cÛff
(
sŞs
[
j
].
T2
, 
–l
).
_zz_pE__»p
.
»p
);

239 
	gk
 = 0; k < 
	gtmp
.
Ëngth
(); k++)

240 
	gimages_T2
[
j
][
–l
+1][
k
].
­³nd
(
tmp
[k]);

241 
	gk
 = 
tmp
.
Ëngth
(); k < 
	gdX
; k++)

242 
	gimages_T2
[
j
][
–l
+1][
k
].
­³nd
(0);

250 
šlše


251 
£t
(
Vec
<Vec<Vec<>>> & 
Úe_T2
, cÚ¡ Vec<
zz_pEX_augm’‹d
>& 
sŞs
, cÚ¡ Vec<>& 
deg_X
, cÚ¡ Vec<>& 
deg_Y
){

252 
	gsz
 = 
sŞs
.
Ëngth
();

253 
	gj
 = 0; j < 
	gsz
; j++){

254 
	gdX
 = 
deg_X
[
j
];

255 
	gdY
 = 
deg_Y
[
j
];

256 
cÚv
(
Úe_T2
[
j
][0], 
sŞs
[j].
T1X
.
»p
);

257 
	g–l
 = 0;ƒÎ <ğ
dY
;ƒll++){

258 
cÚv
(
Úe_T2
[
j
][
–l
+1], 
cÛff
(
sŞs
[j].
T2
,ƒÎ).
_zz_pE__»p
.
»p
);

259 
	ga
 = 
Úe_T2
[
j
][
–l
+1].
Ëngth
();

260 
	gÚe_T2
[
j
][
–l
+1].
S‘L’gth
(
dX
);

261 
	gk
 = 
a
; k < 
	gdX
; k++)

262 
	gÚe_T2
[
j
][
–l
+1][
k
] = 0;

275 
sŞve
(
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
> & 
sŞs
, cÚ¡ 
ZZXY
 & 
FZ
, cÚ¡ ZZXY & 
GZ
){

277 
	gp
 = 288230376151711813;

283 
	gVec
<> 
	g´imes_5
;

284 
	gVec
<Vec<
	gzz_pEX_augm’‹d
>> 
	gimages_sŞs_5
;

285 
	gVec
<Vec<>> 
	gli¡_deg_X
;

286 
	gVec
<Vec<>> 
	gli¡_deg_Y
;

288 
	gi
 = 0; i < 5; i++){

289 
	gp
 = 
NextPrime
(
p
+1);

291 
	gzz_p
::
š™
(
p
);

292 
zz_pXY
 
	gF
, 
	gG
;

293 
cÚv
(
F
, 
FZ
);

294 
cÚv
(
G
, 
GZ
);

296 
	gVec
<
	gzz_pEX_augm’‹d
> 
	gsŞs
;

297 
sŞve
(
sŞs
, 
F
, 
G
);

299 
	gsz
 = 
sŞs
.
Ëngth
();

300 
	gj
 = 0; j < 
	gsz
; j++){

301 
zz_pEPush
 
push
(
sŞs
[
j
].
T1
);

302 
zz_pX
 
	gdT1
 = 
diff
(
sŞs
[
j
].
T1X
);

303 
	gk
 = 0; k <ğ
deg
(
sŞs
[
j
].
T2
); k++){

304 
zz_pE
 
	gtmp
;

305 
cÚv
(
tmp
, 
MulMod
(
dT1
, 
»p
(
cÛff
(
sŞs
[
j
].
T2
, 
k
)), sŞs[j].
T1X
));

306 
S‘CÛff
(
sŞs
[
j
].
T2
, 
k
, 
tmp
);

310 
	gimages_sŞs_5
.
­³nd
(
sŞs
);

311 
	g´imes_5
.
­³nd
(
p
);

312 
	gVec
<> 
	gdeg_X
, 
	gdeg_Y
;

313 
	gdeg_X
.
S‘L’gth
(
sz
);

314 
	gdeg_Y
.
S‘L’gth
(
sz
);

315 
	gj
 = 0; j < 
	gsz
; j++){

316 
	gdeg_X
[
j
] = 
deg
(
sŞs
[j].
T1X
);

317 
	gdeg_Y
[
j
] = 
deg
(
sŞs
[j].
T2
);

319 
	gli¡_deg_X
.
­³nd
(
deg_X
);

320 
	gli¡_deg_Y
.
­³nd
(
deg_Y
);

327 
	gVec
<> 
	gnbs
;

328 
	gnbs
.
S‘L’gth
(5);

329 
	gi
 = 0; i < 5; i++){

330 
	gnbs
[
i
] = 0;

331 
	gj
 = 0; j < 5; j++)

332 ià((
	gli¡_deg_X
[
i
] =ğ
li¡_deg_X
[
j
]è&& (
li¡_deg_Y
[i] ==†ist_deg_Y[j]))

333 
nbs
[
i
]++;

336 
	gmx
 = 0;

337 
	gi
 = 1; i < 5; i++)

338 ià(
	gnbs
[
i
] >‚bs[
mx
])

339 
	gmx
 = 
i
;

341 
	gVec
<> 
	gdeg_X
 = 
li¡_deg_X
[
mx
];

342 
	gVec
<> 
	gdeg_Y
 = 
li¡_deg_Y
[
mx
];

343 
	gsz
 = 
deg_X
.
Ëngth
();

346 ià(
	gsz
 == 0){

347 
sŞs
.
S‘L’gth
(0);

358 
	gVec
<Vec<Vec<Vec<>>>> 
	gimages_T2
;

359 
£t_®l_Ëngths
(
images_T2
, 
sz
, 
deg_X
, 
deg_Y
);

365 
	gVec
<> 
	g´imes
;

366 
ZZ
 
	gmodulus
 = 
to_ZZ
(1);

367 
	gi
 = 0; i < 5; i++)

368 ià((
	gdeg_X
 =ğ
li¡_deg_X
[
i
]è&& (
deg_Y
 =ğ
li¡_deg_Y
[i])){

369 
add_to
(
images_T2
, 
images_sŞs_5
[
i
], 
deg_X
, 
deg_Y
);

370 
	g´imes
.
­³nd
(
´imes_5
[
i
]);

371 
	gmodulus
 *ğ
´imes_5
[
i
];

378 
	gp_w™Ãss
;

379 
	gVec
<Vec<Vec<>>> 
	gT_w™Ãss
;

380 
	gT_w™Ãss
.
S‘L’gth
(
sz
);

381 
£t_®l_Ëngths
(
T_w™Ãss
, 
sz
, 
deg_X
, 
deg_Y
);

383 
boŞ
 
	gfound_w™Ãss
 = 
çl£
;

384 ! 
	gfound_w™Ãss
){

385 
	gp
 = 
NextPrime
(
p
+1);

387 
	gzz_p
::
š™
(
p
);

388 
zz_pXY
 
	gF
, 
	gG
;

389 
cÚv
(
F
, 
FZ
);

390 
cÚv
(
G
, 
GZ
);

391 
	gVec
<
	gzz_pEX_augm’‹d
> 
	gsŞs_w™Ãss
;

392 
sŞve
(
sŞs_w™Ãss
, 
F
, 
G
);

394 
	gsz_loÿl
 = 
sŞs_w™Ãss
.
Ëngth
();

395 ià(
	gsz_loÿl
 !ğ
sz
)

397 
	gj
 = 0; j < 
	gsz
; j++){

398 ià(
deg
(
sŞs_w™Ãss
[
j
].
T1X
è!ğ
deg_X
[j])

400 ià(
deg
(
sŞs_w™Ãss
[
j
].
T2
è!ğ
deg_Y
[j])

404 
	gj
 = 0; j < 
	gsz
; j++){

405 
zz_pEPush
 
push
(
sŞs_w™Ãss
[
j
].
T1
);

406 
zz_pX
 
	gdT1
 = 
diff
(
sŞs_w™Ãss
[
j
].
T1X
);

407 
	gk
 = 0; k <ğ
deg
(
sŞs_w™Ãss
[
j
].
T2
); k++){

408 
zz_pE
 
	gtmp
;

409 
cÚv
(
tmp
, 
MulMod
(
dT1
, 
»p
(
cÛff
(
sŞs_w™Ãss
[
j
].
T2
, 
k
)), sŞs_w™Ãss[j].
T1X
));

410 
S‘CÛff
(
sŞs_w™Ãss
[
j
].
T2
, 
k
, 
tmp
);

414 
	gfound_w™Ãss
 = 
Œue
;

415 
	gp_w™Ãss
 = 
p
;

416 
£t
(
T_w™Ãss
, 
sŞs_w™Ãss
, 
deg_X
, 
deg_Y
);

420 
	gVec
<Vec<Vec<
	gZZ
>>> 
	gT2
;

421 
	gT2
.
S‘L’gth
(
sz
);

422 
£t_®l_Ëngths
(
T2
, 
sz
, 
deg_X
, 
deg_Y
);

425 
	gVec
<Vec<Vec<
	gZZ
>>> 
	gT2_»c
;

426 
	gT2_»c
.
S‘L’gth
(
sz
);

427 
	gVec
<
	gZZ
> 
	gT2_d’
;

428 
	gT2_d’
.
S‘L’gth
(
sz
);

434 
boŞ
 
	gfšished
 = 
çl£
;

435 
	gÃxŠum
 = 
û
Ğ1.5*()
´imes
.
Ëngth
() );

436 !
	gfšished
){

438 
	gt
;

440 
	gt
 = 
G‘Time
();

441 
	gp
 = 
NextPrime
(
p
+1);

442 
	gzz_p
::
š™
(
p
);

443 
zz_pXY
 
	gF
, 
	gG
;

444 
cÚv
(
F
, 
FZ
);

445 
cÚv
(
G
, 
GZ
);

446 
	gû¼
 << "time1: in™ " << 
G‘Time
()-
	gt
 << 
	g’dl
;

448 
	gt
 = 
G‘Time
();

449 
	gVec
<
	gzz_pEX_augm’‹d
> 
	gsŞs
;

450 
sŞve
(
sŞs
, 
F
, 
G
);

451 
	gû¼
 << "time2: sŞv" << 
G‘Time
()-
	gt
 << 
	g’dl
;

453 
	gt
 = 
G‘Time
();

454 
	gsz_loÿl
 = 
sŞs
.
Ëngth
();

455 ià(
	gsz_loÿl
 !ğ
sz
)

457 
	gj
 = 0; j < 
	gsz
; j++){

458 ià(
deg
(
sŞs
[
j
].
T1X
è!ğ
deg_X
[j])

460 ià(
deg
(
sŞs
[
j
].
T2
è!ğ
deg_Y
[j])

463 
	gj
 = 0; j < 
	gsz
; j++){

464 
zz_pEPush
 
push
(
sŞs
[
j
].
T1
);

465 
zz_pX
 
	gdT1
 = 
diff
(
sŞs
[
j
].
T1X
);

466 
	gk
 = 0; k <ğ
deg
(
sŞs
[
j
].
T2
); k++){

467 
zz_pE
 
	gtmp
;

468 
cÚv
(
tmp
, 
MulMod
(
dT1
, 
»p
(
cÛff
(
sŞs
[
j
].
T2
, 
k
)), sŞs[j].
T1X
));

469 
S‘CÛff
(
sŞs
[
j
].
T2
, 
k
, 
tmp
);

472 
	g´imes
.
­³nd
(
p
);

473 
	gmodulus
 *ğ
p
;

474 
add_to
(
images_T2
, 
sŞs
, 
deg_X
, 
deg_Y
);

475 
	gû¼
 << "time3: cÚv”ˆ" << 
G‘Time
()-
	gt
 << 
	g’dl
;

477 ià(
	g´imes
.
Ëngth
(è< 
	gÃxŠum
)

480 
	gÃxŠum
 = 
û
Ğ1.5*()
´imes
.
Ëngth
() );

482 
	gt
 = 
G‘Time
();

483 
ZZ_CRT
 
üt
(
´imes
);

484 
	gj
 = 0; j < 
	gsz
; j++){

485 
	gdX
 = 
deg_X
[
j
];

486 
	gdY
 = 
deg_Y
[
j
];

487 
	gk
 = 0; k <ğ
dX
; k++)

488 
	güt
.
üt
(
T2
[
j
][0][
k
], 
images_T2
[j][0][k]);

489 
	g–l
 = 0;ƒÎ <ğ
dY
;ƒll++){

490 
	gk
 = 0; k < 
	gdX
; k++)

491 
	güt
.
üt
(
T2
[
j
][
–l
+1][
k
], 
images_T2
[j][ell+1][k]);

494 
	gû¼
 << "time4: c¹ " << 
G‘Time
()-
	gt
 << 
	g’dl
;

496 
	gt
 = 
G‘Time
();

497 
	gs1
 = 1;

498 
	gj
 = 0; j < 
	gsz
; j++)

499 
	gs1
 = 
s1
 * 
RecÚ¡ruùR©iÚ®
(
T2_»c
[
j
], 
T2_d’
[j], 
T2
[j], 
modulus
, 
T_w™Ãss
[j], 
p_w™Ãss
);

500 ià(
	gs1
 != 0)

501 
fšished
 = 
Œue
;

502 
	gû¼
 << "time5:„©»cÚ " << 
G‘Time
()-
	gt
 << 
	g’dl
;

505 
	gû¼
 << "-----numb” oà´imes: " << 
	g´imes
.
Ëngth
(è<< 
	g’dl
;

506 
	gsŞs
.
S‘L’gth
(
sz
);

511 
	gj
 = 0; j < 
	gsz
; j++){

512 
	gdX
 = 
deg_X
[
j
];

513 
	gdY
 = 
deg_Y
[
j
];

514 
	gsŞs
[
j
].
	gT1
 = 0;

515 
	gk
 = 0; k <ğ
dX
; k++)

516 
S‘CÛff
(
sŞs
[
j
].
T1
, 
k
, 
T2_»c
[j][0][k]);

517 
	gsŞs
[
j
].
	gT2
.
	gcÛffX
.
S‘L’gth
(
dY
+1);

518 
	g–l
 = 0;ƒÎ <ğ
dY
;ƒll++){

519 
	gk
 = 0; k < 
	gdX
; k++)

520 
S‘CÛff
(
sŞs
[
j
].
T2
.
cÛffX
[
–l
], 
k
, 
T2_»c
[j][ell+1][k]);

	@bivariate/src/lzz_pEX_augmented.cpp

1 
	~<NTL/toŞs.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/lzz_pX.h
>

4 
	~<NTL/lzz_pEX.h
>

5 
	~<NTL/lzz_pXFaùÜšg.h
>

7 
	~"magma_ouut.h
"

8 
	~"lzz_pX_CRT.h
"

9 
	~"lzz_pXY.h
"

10 
	~"lzz_pEX_augm’‹d.h
"

12 
NTL_CLIENT


18 
sqä“_decompos™iÚ
(
Vec
<
zz_pX
>& 
çùÜs
, cÚ¡ zz_pX& 
f
){

19 
zz_pX
 
	gdf
 = 
diff
(
f
);

20 
zz_pX
 
	gu
 = 
GCD
(
f
, 
df
);

21 
zz_pX
 
	gv
 = 
f
 / 
u
;

22 
zz_pX
 
	gw
 = 
df
 / 
u
;

24 
	gçùÜs
.
S‘L’gth
(0);

26 
zz_pX
 
	gb
 = 
w
 - 
diff
(
v
);

27 
zz_pX
 
	gh
 = 
GCD
(
v
, 
b
);

28 
	gv
 = 
v
 / 
h
;

29 
	gw
 = 
b
 / 
h
;

30 ià(
deg
(
h
) > 0)

31 
	gçùÜs
.
­³nd
(
h
);

32 } 
deg
(
v
) > 0);

42 
	$¥l™
(
zz_pX
 & 
mod_z”o
, zz_pX & 
mod_un™
, zz_pX & 
šv”£
, cÚ¡ zz_pX & 
–t
, cÚ¡ zz_pX & 
modulus
){

43 
mod_z”o
 = 
	`GCD
(
–t
, 
modulus
);

44 ià(
	`deg
(
mod_z”o
è< deg(
modulus
)){

45 
mod_un™
 = 
modulus
 / 
mod_z”o
;

46 
	`MakeMÚic
(
mod_un™
);

47 
šv”£
 = 
	`InvMod
(
–t
 % 
mod_un™
, mod_unit);

50 
mod_un™
 = 1;

51 
šv”£
 = 0;

53 
	}
}

64 
¥l™_fÜ_»guÏrize
(
Vec
<
zz_pX
> & 
çùÜ_modulus
, cÚ¡ Vec<zz_pX> & 
–ts
, cÚ¡ zz_pX & 
modulus
){

65 
	gçùÜ_modulus
.
S‘L’gth
(
deg
(
modulus
));

66 
zz_pX
 
	gtmp_modulus
 = 
modulus
;

67 
	gn
 = 
–ts
.
Ëngth
()-1;

68 
	gi
 = 0;

70 
	gn
 >ğ0 && 
deg
(
tmp_modulus
) > 0){

71 
zz_pX
 
gcd
 = 
GCD
(
–ts
[
n
], 
tmp_modulus
);

72 ià(
deg
(
gcd
è< deg(
tmp_modulus
)){

73 
	gçùÜ_modulus
[
i
] = 
tmp_modulus
 / 
gcd
;

74 
	gtmp_modulus
 = 
gcd
;

75 
	gi
++;

77 
	gn
--;

80 ià(
deg
(
tmp_modulus
) > 0){

81 
	gçùÜ_modulus
[
i
] = 
tmp_modulus
;

82 
	gi
++;

85 
	gçùÜ_modulus
.
S‘L’gth
(
i
);

100 
	$magma_ouut
(cÚ¡ 
zz_pEX_augm’‹d
 & 
F
){

101 
zz_pEPush
 
	`push
(
F
.
T1
);

102 
cout
 << "[";

103 
	`magma_ouut
(
F
.
T1X
, "X");

104 
cout
 << ", ";

105 
zz_pXY
 
t2
;

106 
	`cÚv
(
t2
, 
F
.
T2
);

107 
	`magma_ouut_bi
(
t2
);

108 
cout
 << "]";

109 
	}
}

114 
	$magma_assign
(cÚ¡ 
zz_pEX_augm’‹d
 & 
F
, cÚ¡ 
¡ršg
 & 
Çme
){

115 
cout
 << 
Çme
 << " := ";

116 
	`magma_ouut
(
F
);

117 
cout
 << ";" << 
’dl
;

118 
	}
}

123 
	$¿ndom_mÚic_zz_pEX_augm’‹d
(
zz_pEX_augm’‹d
 & 
»s
, 
dX
, 
dY
){

124 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
dX
);

125 
	`S‘CÛff
(
f
, 
dX
, 1);

127 
Vec
<
zz_pX
> 
g
;

129 
g
.
	`S‘L’gth
(
dY
+1);

130 ià(
dY
 >= 0){

131 
j
 = 0; j < 
dY
; j++)

132 
g
[
j
] = 
	`¿ndom_zz_pX
(
dX
);

134 
g
[
dY
] = 
	`¿ndom_zz_pX
(
dX
);

135 } 
	`deg
(
	`GCD
(
g
[
dY
], 
f
)) != 0);

137 
»s
 = 
	`zz_pEX_augm’‹d
(
f
, 
g
);

138 
	}
}

143 
	$mod
(
zz_pEX_augm’‹d
 & 
F_»duûd
, cÚ¡ zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX
 & 
Ãw_mod
){

144 ià(
F
.
T1X
 % 
Ãw_mod
 != 0){

145 
cout
 << "wrong…arameters in mod\n";

146 
	`ex™
(-1);

149 
Vec
<
zz_pX
> 
F_»d_cÛffs
;

150 
d
 = 
	`deg
(
F
.
T2
);

151 
F_»d_cÛffs
.
	`S‘L’gth
(
d
+1);

152 
i
 = 0; i <ğ
d
; i++)

153 
F_»d_cÛffs
[
i
] = 
	`»p
(
	`cÛff
(
F
.
T2
, i)è% 
Ãw_mod
;

155 
F_»duûd
 = 
	`zz_pEX_augm’‹d
(
Ãw_mod
, 
F_»d_cÛffs
);

156 
	}
}

161 
muÉimod
(
Vec
<
zz_pEX_augm’‹d
> & 
»duûd
, cÚ¡ zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX_CRT
 & 
Ãw_mod
){

162 ià(
	gF
.
	gT1X
 % 
	gÃw_mod
.
ma¡”
() != 0){

163 
cout
 << "wrong…arameters in mod\n";

164 
ex™
(-1);

167 
	gVec
<Vec<
	gzz_pX
>> 
	gF_»d_cÛffs
;

168 
	gn
 = 
Ãw_mod
.
Ëngth
();

169 
	g»duûd
.
S‘L’gth
(
n
);

170 
	gF_»d_cÛffs
.
S‘L’gth
(
n
);

172 
	gd
 = 
deg
(
F
.
T2
);

173 
	gk
 = 0; k < 
	gn
; k++)

174 
	gF_»d_cÛffs
[
k
].
S‘L’gth
(
d
+1);

175 
	gi
 = 0; i <ğ
d
; i++) {

176 
	gVec
<
	gzz_pX
> 
	gtmp
;

177 
	gÃw_mod
.
muÉimod
(
tmp
, 
»p
(
cÛff
(
F
.
T2
, 
i
)));

178 
	gk
 = 0; k < 
	gn
; k++)

179 
	gF_»d_cÛffs
[
k
][
i
] = 
tmp
[k];

181 
	gi
 = 0; i < 
	gn
; i++)

182 
	g»duûd
[
i
] = 
zz_pEX_augm’‹d
(
Ãw_mod
.
moduli
(i), 
F_»d_cÛffs
[i]);

189 
combše
(
zz_pEX_augm’‹d
 & 
»suÉ
, cÚ¡ 
Vec
<zz_pEX_augm’‹d> & 
»ms
){

191 
	gVec
<
	gzz_pX
> 
	gmods
;

192 
	gn
 = 
»ms
.
Ëngth
();

193 
	gmods
.
S‘L’gth
(
n
);

194 
	gi
 = 0; i < 
	gn
; i++)

195 
	gmods
[
i
] = 
»ms
[i].
T1X
;

196 
zz_pX_CRT
 
üt
(
mods
);

198 
	gVec
<
	gzz_pX
> 
	gcÛffs
;

199 
	gdmax
 = -1;

200 
	gk
 = 0; k < 
	gn
; k++)

201 
	gdmax
 = 
max
(
dmax
, 
deg
(
»ms
[
k
].
T2
));

202 
	gcÛffs
.
S‘L’gth
(
dmax
+1);

203 ià(
	gdmax
 != -1){

204 
Vec
<
zz_pX
> 
li¡
;

205 
	gli¡
.
S‘L’gth
(
n
);

206 
	gi
 = 0; i <ğ
dmax
; i++){

207 
	gk
 = 0; k < 
	gn
; k ++)

208 
	gli¡
[
k
] = 
»p
(
cÛff
(
»ms
[k].
T2
, 
i
));

209 
	güt
.
combše
(
cÛffs
[
i
], 
li¡
);

213 
	g»suÉ
 = 
zz_pEX_augm’‹d
(
üt
.
ma¡”
(), 
cÛffs
);

219 
make_mÚic_ªd_¥l™
(
Vec
<
zz_pEX_augm’‹d
> & 
mÚic_F
, cÚ¡ zz_pEX_augm’‹d & 
F
){

220 
	gVec
<
	gzz_pX
> 
	g¥l™_modulus
;

221 
	gVec
<
	gzz_pX
> 
	gcÛffs
;

222 
	gd
 = 
deg
(
F
.
T2
);

223 
	gcÛffs
.
S‘L’gth
(
d
+1);

224 
	gi
 = 0; i <ğ
d
; i++)

225 
	gcÛffs
[
i
] = 
»p
(
cÛff
(
F
.
T2
, i));

226 
¥l™_fÜ_»guÏrize
(
¥l™_modulus
, 
cÛffs
, 
F
.
T1X
);

227 
zz_pX_CRT
 
üt
(
¥l™_modulus
);

228 
muÉimod
(
mÚic_F
, 
F
, 
¥l™_modulus
);

235 
squ¬eä“
(
Vec
<
zz_pEX_augm’‹d
> & 
sqä“
, cÚ¡ zz_pEX_augm’‹d & 
f
){

237 
·œ_zz_pEX_augm’‹d
 
	g·œs
;

239 
zz_pEPush
 
push
(
f
.
T1
);

240 
	g·œs
 = 
·œ_zz_pEX_augm’‹d
(
f
.
T2
, 
diff
(f.T2));

243 
	gVec
<
	gzz_pEX_augm’‹d
> 
	ggcds
;

244 
»guÏr_gcd
(
gcds
, 
·œs
);

246 
	gVec
<
	gzz_pX
> 
	gmods
;

247 
	gmods
.
S‘L’gth
(
gcds
.
Ëngth
());

248 
	gi
 = 0; i < 
	ggcds
.
Ëngth
(); i++)

249 
	gmods
[
i
] = 
gcds
[i].
T1X
;

250 
zz_pX_CRT
 
üt
(
mods
);

251 
muÉimod
(
sqä“
, 
f
, 
mods
);

253 
	gi
 = 0; i < 
	ggcds
.
Ëngth
(); i++){

254 
zz_pEPush
 
push
(
gcds
[
i
].
T1
);

255 
	gsqä“
[
i
].
	gT2
 = 
sqä“
[i].
T2
 / 
gcds
[i].T2;

256 
MakeMÚic
(
sqä“
[
i
].
T2
);

264 
squ¬eä“
(
Vec
<
zz_pEX_augm’‹d
> & 
sqä“
, cÚ¡ Vec<zz_pEX_augm’‹d> & 
f
){

265 
	gsqä“
.
S‘L’gth
(0);

267 
	gi
 = 0; i < 
	gf
.
Ëngth
(); i++){

268 
	gVec
<
	gzz_pEX_augm’‹d
> 
	gtmp
;

269 
squ¬eä“
(
tmp
, 
f
[
i
]);

270 
	gsqä“
.
­³nd
(
tmp
);

278 
sŞve
(
Vec
<
zz_pEX_augm’‹d
> & 
sŞs
, cÚ¡ 
zz_pXY
 & 
f
, cÚ¡ zz_pXY & 
g
){

279 
zz_pX
 
	g»s
, 
	g¤es0
, 
	g¤es1
;

280 
	gVec
<
	gzz_pEX_augm’‹d
> 
	gsŞs_muÉ
;

282 
	gt
;

283 
	gt
 = 
G‘Time
();

284 
»suÉªt
(
»s
, 
¤es0
, 
¤es1
, 
f
, 
g
);

285 ià(
	g»s
 == 0){

286 
sŞs
.
S‘L’gth
(0);

289 
	gû¼
 << "»suÉªt: " << 
G‘Time
()-
	gt
 << ", deg»e=" << 
deg
(
»s
è<< 
	g’dl
;

291 
	gt
 = 
G‘Time
();

292 
	gVec
<
	gzz_pX
> 
	guu
;

293 
sqä“_decompos™iÚ
(
uu
, 
»s
);

294 
	gû¼
 << "squ¬eä“: " << 
G‘Time
()-
	gt
 << ", size=" << 
	guu
.
Ëngth
(è<< 
	g’dl
;

296 
	gt
 = 
G‘Time
();

297 
	gsŞs_muÉ
.
S‘L’gth
(0);

298 
	gi
 = 0; i < 
	guu
.
Ëngth
(); i++){

299 
zz_pX
 
	gu0
, 
	gu1
, 
	gšv
;

300 
¥l™
(
u0
, 
u1
, 
šv
, 
¤es1
, 
uu
[
i
]);

301 ià(
deg
(
u1
) > 0){

302 
	gVec
<
	gzz_pX
> 
	gtmp_šv2
;

303 
	gtmp_šv2
.
S‘L’gth
(2);

304 
	gtmp_šv2
[1] = 1;

305 
	gtmp_šv2
[0] = (
šv
*
¤es0
è% 
u1
;

306 
zz_pEX_augm’‹d
 
tmp_šv
(
u1
, 
tmp_šv2
);

307 
	gsŞs_muÉ
.
­³nd
(
tmp_šv
);

309 ià(
deg
(
u0
) > 0){

310 
·œ_zz_pEX_augm’‹d
 
	gfg_EX
 =…aœ_zz_pEX_augm’‹d(
u0
, 
f
, 
g
);

311 
	gVec
<
	gzz_pEX_augm’‹d
> 
	gtmp
;

312 
»guÏr_gcd
(
tmp
, 
fg_EX
);

313 
	gsŞs_muÉ
.
­³nd
(
tmp
);

316 
squ¬eä“
(
sŞs
, 
sŞs_muÉ
);

317 
	gû¼
 << "GCD: " << 
G‘Time
()-
	gt
 << 
	g’dl
;

332 
	$magma_ouut
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
F
){

333 
zz_pEPush
 
	`push
(
F
.
T1
);

334 
zz_pXY
 
t2
;

336 
cout
 << "[";

337 
	`magma_ouut
(
F
.
T1X
, "X");

338 
cout
 << ", ";

339 
	`cÚv
(
t2
, 
F
.
T20
);

340 
	`magma_ouut_bi
(
t2
);

341 
cout
 << ", ";

342 
	`cÚv
(
t2
, 
F
.
T21
);

343 
	`magma_ouut_bi
(
t2
);

344 
cout
 << "]";

345 
	}
}

350 
	$magma_assign
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
F
, cÚ¡ 
¡ršg
 & 
Çme
){

351 
cout
 << 
Çme
 << " := ";

352 
	`magma_ouut
(
F
);

353 
cout
 << ";" << 
’dl
;

354 
	}
}

359 
	$¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
·œ_zz_pEX_augm’‹d
 & 
»s
, 
dX
, 
dY0
, 
dY1
){

360 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
dX
);

361 
	`S‘CÛff
(
f
, 
dX
, 1);

363 
Vec
<
zz_pX
> 
g0
, 
g1
;

365 
g0
.
	`S‘L’gth
(
dY0
+1);

366 ià(
dY0
 >= 0){

367 
j
 = 0; j < 
dY0
; j++)

368 
g0
[
j
] = 
	`¿ndom_zz_pX
(
dX
);

370 
g0
[
dY0
] = 
	`¿ndom_zz_pX
(
dX
);

371 } 
	`deg
(
	`GCD
(
g0
[
dY0
], 
f
)) != 0);

374 
g1
.
	`S‘L’gth
(
dY1
+1);

375 ià(
dY1
 >= 0){

376 
j
 = 0; j < 
dY1
; j++)

377 
g1
[
j
] = 
	`¿ndom_zz_pX
(
dX
);

379 
g1
[
dY1
] = 
	`¿ndom_zz_pX
(
dX
);

380 } 
	`deg
(
	`GCD
(
g1
[
dY1
], 
f
)) != 0);

383 
»s
 = 
	`·œ_zz_pEX_augm’‹d
(
f
, 
g0
, 
g1
);

384 
	}
}

389 
	$mod
(
·œ_zz_pEX_augm’‹d
 & 
F_»duûd
, cÚ¡…aœ_zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX
 & 
Ãw_mod
){

390 ià(
F
.
T1X
 % 
Ãw_mod
 != 0){

391 
cout
 << "wrong…arameters in mod\n";

392 
	`ex™
(-1);

395 
Vec
<
zz_pX
> 
F_»d_cÛffs0
, 
F_»d_cÛffs1
;

397 
d0
 = 
	`deg
(
F
.
T20
);

398 
F_»d_cÛffs0
.
	`S‘L’gth
(
d0
+1);

399 
i
 = 0; i <ğ
d0
; i++)

400 
F_»d_cÛffs0
[
i
] = 
	`»p
(
	`cÛff
(
F
.
T20
, i)è% 
Ãw_mod
;

402 
d1
 = 
	`deg
(
F
.
T21
);

403 
F_»d_cÛffs1
.
	`S‘L’gth
(
d1
+1);

404 
i
 = 0; i <ğ
d1
; i++)

405 
F_»d_cÛffs1
[
i
] = 
	`»p
(
	`cÛff
(
F
.
T21
, i)è% 
Ãw_mod
;

407 
F_»duûd
 = 
	`·œ_zz_pEX_augm’‹d
(
Ãw_mod
, 
F_»d_cÛffs0
, 
F_»d_cÛffs1
);

408 
	}
}

413 
muÉimod
(
Vec
<
·œ_zz_pEX_augm’‹d
> & 
»duûd
, cÚ¡…aœ_zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX_CRT
 & 
Ãw_mod
){

414 ià(
	gF
.
	gT1X
 % 
	gÃw_mod
.
ma¡”
() != 0){

415 
cout
 << "wrong…arameters in mod\n";

416 
ex™
(-1);

419 
	gVec
<Vec<
	gzz_pX
>> 
	gF_»d_cÛffs0
, 
	gF_»d_cÛffs1
;

421 
	gn
 = 
Ãw_mod
.
Ëngth
();

422 
	g»duûd
.
S‘L’gth
(
n
);

423 
	gF_»d_cÛffs0
.
S‘L’gth
(
n
);

424 
	gF_»d_cÛffs1
.
S‘L’gth
(
n
);

426 
	gd0
 = 
deg
(
F
.
T20
);

427 
	gk
 = 0; k < 
	gn
; k++)

428 
	gF_»d_cÛffs0
[
k
].
S‘L’gth
(
d0
+1);

429 
	gi
 = 0; i <ğ
d0
; i++) {

430 
	gVec
<
	gzz_pX
> 
	gtmp
;

431 
	gÃw_mod
.
muÉimod
(
tmp
, 
»p
(
cÛff
(
F
.
T20
, 
i
)));

432 
	gk
 = 0; k < 
	gn
; k++)

433 
	gF_»d_cÛffs0
[
k
][
i
] = 
tmp
[k];

436 
	gd1
 = 
deg
(
F
.
T21
);

437 
	gk
 = 0; k < 
	gn
; k++)

438 
	gF_»d_cÛffs1
[
k
].
S‘L’gth
(
d1
+1);

439 
	gi
 = 0; i <ğ
d1
; i++) {

440 
	gVec
<
	gzz_pX
> 
	gtmp
;

441 
	gÃw_mod
.
muÉimod
(
tmp
, 
»p
(
cÛff
(
F
.
T21
, 
i
)));

442 
	gk
 = 0; k < 
	gn
; k++)

443 
	gF_»d_cÛffs1
[
k
][
i
] = 
tmp
[k];

446 
	gi
 = 0; i < 
	gn
; i++)

447 
	g»duûd
[
i
] = 
·œ_zz_pEX_augm’‹d
(
Ãw_mod
.
moduli
(i), 
F_»d_cÛffs0
[i], 
F_»d_cÛffs1
[i]);

453 
combše
(
·œ_zz_pEX_augm’‹d
 & 
»suÉ
, cÚ¡ 
Vec
<·œ_zz_pEX_augm’‹d> & 
»ms
){

455 
	gVec
<
	gzz_pX
> 
	gmods
;

456 
	gn
 = 
»ms
.
Ëngth
();

457 
	gmods
.
S‘L’gth
(
n
);

458 
	gi
 = 0; i < 
	gn
; i++)

459 
	gmods
[
i
] = 
»ms
[i].
T1X
;

460 
zz_pX_CRT
 
üt
(
mods
);

462 
	gVec
<
	gzz_pX
> 
	gcÛffs0
;

463 
	gdmax0
 = -1;

464 
	gk
 = 0; k < 
	gn
; k++)

465 
	gdmax0
 = 
max
(
dmax0
, 
deg
(
»ms
[
k
].
T20
));

466 
	gcÛffs0
.
S‘L’gth
(
dmax0
+1);

467 ià(
	gdmax0
 != -1){

468 
Vec
<
zz_pX
> 
li¡
;

469 
	gli¡
.
S‘L’gth
(
n
);

470 
	gi
 = 0; i <ğ
dmax0
; i++){

471 
	gk
 = 0; k < 
	gn
; k ++)

472 
	gli¡
[
k
] = 
»p
(
cÛff
(
»ms
[k].
T20
, 
i
));

473 
	güt
.
combše
(
cÛffs0
[
i
], 
li¡
);

477 
	gVec
<
	gzz_pX
> 
	gcÛffs1
;

478 
	gdmax1
 = -1;

479 
	gk
 = 0; k < 
	gn
; k++)

480 
	gdmax1
 = 
max
(
dmax1
, 
deg
(
»ms
[
k
].
T21
));

481 
	gcÛffs1
.
S‘L’gth
(
dmax1
+1);

482 ià(
	gdmax1
 != -1){

483 
Vec
<
zz_pX
> 
li¡
;

484 
	gli¡
.
S‘L’gth
(
n
);

485 
	gi
 = 0; i <ğ
dmax1
; i++){

486 
	gk
 = 0; k < 
	gn
; k ++)

487 
	gli¡
[
k
] = 
»p
(
cÛff
(
»ms
[k].
T21
, 
i
));

488 
	güt
.
combše
(
cÛffs1
[
i
], 
li¡
);

492 
	g»suÉ
 = 
·œ_zz_pEX_augm’‹d
(
üt
.
ma¡”
(), 
cÛffs0
, 
cÛffs1
);

498 
make_mÚic_ªd_¥l™
(
Vec
<
·œ_zz_pEX_augm’‹d
> & 
mÚic_F
, cÚ¡…aœ_zz_pEX_augm’‹d & 
F
, 
idx
){

499 
	gVec
<
	gzz_pX
> 
	g¥l™_modulus
;

500 
	gVec
<
	gzz_pX
> 
	gcÛffs
;

502 ià(
	gidx
 == 0){

503 
d
 = 
deg
(
F
.
T20
);

504 
	gcÛffs
.
S‘L’gth
(
d
+1);

505 
	gi
 = 0; i <ğ
d
; i++)

506 
	gcÛffs
[
i
] = 
»p
(
cÛff
(
F
.
T20
, i));

508 ià(
	gidx
 == 1){

509 
d
 = 
deg
(
F
.
T21
);

510 
	gcÛffs
.
S‘L’gth
(
d
+1);

511 
	gi
 = 0; i <ğ
d
; i++)

512 
	gcÛffs
[
i
] = 
»p
(
cÛff
(
F
.
T21
, i));

515 
	gcout
 << "wrong…arametero make_monic_and_split\n";

516 
ex™
(-1);

519 
¥l™_fÜ_»guÏrize
(
¥l™_modulus
, 
cÛffs
, 
F
.
T1X
);

520 
zz_pX_CRT
 
üt
(
¥l™_modulus
);

521 
muÉimod
(
mÚic_F
, 
F
, 
¥l™_modulus
);

531 
	s_zz_pEX_loÿl_¡ack
 {

532 
	mtİ
;

533 
	mVec
<
	m·œ_zz_pEX_augm’‹d
> 
	md©a
;

535 
_zz_pEX_loÿl_¡ack
() {

536 
	mtİ
 = -1;

539 
pİ
(
·œ_zz_pEX_augm’‹d
 & 
a
) {

540 
	ma
 = 
d©a
[
tİ
];

541 
	mtİ
--;

544 
size
() const {

545  
	mtİ
+1;

548 
em±y
() const {

549  (
	mtİ
 == -1);

552 
push
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
a
){

553 ià(
	mtİ
+1 >ğ
d©a
.
Ëngth
())

554 
d©a
.
S‘L’gth
(
max
(32, (1.414*d©a.
Ëngth
())));

555 
	mtİ
++;

556 
	md©a
[
tİ
] = 
a
;

559 
push
(cÚ¡ 
zz_pECÚ‹xt
 & 
ùx
, cÚ¡ 
zz_pEX
 & 
a
, cÚ¡ zz_pEX & 
b
){

560 ià(
	mtİ
+1 >ğ
d©a
.
Ëngth
()) {

561 
d©a
.
S‘L’gth
(
max
(32, (1.414*d©a.
Ëngth
())));

562 
	mtİ
++;

564 
zz_pEPush
 
push
(
ùx
);

565 
	md©a
[
tİ
] = 
·œ_zz_pEX_augm’‹d
(
a
, 
b
);

572 
»guÏr_gcd
(
Vec
<
zz_pEX_augm’‹d
> & 
h
, cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
a_b
){

573 
_zz_pEX_loÿl_¡ack
 
	g¡ack
;

575 
	gVec
<
	g·œ_zz_pEX_augm’‹d
> 
	ga_mÚic_b
;

576 
make_mÚic_ªd_¥l™
(
a_mÚic_b
, 
a_b
, 0);

578 
	gi
 = 0; i < 
	ga_mÚic_b
.
Ëngth
(); i++){

579 
	gVec
<
	g·œ_zz_pEX_augm’‹d
> 
	ga_mÚic_b_mÚic
;

580 
make_mÚic_ªd_¥l™
(
a_mÚic_b_mÚic
, 
a_mÚic_b
[
i
], 1);

581 
	gj
 = 0; j < 
	ga_mÚic_b_mÚic
.
Ëngth
(); j++)

582 
	g¡ack
.
push
(
a_mÚic_b_mÚic
[
j
]);

585 
	gnb
 = 0;

586 
	gh
.
S‘L’gth
(0);

588 ! 
	g¡ack
.
em±y
()){

589 
·œ_zz_pEX_augm’‹d
 
	gcu¼’t
;

590 
	g¡ack
.
pİ
(
cu¼’t
);

591 
zz_pEPush
 
push
(
cu¼’t
.
T1
);

593 
	gd0
 = 
deg
(
cu¼’t
.
T20
);

594 
	gd1
 = 
deg
(
cu¼’t
.
T21
);

596 ià(
	gd0
 == -1){

597 ià(
nb
 =ğ
h
.
Ëngth
())

598 
h
.
S‘L’gth
(
max
(32, (1.414*h.
Ëngth
())));

599 
	gh
[
nb
] = 
zz_pEX_augm’‹d
(
cu¼’t
.
T21
);

600 
	gnb
++;

602 ià(
	gd1
 == -1){

603 ià(
nb
 =ğ
h
.
Ëngth
())

604 
h
.
S‘L’gth
(
max
(32, (1.414*h.
Ëngth
())));

605 
	gh
[
nb
] = 
zz_pEX_augm’‹d
(
cu¼’t
.
T20
);

606 
	gnb
++;

608 ià(
	gd0
 < 
	gd1
){

609 
	gVec
<
	g·œ_zz_pEX_augm’‹d
> 
	gÃxt
;

610 
make_mÚic_ªd_¥l™
(
Ãxt
, 
·œ_zz_pEX_augm’‹d
(
cu¼’t
.
T21
 % cu¼’t.
T20
, current.T20), 0);

611 
	gi
 = 0; i < 
	gÃxt
.
Ëngth
(); i++)

612 
	g¡ack
.
push
(
Ãxt
[
i
]);

615 
	gVec
<
	g·œ_zz_pEX_augm’‹d
> 
	gÃxt
;

616 
make_mÚic_ªd_¥l™
(
Ãxt
, 
·œ_zz_pEX_augm’‹d
(
cu¼’t
.
T20
 % cu¼’t.
T21
, current.T21), 0);

617 
	gi
 = 0; i < 
	gÃxt
.
Ëngth
(); i++)

618 
	g¡ack
.
push
(
Ãxt
[
i
]);

622 
	gh
.
S‘L’gth
(
nb
);

624 
	gi
 = 0; i < 
	gnb
; i++){

625 
zz_pEPush
 
push
(
h
[
i
].
T1
);

626 
MakeMÚic
(
h
[
i
].
T2
);

	@bivariate/src/lzz_pXY.cpp

1 
	~<NTL/toŞs.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/lzz_pEX.h
>

6 
	~"magma_ouut.h
"

7 
	~"m©_lzz_pX_exŒa.h
"

8 
	~"lzz_pX_CRT.h
"

9 
	~"lzz_pXY.h
"

10 
	~"ZZXY.h
"

24 
	gzz_pXY
::
	$tdeg
() const {

25 
»s
 = -1;

26 
i
 = 0; i < 
cÛffX
.
	`Ëngth
(); i++)

27 
»s
 = 
	`max
Ôes, 
	`deg
(
cÛffX
[
i
]) + i);

28  
»s
;

29 
	}
}

34 
	gzz_pXY
::
	$degY
() const {

35  
cÛffX
.
	`Ëngth
()-1;

36 
	}
}

41 
	gzz_pXY
::
	$degX
() const {

42 
d
 = -1;

43 
i
 = 0; i < 
cÛffX
.
	`Ëngth
(); i++)

44 
d
 = 
	`max
(d, 
	`deg
(
cÛffX
[
i
]));

45  
d
;

46 
	}
}

52 
	gzz_pXY
::
	$nÜm®ize
(){

53 
idx
 = 
cÛffX
.
	`Ëngth
()-1;

54 
idx
 >ğ0 && 
cÛffX
[idx] == 0)

55 
idx
--;

56 
cÛffX
.
	`S‘L’gth
(
idx
+1);

57 
	}
}

62 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gs
, cÚ¡ 
	gzz_pXY
& 
	ga
){

63  
	gs
 << 
	ga
.
	gcÛffX
;

69 
	$magma_š™_Y
(){

70 
cout
 << "V<y> := PolynomialRing(U);\n";

71 
	}
}

76 
	$magma_š™_bi
(){

77 
cout
 << "M<Y,X> := PolynomialRing(k,2);\n";

78 
	}
}

83 
	$magma_ouut
(cÚ¡ 
zz_pXY
 & 
a
){

84 
cout
 << "V!([";

85 
d
 = 
a
.
	`degY
();

86 ià(
d
 == -1){

87 
cout
 << "])";

90 
i
 = 0; i < 
d
; i++){

91 
	`magma_ouut
(
a
.
cÛffX
[
i
]);

92 
cout
 << ", ";

94 
	`magma_ouut
(
a
.
cÛffX
[
d
]);

95 
cout
 << "])";

96 
	}
}

101 
	$magma_assign
(cÚ¡ 
zz_pXY
 & 
a
, cÚ¡ 
¡ršg
 & 
n
){

102 
cout
 << 
n
 << " := ";

103 
	`magma_ouut
(
a
);

104 
cout
 << ";" << 
’dl
;

105 
	}
}

110 
	$magma_ouut_bi
(cÚ¡ 
zz_pXY
 & 
a
){

111 
cout
 << "(M!(0)";

112 
d
 = 
a
.
	`degY
();

113 
i
 = 0; i <ğ
d
; i++){

114 
cout
 << "+(";

115 
	`magma_ouut
(
a
.
cÛffX
[
i
], "X");

116 
cout
 << ")*Y^" << 
i
;

118 
cout
 << ")";

119 
	}
}

124 
	$magma_assign_bi
(cÚ¡ 
zz_pXY
 & 
a
, cÚ¡ 
¡ršg
 & 
Çme
){

125 
cout
 << 
Çme
 << " := ";

126 
	`magma_ouut_bi
(
a
);

127 
cout
 << ";" << 
’dl
;

128 
	}
}

133 
	$¿ndom_zz_pXY
(
zz_pXY
 & 
f
, 
dx
, 
dy
){

134 
f
.
cÛffX
.
	`S‘L’gth
(
dy
+1);

135 
i
 = 0; i <ğ
dy
; i++)

136 
f
.
cÛffX
[
i
] = 
	`¿ndom_zz_pX
(
dx
);

137 
	}
}

143 
ev®u©e
(
Vec
<
zz_pX
> & 
v®ues
, cÚ¡ 
zz_pXY
 & 
f
, cÚ¡ 
zz_pX_MuÉošt
 & 
ev
){

144 
	gVec
<Vec<
	gzz_p
>> 
	gv®
;

145 
	gev
.
ev®u©e
(
v®
, 
f
.
cÛffX
);

147 
	gd
 = 
f
.
degY
();

148 
	gn
 = 
ev
.
Ëngth
();

149 
	gv®ues
.
S‘L’gth
(
n
);

150 
	gj
 = 0; j < 
	gn
; j++){

151 
	gv®ues
[
j
].
	g»p
.
S‘L’gth
(
d
+1);

152 
zz_p
 *
	gcf
 = 
v®ues
[
j
].
»p
.
–ts
();

153 
	gi
 = 0; i <ğ
d
; i++)

154 
	gcf
[
i
] = 
v®
[i][
j
];

155 
	gv®ues
[
j
].
nÜm®ize
();

173 
	$»suÉªt_sub»suÉªt
(
zz_p
& 
¼es
, 
zz_pX
& 
sub»s1
, zz_pX& 
sub»s2
, cÚ¡ zz_pX& 
a
, cÚ¡ zz_pX& 
b
){

174 
zz_p
 
»s
, 
§ved_»s
;

176 
	`ş—r
(
sub»s1
);

177 
	`ş—r
(
sub»s2
);

179 ià(
	`IsZ”o
(
a
è|| IsZ”o(
b
))

180 
	`ş—r
(
»s
);

181 ià(
	`deg
(
a
è=ğ0 && deg(
b
) == 0)

182 
	`£t
(
»s
);

184 
d0
, 
d1
, 
d2
;

185 
sg
 = 1;

186 
zz_p
 
lc
;

187 
	`£t
(
»s
);

189 
n
 = 
	`max
(
	`deg
(
a
),deg(
b
)) + 1;

190 
zz_pX
 
	`u
(
INIT_SIZE
, 
n
), 
	`v
(INIT_SIZE,‚), 
	`§ved_u
(INIT_SIZE,‚);

192 
u
 = 
a
;

193 
v
 = 
b
;

196 
d0
 = 
	`deg
(
u
);

197 
d1
 = 
	`deg
(
v
);

198 
lc
 = 
	`L—dCÛff
(
v
);

200 
§ved_u
 = 
u
;

201 
	`PÏšRem
(
u
, u, 
v
);

202 
	`sw­
(
u
, 
v
);

204 
d2
 = 
	`deg
(
v
);

205 ià(
d2
 >= 0) {

206 
	`pow”
(
lc
,†c, 
d0
-
d2
);

207 
§ved_»s
 = 
»s
;

208 
	`mul
(
»s
,„es, 
lc
);

209 ià(
d0
 & 
d1
 & 1)

210 
NTL
::
	`Ãg©e
(
»s
,„es);

211 ià(!((
d0
-
d1
) & 1))

212 
sg
 = -sg;

215 ià(
d1
 == 0) {

216 
sub»s1
 = 
sg
*
§ved_»s
*
§ved_u
;

217 ià(
	`deg
(
sub»s1
) > 1) {

218 
sub»s2
 = 
sub»s1
;

219 ià(
	`deg
(
sub»s1
) > 2)

220 
	`ş—r
(
sub»s1
);

222 
sub»s1
 = 
§ved_»s
*
lc
*
	`pow”
(
	`L—dCÛff
(
§ved_u
),
d0
);

224 
	`pow”
(
lc
,†c, 
d0
);

225 
	`mul
(
»s
,„es, 
lc
);

228 
sub»s1
 = 
sg
*
»s
*
u
;

229 ià(
	`deg
(
sub»s1
) > 1) {

230 
sub»s2
 = 
sub»s1
;

231 ià(
	`deg
(
sub»s1
) > 2)

232 
	`ş—r
(
sub»s1
);

234 
sub»s1
 = 
»s
*
lc
*
	`pow”
(
	`L—dCÛff
(
u
),
d0
);

236 
	`ş—r
(
»s
);

242 
¼es
 = 
»s
;

244 
	}
}

252 
	$»suÉªt
(
zz_pX
 & 
»s
, zz_pX& 
sub»s0
, zz_pX& 
sub»s1
, cÚ¡ 
zz_pXY
& 
f
, cÚ¡ zz_pXY& 
g
){

253 
dyf
 = 
f
.
	`degY
();

254 
dyg
 = 
g
.
	`degY
();

256 
df
 = 
f
.
	`tdeg
();

257 
dg
 = 
g
.
	`tdeg
();

259 
xŒa
 = 10;

260 
dr
 = 
df
*
dg
 + 
xŒa
;

262 
Vec
<
zz_p
> 
v®ues
;

263 
v®ues
.
	`S‘L’gth
(
dr
);

265 
zz_pX_MuÉošt
 * 
ev
;

266 
zz_pX_MuÉošt_G’”®
 
evQ
;

267 
zz_pX_MuÉošt_Geom‘ric
 
evG
;

270 
zz_p
 
a0
 = 
	`¿ndom_zz_p
();

271 
zz_p
 
a
 = 
a0
*a0;

272 
zz_p
 
pow_a
 = 
	`to_zz_p
(1);

273 
OK
 = 1;

275 ià(
	`ev®
(
f
.
cÛffX
[
dyf
], 
pow_a
è=ğ0 ||ƒv®(
g
.cÛffX[
dyg
],…ow_a) == 0)

276 
OK
 = 0;

277 
i
 = 0; i < 
dr
; i++){

278 
pow_a
 *ğ
a
;

279 ià(
pow_a
 =ğ
	`to_zz_p
(1))

280 
OK
 = 0;

281 ià(
	`ev®
(
f
.
cÛffX
[
dyf
], 
pow_a
è=ğ0 ||ƒv®(
g
.cÛffX[
dyg
],…ow_a) == 0)

282 
OK
 = 0;

285 ià(
OK
 == 1){

286 
evG
 = 
	`zz_pX_MuÉošt_Geom‘ric
(
a0
, 
df
+1, 
dr
, 1);

287 
ev
 = &
evG
;

290 
Vec
<
zz_p
> 
pošts
;

291 
pošts
.
	`S‘L’gth
(
dr
);

292 
i
 = 0; i < 
dr
; i++){

293 
zz_p
 
±
;

295 
±
 = 
	`¿ndom_zz_p
();

296 } 
	`ev®
(
f
.
cÛffX
[
dyf
], 
±
è=ğ0 ||ƒv®(
g
.cÛffX[
dyg
],…t) == 0);

297 
pošts
[
i
] = 
±
;

299 
evQ
 = 
	`zz_pX_MuÉošt_G’”®
(
pošts
);

300 
ev
 = &
evQ
;

303 
û¼
 << ((
OK
 =ğ1è? "geom " : "g’”® "è<< "š†’gth " << 
ev
->
	`Ëngth
(è<< 
’dl
;

305 
tšt0
, 
tšt1
, 
Œes
, 
t
;

307 
t
 = 
	`G‘Time
();

308 
Vec
<
zz_pX
> 
v®uesF
, 
v®uesG
;

309 
	`ev®u©e
(
v®uesF
, 
f
, *
ev
);

310 
	`ev®u©e
(
v®uesG
, 
g
, *
ev
);

311 
tšt0
 = 
	`G‘Time
()-
t
;

313 
Vec
<
zz_p
> 
vsub»s0
, 
vsub»s1
;

314 
vsub»s0
.
	`S‘L’gth
(
dr
);

315 
vsub»s1
.
	`S‘L’gth
(
dr
);

317 
t
 = 
	`G‘Time
();

318 
OK_»s
 = 1;

319 
i
 = 0; i < 
dr
; i++){

320 
zz_pX
 
tmp1
, 
tmp2
;

321 
	`»suÉªt_sub»suÉªt
(
v®ues
[
i
], 
tmp1
, 
tmp2
, 
v®uesF
[i], 
v®uesG
[i]);

322 ià(
v®ues
[
i
] =ğ0 || 
	`deg
(
tmp1
) != 1)

323 
OK_»s
 = 0;

325 
vsub»s0
[
i
] = 
	`cÛff
(
tmp1
, 0);

326 
vsub»s1
[
i
] = 
	`cÛff
(
tmp1
, 1);

329 
Œes
 = 
	`G‘Time
()-
t
;

331 
t
 = 
	`G‘Time
();

332 
ev
->
	`š‹½Ş©e
(
»s
, 
v®ues
);

333 ià(
OK_»s
 == 1){

334 
ev
->
	`š‹½Ş©e
(
sub»s0
, 
vsub»s0
);

335 
ev
->
	`š‹½Ş©e
(
sub»s1
, 
vsub»s1
);

338 
sub»s0
 = 0;

339 
sub»s1
 = 0;

342 
tšt1
 = 
	`G‘Time
()-
t
;

344 
û¼
 << "ev®u©iÚ: " << 
tšt0
 << ",„esuÉªt: " << 
Œes
 << ", iÁ”pŞ©iÚ: " << 
tšt1
 << 
’dl
;

345 
	}
}

350 
	$diffY
(
zz_pXY
 & 
dyF
, cÚ¡ zz_pXY & 
F
){

351 
dy
 = 
F
.
	`degY
();

352 
Vec
<
zz_pX
> 
cÛffs_dyF
;

354 ià(
dy
 <= 0){

355 
cÛffs_dyF
.
	`S‘L’gth
(0);

358 
cÛffs_dyF
.
	`S‘L’gth
(
dy
);

359 
i
 = 0; i < 
dy
; i++)

360 
cÛffs_dyF
[
i
] = (i+1)*
F
.
cÛffX
[i+1];

362 
dyF
 = 
	`zz_pXY
(
cÛffs_dyF
);

363 
	}
}

368 
	$cÚv
(
zz_pEX
 & 
fEX
, cÚ¡ 
zz_pXY
 & 
f
){

369 
Vec
<
zz_pE
> 
cÛffs
;

370 
	`cÚv
(
cÛffs
, 
f
.
cÛffX
);

371 
	`cÚv
(
fEX
, 
cÛffs
);

372 
	}
}

377 
	$cÚv
(
zz_pXY
 & 
f
, cÚ¡ 
zz_pEX
 & 
fEX
){

378 
Vec
<
zz_pE
> 
cÛffsE
;

379 
Vec
<
zz_pX
> 
cÛffs
;

380 
	`cÚv
(
cÛffsE
, 
fEX
);

381 
	`cÚv
(
cÛffs
, 
cÛffsE
);

382 
f
 = 
	`zz_pXY
(
cÛffs
);

383 
	}
}

388 
	$cÚv
(
zz_pXY
 & 
f
, cÚ¡ 
ZZXY
 & 
fZ
){

389 
Vec
<
zz_pX
> 
cÛffs
;

390 
	`cÚv
(
cÛffs
, 
fZ
.
cÛffX
);

391 
f
 = 
	`zz_pXY
(
cÛffs
);

392 
	}
}

397 
	$»duû_Çive
(
zz_pX
 & 
»m
, cÚ¡ zz_pX& 
R
, cÚ¡ zz_pX& 
S
, cÚ¡ 
zz_pXY
 & 
P
){

398 
zz_pXModulus
 
	`R_mod
(
R
);

399 
zz_pXMuÉl›r
 
	`S_mul
(
S
, 
R_mod
);

401 
»m
 = 0;

402 
n
 = 
P
.
	`degY
();

403 
i
 = 
n
; i >= 0; i--)

404 
»m
 = 
	`MulMod
Ôem, 
S_mul
, 
R_mod
è+ 
P
.
cÛffX
[
i
];

405 
	}
}

410 
	$»duû
(
zz_pX
 & 
»m
, cÚ¡ zz_pX& 
R
, cÚ¡ zz_pX& 
S
, cÚ¡ 
zz_pXY
 & 
P
){

411 
zz_pXModulus
 
	`R_mod
(
R
);

412 
zz_pXMuÉl›r
 
	`S_mul
(
S
, 
R_mod
);

414 
d
 = 
	`deg
(
R
);

415 
m
 = 
P
.
	`degX
();

416 
n
 = 
P
.
	`degY
();

418 
n1
 = 
	`SqrRoÙ
(
n
);

419 
n2
 = 
	`û
Ğ(()(
n
+1)è/ (()
n1
) );

420 
c
 = 
	`û
Ğ(()(
d
+1)è/ (()(
m
+1)) );

422 
M©
<
zz_pX
> 
cÛff_P
, 
pow”s_S
;

424 
t0
 = 0, 
t1
 = 0, 
t
;

426 
t
 = 
	`G‘Time
();

427 
pow”s_S
.
	`S‘Dims
(
n1
, 
c
);

428 
zz_pX
 
pS
;

429 
	`£t
(
pS
);

430 
i
 = 0; i < 
n1
; i++){

431 
j
 = 0; j < 
c
; j++){

432 
pow”s_S
[
i
][
j
].
»p
.
	`S‘L’gth
(
m
+1);

433 
shiá
 = 
j
*(
m
+1);

434 
k
 = 0; k <ğ
m
; k++)

435 
pow”s_S
[
i
][
j
].
»p
[
k
] = 
	`cÛff
(
pS
, 
shiá
+k);

436 
pow”s_S
[
i
][
j
].
	`nÜm®ize
();

438 
	`MulMod
(
pS
,…S, 
S_mul
, 
R_mod
);

441 
cÛff_P
.
	`S‘Dims
(
n2
, 
n1
);

442 
i
 = 0; i < 
n2
; i++){

443 
j
 = 0; j < 
n1
; j++){

444 
idx
 = 
i
*
n1
+
j
;

445 ià(
idx
 <ğ
n
)

446 
cÛff_P
[
i
][
j
] = 
P
.
cÛffX
[
idx
];

449 
t0
 +ğ
	`G‘Time
()-
t
;

451 
t
 = 
	`G‘Time
();

452 
M©
<
zz_pX
> 
»s
;

453 
	`muÉly_waksmª
(
»s
, 
cÛff_P
, 
pow”s_S
);

454 
t1
 +ğ
	`G‘Time
()-
t
;

456 
t
 = 
	`G‘Time
();

457 
	`ş—r
(
»m
);

458 
zz_pXMuÉl›r
 
	`pS_mul
(
pS
, 
R_mod
);

459 
i
 = 
n2
-1; i >= 0; i--){

460 
zz_pX
 
tmp
;

461 
tmp
.
»p
.
	`S‘L’gth
(
d
+2*(
m
+1));

462 
j
 = 0; j < 
c
; j++){

463 
–l
 = 
»s
[
i
][
j
].
»p
.
	`Ëngth
();

464 
k
 = 0; k < 
–l
; k++)

465 
tmp
.
»p
[
j
*(
m
+1)+
k
] +ğ
»s
[
i
][j].rep[k];

467 
tmp
.
	`nÜm®ize
();

468 
tmp
 %ğ
R
;

469 
	`MulMod
(
»m
,„em, 
pS_mul
, 
R_mod
);

470 
»m
 +ğ
tmp
;

472 
t0
 +ğ
	`G‘Time
()-
t
;

473 
	}
}

	@bivariate/test/test_ZZXY_iostream.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"ZZXY.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
ZZXY
 
FpŞy
 = 
	`ZZXY
();

14 
¡ršg
 
Çme
 = "test_OL_16_003.txt.ntl";

15 
FpŞy
.
	`»ad_äom_fe
(
Çme
);

16 
cout
 << 
FpŞy
 << 
’dl
;

17 
	}
}

19 
	$maš
(
¬gc
, ** 
¬gv
){

20 
İt
 = 0;

21 ià(
¬gc
 > 1)

22 
İt
 = 
	`©oi
(
¬gv
[1]);

23 
	`check
(
İt
);

25 
	}
}

	@bivariate/test/test_ZZXY_solve.cpp

1 
	~<NTL/ZZX.h
>

2 
	~<NTL/lzz_pX.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"lzz_pX_CRT.h
"

6 
	~"magma_ouut.h
"

7 
	~"ZZXY.h
"

8 
	~"lzz_pXY.h
"

9 
	~"lzz_pEX_augm’‹d.h
"

11 
NTL_CLIENT


13 
	$check
(cÚ¡ 
¡ršg
 & 
Çme
){

16 
ZZXY
 
FZ
 = 
	`ZZXY
();

17 
FZ
.
	`»ad_äom_fe
(
Çme
);

18 
ZZXY
 
FZy
;

19 
	`diffY
(
FZy
, 
FZ
);

21 
	`magma_š™_bi_QQ
();

22 
	`magma_assign
(
FZ
, "F");

23 
	`magma_assign
(
FZy
, "Fy");

25 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
> 
sŞs
;

26 
	`sŞve
(
sŞs
, 
FZ
, 
FZy
);

28 
	`magma_assign
(
sŞs
, "sols");

30 
cout
 << "p:=NextPrime(2^100);\n";

31 
cout
 << "Mp:=PolynomialRing(GF(p),2);\n";

32 
cout
 << "f:=Evaluate(F,[Mp.1, Mp.2]);\n";

33 
cout
 << "g:=Evaluate(Fy,[Mp.1, Mp.2]);\n";

34 
cout
 << "sols_p:=[ [ Evaluate(popo,[Mp.1, Mp.2]) :…opo in ff] : ff in sols];\n";

35 
cout
 << "S:=0;\n";

36 
cout
 << "for I in sols_p do\n";

37 
cout
 << " if‚ot IsSquarefree(I[1])hen…rint \"output‚ot„adical\";ƒnd if;\n";

38 
cout
 << " for J in sols_p do\n";

39 
cout
 << " if I‚e J‡nd Degree(GCD(I[1], J[1])) ge 1hen…rint \"output‚ot coprime\";ƒnd if;\n";

40 
cout
 << "ƒnd for;\n";

41 
cout
 << " U1:=UnivariatePolynomial(I[1]);\n";

42 
cout
 << " Q:=quo<Parent(U1) | U1>;\n";

43 
cout
 << " den:=1/Q!Derivative(U1);\n";

44 
cout
 << "‚ew:=&+[ Evaluate( Parent(U1)!(den*Q!UnivariatePolynomial(Coefficient(I[2], Mp.1, i))), Mp.2 )*Mp.1^i : i in [0..Degree(I[2], Mp.1)]];\n";

45 
cout
 << " Q:=quo<Mp|[I[1],‚ew]>;\n";

46 
cout
 << " if Q!f‚e 0 or Q!g‚e 0hen…rint \"polynomials do‚ot„educeo zero\";ƒnd if;\n";

47 
cout
 << " S:=S+Dimension(Q);\n";

48 
cout
 << "end for;\n";

49 
cout
 << "Mp:=PolynomialRing(GF(p),2,\"grevlex\");\n";

50 
cout
 << "f:=Evaluate(F,[Mp.1, Mp.2]);\n";

51 
cout
 << "g:=Evaluate(Fy,[Mp.1, Mp.2]);\n";

52 
cout
 << "R:=ProbableRadicalDecomposition(Ideal([f,g]));\n";

53 
cout
 << "T:=&+[Dimension(quo<Mp|r>) :„ in R];\n";

54 
cout
 << "if S‚e Then…rint \"missing solutions\";ƒnd if;\n";

55 
	}
}

57 
	$maš
(
¬gc
, ** 
¬gv
){

59 
¡ršg
 
Çme
;

60 ià(
¬gc
 > 1)

61 
Çme
 = 
¬gv
[1];

63 
Çme
 = "../data/test_OL_16_009.txt.ntl";

65 
t
 = 
	`G‘Time
();

66 
	`check
(
Çme
);

67 
û¼
 << "-----time: " << 
	`G‘Time
()-
t
 << 
’dl
;

69 
	}
}

	@bivariate/test/test_pair_zz_pEX_augmented_combine.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


11 
zz_pX
 
	$¿ndom_mÚic_zz_pX
(
d
){

12 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
d
);

13 
	`S‘CÛff
(
f
, 
d
, 1);

14  
f
;

15 
	}
}

20 
	$check
(
İt
){

22 
p
 = 1125899906842679;

23 
zz_p
::
	`š™
(
p
);

25 
·œ_zz_pEX_augm’‹d
 
Ta
;

26 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
Ta
, 3, -1, 2);

28 
·œ_zz_pEX_augm’‹d
 
Tb
;

29 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
Tb
, 4, 0, 1);

31 
	`magma_š™
();

32 
	`magma_š™_bi
();

33 
	`magma_assign
(
Ta
, "Ta");

34 
	`magma_assign
(
Tb
, "Tb");

36 
Vec
<
·œ_zz_pEX_augm’‹d
> 
lT
;

37 
lT
.
	`S‘L’gth
(2);

38 
lT
[0] = 
Ta
;

39 
lT
[1] = 
Tb
;

41 
·œ_zz_pEX_augm’‹d
 
T
;

42 
	`combše
(
T
, 
lT
);

44 
	`magma_assign
(
T
, "T");

45 
cout
 << "print M!(quo<M|[Ta[1]]>!T[2])ƒq Ta[2];\n";

46 
cout
 << "print M!(quo<M|[Tb[1]]>!T[2])ƒq Tb[2];\n";

47 
cout
 << "print M!(quo<M|[Ta[1]]>!T[3])ƒq Ta[3];\n";

48 
cout
 << "print M!(quo<M|[Tb[1]]>!T[3])ƒq Tb[3];\n";

50 
	}
}

52 
	$maš
(
¬gc
, ** 
¬gv
){

53 
İt
 = 0;

54 ià(
¬gc
 > 1)

55 
İt
 = 
	`©oi
(
¬gv
[1]);

56 
	`check
(
İt
);

58 
	}
}

	@bivariate/test/test_pair_zz_pEX_augmented_mod.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pX
 
t1
, 
t1a
, 
t1b
;

20 
zz_pXY
 
t20
, 
t21
;

22 
d1
 = 5, 
d2
 = 3;

24 
t1a
 = 
	`¿ndom_zz_pX
(
d1
);

25 
	`S‘CÛff
(
t1a
, 
d1
, 1);

26 
t1b
 = 
	`¿ndom_zz_pX
(
d1
);

27 
	`S‘CÛff
(
t1b
, 
d1
, 1);

28 
t1
 = 
t1a
*
t1b
;

30 
	`¿ndom_zz_pXY
(
t20
, 
	`deg
(
t1
), 
d2
);

31 
	`¿ndom_zz_pXY
(
t21
, 
	`deg
(
t1
), 
d2
);

32 
·œ_zz_pEX_augm’‹d
 
	`T
(
t1
, 
t20
, 
t21
);

33 
	`magma_š™
();

34 
	`magma_š™_bi
();

35 
	`magma_assign
(
T
, "t");

37 
·œ_zz_pEX_augm’‹d
 
Tmod
;

38 
	`mod
(
Tmod
, 
T
, 
t1a
);

39 
	`magma_assign
(
Tmod
, "tmod");

40 
	`magma_assign
(
t1a
, "X", "u");

42 
cout
 << "print (Ideal([t[1],t[2]]) + Ideal([u]))ƒq Ideal([tmod[1],tmod[2]]);\n";

43 
cout
 << "print (Ideal([t[1],t[3]]) + Ideal([u]))ƒq Ideal([tmod[1],tmod[3]]);\n";

44 
	}
}

46 
	$maš
(
¬gc
, ** 
¬gv
){

47 
İt
 = 0;

48 ià(
¬gc
 > 1)

49 
İt
 = 
	`©oi
(
¬gv
[1]);

50 
	`check
(
İt
);

52 
	}
}

	@bivariate/test/test_pair_zz_pEX_augmented_multimod.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pX
 
t1
, 
t1a
, 
t1b
, 
t1c
;

20 
zz_pXY
 
t20
, 
t21
;

22 
d1
 = 5, 
d2
 = 3;

24 
t1a
 = 
	`¿ndom_zz_pX
(
d1
);

25 
	`S‘CÛff
(
t1a
, 
d1
, 1);

26 
t1b
 = 
	`¿ndom_zz_pX
(
d1
);

27 
	`S‘CÛff
(
t1b
, 
d1
, 1);

28 
t1c
 = 
	`¿ndom_zz_pX
(
d1
);

29 
	`S‘CÛff
(
t1c
, 
d1
, 1);

30 
t1
 = 
t1a
*
t1b
*
t1c
;

32 
	`¿ndom_zz_pXY
(
t20
, 
	`deg
(
t1
), 
d2
);

33 
	`¿ndom_zz_pXY
(
t21
, 
	`deg
(
t1
), 
d2
+3);

34 
·œ_zz_pEX_augm’‹d
 
	`T
(
t1
, 
t20
, 
t21
);

35 
	`magma_š™
();

36 
	`magma_š™_bi
();

37 
	`magma_assign
(
T
, "t");

39 
Vec
<
zz_pX
> 
mods
;

40 
mods
.
	`S‘L’gth
(3);

41 
mods
[0] = 
t1a
;

42 
mods
[1] = 
t1b
;

43 
mods
[2] = 
t1c
;

44 
zz_pX_CRT
 
	`üt
(
mods
);

46 
Vec
<
·œ_zz_pEX_augm’‹d
> 
Tmod
;

47 
	`muÉimod
(
Tmod
, 
T
, 
mods
);

49 
	`magma_assign
(
Tmod
[0], "tmod0");

50 
	`magma_assign
(
Tmod
[1], "tmod1");

51 
	`magma_assign
(
Tmod
[2], "tmod2");

53 
	`magma_assign
(
t1a
, "X", "u0");

54 
	`magma_assign
(
t1b
, "X", "u1");

55 
	`magma_assign
(
t1c
, "X", "u2");

57 
cout
 << "print (Ideal([t[1],t[2]]) + Ideal([u0]))ƒq Ideal([tmod0[1],tmod0[2]]);\n";

58 
cout
 << "print (Ideal([t[1],t[3]]) + Ideal([u0]))ƒq Ideal([tmod0[1],tmod0[3]]);\n";

59 
cout
 << "print (Ideal([t[1],t[2]]) + Ideal([u1]))ƒq Ideal([tmod1[1],tmod1[2]]);\n";

60 
cout
 << "print (Ideal([t[1],t[3]]) + Ideal([u1]))ƒq Ideal([tmod1[1],tmod1[3]]);\n";

61 
cout
 << "print (Ideal([t[1],t[2]]) + Ideal([u2]))ƒq Ideal([tmod2[1],tmod2[2]]);\n";

62 
cout
 << "print (Ideal([t[1],t[3]]) + Ideal([u2]))ƒq Ideal([tmod2[1],tmod2[3]]);\n";

65 
	}
}

67 
	$maš
(
¬gc
, ** 
¬gv
){

68 
İt
 = 0;

69 ià(
¬gc
 > 1)

70 
İt
 = 
	`©oi
(
¬gv
[1]);

71 
	`check
(
İt
);

73 
	}
}

	@bivariate/test/test_random_pair_zz_pEX_augmented.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


11 
zz_pX
 
	$¿ndom_mÚic_zz_pX
(
d
){

12 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
d
);

13 
	`S‘CÛff
(
f
, 
d
, 1);

14  
f
;

15 
	}
}

20 
	$check
(
İt
){

22 
p
 = 1125899906842679;

23 
zz_p
::
	`š™
(
p
);

25 
·œ_zz_pEX_augm’‹d
 
T
;

26 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
, 3, 5, 6);

28 
	`magma_š™
();

29 
	`magma_š™_bi
();

30 
	`magma_assign
(
T
, "T");

31 
cout
 << "print (T);\n";

32 
	}
}

34 
	$maš
(
¬gc
, ** 
¬gv
){

35 
İt
 = 0;

36 ià(
¬gc
 > 1)

37 
İt
 = 
	`©oi
(
¬gv
[1]);

38 
	`check
(
İt
);

40 
	}
}

	@bivariate/test/test_random_zz_pEX_augmented.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


11 
zz_pX
 
	$¿ndom_mÚic_zz_pX
(
d
){

12 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
d
);

13 
	`S‘CÛff
(
f
, 
d
, 1);

14  
f
;

15 
	}
}

20 
	$check
(
İt
){

22 
p
 = 1125899906842679;

23 
zz_p
::
	`š™
(
p
);

25 
zz_pEX_augm’‹d
 
T
;

26 
	`¿ndom_mÚic_zz_pEX_augm’‹d
(
T
, 3, 5);

28 
	`magma_š™
();

29 
	`magma_š™_bi
();

30 
	`magma_assign
(
T
, "T");

31 
	}
}

33 
	$maš
(
¬gc
, ** 
¬gv
){

34 
İt
 = 0;

35 ià(
¬gc
 > 1)

36 
İt
 = 
	`©oi
(
¬gv
[1]);

37 
	`check
(
İt
);

39 
	}
}

	@bivariate/test/test_random_zz_pXY.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pXY
 
FpŞy
;

20 
	`¿ndom_zz_pXY
(
FpŞy
, 10, 10);

21 
cout
 << 
FpŞy
 << 
’dl
;

22 
	}
}

24 
	$maš
(
¬gc
, ** 
¬gv
){

25 
İt
 = 0;

26 ià(
¬gc
 > 1)

27 
İt
 = 
	`©oi
(
¬gv
[1]);

28 
	`check
(
İt
);

30 
	}
}

	@bivariate/test/test_reduce.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

5 
	~"lzz_pXY.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

15 
p
 = 1125899906842679;

16 
zz_p
::
	`š™
(
p
);

18 
d
 = 10; d < 110; d+=10){

20 
Vec
<
zz_pX
> 
F
;

21 
F
.
	`S‘L’gth
(
d
);

22 
i
 = 0; i < 
d
; i++){

23 
F
[
i
] = 
	`¿ndom_zz_pX
(
d
);

26 
cout
 << 
d
 << 
’dl
;

28 
zz_pXY
 
	`FpŞy
(
F
);

30 
zz_pX
 
R
 = 
	`¿ndom_zz_pX
(
d
*d);

31 
	`S‘CÛff
(
R
, 
d
*d, 1);

32 
zz_pX
 
S
 = 
	`¿ndom_zz_pX
(
d
*d);

34 
t
;

36 
t
 = 
	`G‘Time
();

37 
zz_pX
 
T
;

38 
	`»duû
(
T
, 
R
, 
S
, 
F
);

39 
cout
 << 
	`G‘Time
()-
t
 << " ";

41 
t
 = 
	`G‘Time
();

42 
zz_pX
 
T_Çive
;

43 
	`»duû_Çive
(
T_Çive
, 
R
, 
S
, 
F
);

44 
cout
 << 
	`G‘Time
()-
t
 << " ";

46 
cout
 << 
’dl
;

48 ià(
T
 !ğ
T_Çive
)

49 
cout
 << "print false;\n";

67 
	}
}

69 
	$maš
(
¬gc
, ** 
¬gv
){

70 
İt
 = 0;

71 ià(
¬gc
 > 1)

72 
İt
 = 
	`©oi
(
¬gv
[1]);

73 
	`check
(
İt
);

75 
	}
}

	@bivariate/test/test_regular_gcd.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"ZZXY.h
"

7 
	~"lzz_pXY.h
"

8 
	~"lzz_pEX_augm’‹d.h
"

10 
NTL_CLIENT


12 
zz_pX
 
	$¿ndom_mÚic_zz_pX
(
d
){

13 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
d
);

14 
	`S‘CÛff
(
f
, 
d
, 1);

15  
f
;

16 
	}
}

21 
	$check
(
İt
){

23 
p
 = 1125899906842679;

24 
zz_p
::
	`š™
(
p
);

26 
Vec
<
·œ_zz_pEX_augm’‹d
> 
T
;

27 
T
.
	`S‘L’gth
(9);

29 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[0], 5, -1, -1);

30 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[1], 5, -1, 4);

31 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[2], 5, -1, 8);

33 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[3], 5, 3, 1);

34 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[4], 5, 3, 4);

35 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[5], 5, 3, 8);

37 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[6], 5, 6, 1);

38 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[7], 5, 6, 4);

39 
	`¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
T
[8], 5, 6, 8);

41 
i
 = 0; i < 9; i++){

42 
zz_pEPush
 
	`push
(
T
[
i
].
T1
);

43 
zz_pEX
 
tmp
 = 
	`¿ndom_zz_pEX
(3+
i
);

44 
T
[
i
].
T20
 *ğ
tmp
 * 
	`¿ndom_zz_pEX
(3);

45 
T
[
i
].
T21
 *ğ
tmp
 * 
	`¿ndom_zz_pEX
(3);

48 
·œ_zz_pEX_augm’‹d
 
T®l
;

49 
	`combše
(
T®l
, 
T
);

51 
Vec
<
zz_pEX_augm’‹d
> 
T¥l™
;

52 
	`»guÏr_gcd
(
T¥l™
, 
T®l
);

54 
i
 = 0; i < 
T¥l™
.
	`Ëngth
(); i++)

55 
cout
 << 
	`deg
(
T¥l™
[
i
].
T1X
è<< " " << deg(T¥l™[i].
T2
è<< 
’dl
;

56 
	}
}

58 
	$maš
(
¬gc
, ** 
¬gv
){

59 
İt
 = 0;

60 ià(
¬gc
 > 1)

61 
İt
 = 
	`©oi
(
¬gv
[1]);

62 
	`check
(
İt
);

64 
	}
}

	@bivariate/test/test_resultant.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"ZZXY.h
"

7 
	~"lzz_pXY.h
"

8 
	~"lzz_pEX_augm’‹d.h
"

10 
NTL_CLIENT


15 
	$check
(
İt
){

17 
p
 = 1125899906842679;

18 
zz_p
::
	`š™
(
p
);

20 
zz_pXY
 
F
, 
G
;

21 
	`¿ndom_zz_pXY
(
F
, 10, 10);

22 
	`¿ndom_zz_pXY
(
G
, 10, 10);

23 
	`magma_š™
();

24 
	`magma_š™_X
();

25 
	`magma_š™_Y
();

26 
	`magma_assign
(
F
, "F");

27 
	`magma_assign
(
G
, "G");

29 
zz_pX
 
»s
;

30 
	`»suÉªt
(
»s
, 
F
, 
G
);

31 
	`magma_assign
(
»s
, "res");

32 
cout
 << "print„esƒq Resultant(F,G);\n";

33 
	}
}

35 
	$maš
(
¬gc
, ** 
¬gv
){

36 
İt
 = 0;

37 ià(
¬gc
 > 1)

38 
İt
 = 
	`©oi
(
¬gv
[1]);

39 
	`check
(
İt
);

41 
	}
}

	@bivariate/test/test_split.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pX
 
f0
, 
g0
, 
f1
, 
g1
;

21 
d
 = 100;

23 
g0
 = 
	`¿ndom_zz_pX
(
d
);

24 
f0
 = 
g0
+1;

25 
g1
 = 
	`¿ndom_zz_pX
(
d
/2);

26 
f1
 = 0;

28 
Vec
<
zz_pX
> 
vecF
, 
vecG
;

29 
vecF
.
	`S‘L’gth
(2);

30 
vecF
[0] = 
f0
;

31 
vecF
[1] = 
f1
;

32 
vecG
.
	`S‘L’gth
(2);

33 
vecG
[0] = 
g0
;

34 
vecG
[1] = 
g1
;

35 
zz_pX_CRT
 
	`üt
(
vecG
);

37 
zz_pX
 
f
, 
g
;

38 
g
 = 
g0
*
g1
;

39 
üt
.
	`combše
(
f
, 
vecF
);

40 
cout
 << (
f
 - 
f0
è% 
g0
 << " ";

41 
cout
 << (
f
 - 
f1
è% 
g1
 << 
’dl
;

43 
zz_pX
 
z”o
, 
un™
, 
šv
;

44 
	`¥l™
(
z”o
, 
un™
, 
šv
, 
f
, 
g
);

46 
cout
 << 
z”o
 - 
g1
/
	`L—dCÛff
(g1) << " ";

47 
cout
 << 
un™
 - 
g0
/
	`L—dCÛff
(g0) << " ";

48 
cout
 << 
šv
*
f
 % 
un™
 << 
’dl
;

49 
	}
}

51 
	$maš
(
¬gc
, ** 
¬gv
){

52 
İt
 = 0;

53 ià(
¬gc
 > 1)

54 
İt
 = 
	`©oi
(
¬gv
[1]);

55 
	`check
(
İt
);

57 
	}
}

	@bivariate/test/test_split_for_regularize.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


11 
	$loÿl_üt
(
zz_pX
 & 
»s
, cÚ¡ zz_pX & 
a0
, cÚ¡ zz_pX& 
a1
, cÚ¡ zz_pX& 
a2
, 
zz_pX_CRT
& 
üt
){

12 
Vec
<
zz_pX
> 
»ms
;

13 
»ms
.
	`S‘L’gth
(3);

14 
»ms
[0] = 
a0
;

15 
»ms
[1] = 
a1
;

16 
»ms
[2] = 
a2
;

17 
üt
.
	`combše
(
»s
, 
»ms
);

18 
	}
}

23 
	$check
(
İt
){

25 
p
 = 1125899906842679;

26 
zz_p
::
	`š™
(
p
);

28 
zz_pX
 
f0
, 
f1
, 
f2
;

29 
d
 = 5;

31 
f0
 = 
	`¿ndom_zz_pX
(
d
);

32 
	`S‘CÛff
(
f0
, 
d
, 1);

33 
f1
 = 
	`¿ndom_zz_pX
(
d
);

34 
	`S‘CÛff
(
f1
, 
d
, 1);

35 
f2
 = 
	`¿ndom_zz_pX
(
d
);

36 
	`S‘CÛff
(
f2
, 
d
, 1);

38 
Vec
<
zz_pX
> 
mods
;

39 
mods
.
	`S‘L’gth
(3);

40 
mods
[0] = 
f0
;

41 
mods
[1] = 
f1
;

42 
mods
[2] = 
f2
;

43 
zz_pX_CRT
 
	`üt
(
mods
);

45 
Vec
<
zz_pX
> 
cÛffs
;

46 
cÛffs
.
	`S‘L’gth
(4);

47 
	`loÿl_üt
(
cÛffs
[0], 
	`to_zz_pX
(0), 
	`¿ndom_zz_pX
(
d
),„ªdom_zz_pX(d), 
üt
);

48 
	`loÿl_üt
(
cÛffs
[1], 
	`to_zz_pX
(0), 
	`¿ndom_zz_pX
(
d
),„ªdom_zz_pX(d), 
üt
);

49 
	`loÿl_üt
(
cÛffs
[2], 
	`to_zz_pX
(0),o_zz_pX(0), 
	`¿ndom_zz_pX
(
d
), 
üt
);

50 
	`loÿl_üt
(
cÛffs
[3], 
	`to_zz_pX
(0),o_zz_pX(0), 
	`¿ndom_zz_pX
(
d
), 
üt
);

52 
Vec
<
zz_pX
> 
¥l™
;

53 
	`¥l™_fÜ_»guÏrize
(
¥l™
, 
cÛffs
, 
üt
.
	`ma¡”
());

55 
cout
 << 
¥l™
.
	`Ëngth
(è<< 
’dl
;

56 
cout
 << 
¥l™
 << 
’dl
;

57 
cout
 << 
mods
 << 
’dl
;

58 
	}
}

60 
	$maš
(
¬gc
, ** 
¬gv
){

61 
İt
 = 0;

62 ià(
¬gc
 > 1)

63 
İt
 = 
	`©oi
(
¬gv
[1]);

64 
	`check
(
İt
);

66 
	}
}

	@bivariate/test/test_zz_pEX_augmented.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pX
 
t1
;

20 
zz_pXY
 
t2
;

22 
d1
 = 10, 
d2
 = 3;

24 
t1
 = 
	`¿ndom_zz_pX
(
d1
);

25 
	`S‘CÛff
(
t1
, 
d1
, 1);

27 
	`¿ndom_zz_pXY
(
t2
, 
d1
, 
d2
);

29 
zz_pEX_augm’‹d
 
	`T
(
t1
, 
t2
);

30 
	`magma_š™
();

31 
	`magma_š™_bi
();

32 
	`magma_assign
(
T
, "t");

33 
	}
}

35 
	$maš
(
¬gc
, ** 
¬gv
){

36 
İt
 = 0;

37 ià(
¬gc
 > 1)

38 
İt
 = 
	`©oi
(
¬gv
[1]);

39 
	`check
(
İt
);

41 
	}
}

	@bivariate/test/test_zz_pEX_augmented_combine.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


11 
zz_pX
 
	$¿ndom_mÚic_zz_pX
(
d
){

12 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
d
);

13 
	`S‘CÛff
(
f
, 
d
, 1);

14  
f
;

15 
	}
}

20 
	$check
(
İt
){

22 
p
 = 1125899906842679;

23 
zz_p
::
	`š™
(
p
);

25 
zz_pEX_augm’‹d
 
Ta
;

26 
	`¿ndom_mÚic_zz_pEX_augm’‹d
(
Ta
, 3, 4);

28 
zz_pEX_augm’‹d
 
Tb
;

29 
	`¿ndom_mÚic_zz_pEX_augm’‹d
(
Tb
, 4, 0);

31 
	`magma_š™
();

32 
	`magma_š™_bi
();

33 
	`magma_assign
(
Ta
, "Ta");

34 
	`magma_assign
(
Tb
, "Tb");

36 
Vec
<
zz_pEX_augm’‹d
> 
lT
;

37 
lT
.
	`S‘L’gth
(2);

38 
lT
[0] = 
Ta
;

39 
lT
[1] = 
Tb
;

41 
zz_pEX_augm’‹d
 
T
;

42 
	`combše
(
T
, 
lT
);

44 
	`magma_assign
(
T
, "T");

45 
cout
 << "print M!(quo<M|[Ta[1]]>!T[2])ƒq Ta[2];\n";

46 
cout
 << "print M!(quo<M|[Tb[1]]>!T[2])ƒq Tb[2];\n";

48 
	}
}

50 
	$maš
(
¬gc
, ** 
¬gv
){

51 
İt
 = 0;

52 ià(
¬gc
 > 1)

53 
İt
 = 
	`©oi
(
¬gv
[1]);

54 
	`check
(
İt
);

56 
	}
}

	@bivariate/test/test_zz_pEX_augmented_make_monic.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


11 
	$loÿl_üt
(
zz_pX
 & 
»s
, cÚ¡ zz_pX & 
a0
, cÚ¡ zz_pX& 
a1
, cÚ¡ zz_pX& 
a2
, 
zz_pX_CRT
& 
üt
){

12 
Vec
<
zz_pX
> 
»ms
;

13 
»ms
.
	`S‘L’gth
(3);

14 
»ms
[0] = 
a0
;

15 
»ms
[1] = 
a1
;

16 
»ms
[2] = 
a2
;

17 
üt
.
	`combše
(
»s
, 
»ms
);

18 
	}
}

23 
	$check
(
İt
){

25 
p
 = 1125899906842679;

26 
zz_p
::
	`š™
(
p
);

28 
zz_pX
 
f0
, 
f1
, 
f2
;

29 
d
 = 5;

31 
f0
 = 
	`¿ndom_zz_pX
(
d
);

32 
	`S‘CÛff
(
f0
, 
d
, 1);

33 
f1
 = 
	`¿ndom_zz_pX
(
d
);

34 
	`S‘CÛff
(
f1
, 
d
, 1);

35 
f2
 = 
	`¿ndom_zz_pX
(
d
);

36 
	`S‘CÛff
(
f2
, 
d
, 1);

38 
Vec
<
zz_pX
> 
mods
;

39 
mods
.
	`S‘L’gth
(3);

40 
mods
[0] = 
f0
;

41 
mods
[1] = 
f1
;

42 
mods
[2] = 
f2
;

43 
zz_pX_CRT
 
	`üt
(
mods
);

45 
Vec
<
zz_pX
> 
cÛffs
;

46 
cÛffs
.
	`S‘L’gth
(4);

47 
	`loÿl_üt
(
cÛffs
[0], 
	`to_zz_pX
(0), 
	`¿ndom_zz_pX
(
d
),„ªdom_zz_pX(d), 
üt
);

48 
	`loÿl_üt
(
cÛffs
[1], 
	`to_zz_pX
(0), 
	`¿ndom_zz_pX
(
d
),„ªdom_zz_pX(d), 
üt
);

49 
	`loÿl_üt
(
cÛffs
[2], 
	`to_zz_pX
(0),o_zz_pX(0), 
	`¿ndom_zz_pX
(
d
), 
üt
);

50 
	`loÿl_üt
(
cÛffs
[3], 
	`to_zz_pX
(0),o_zz_pX(0), 
	`¿ndom_zz_pX
(
d
), 
üt
);

52 
zz_pEX_augm’‹d
 
	`T
(
üt
.
	`ma¡”
(), 
cÛffs
);

53 
Vec
<
zz_pEX_augm’‹d
> 
T¥l™
;

54 
	`make_mÚic_ªd_¥l™
(
T¥l™
, 
T
);

56 
	`magma_š™
();

57 
	`magma_š™_bi
();

58 
	`magma_assign
(
T
, "T");

59 
	`magma_assign
(
T¥l™
[0], "T0");

60 
	`magma_assign
(
T¥l™
[1], "T1");

61 
	`magma_assign
(
T¥l™
[2], "T2");

63 
cout
 << "print Ideal(T)ƒq Ideal(T0) * Ideal(T1) * Ideal(T2);\n";

64 
	}
}

66 
	$maš
(
¬gc
, ** 
¬gv
){

67 
İt
 = 0;

68 ià(
¬gc
 > 1)

69 
İt
 = 
	`©oi
(
¬gv
[1]);

70 
	`check
(
İt
);

72 
	}
}

	@bivariate/test/test_zz_pEX_augmented_mod.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pX
 
t1
, 
t1a
, 
t1b
;

20 
zz_pXY
 
t2
;

22 
d1
 = 5, 
d2
 = 3;

24 
t1a
 = 
	`¿ndom_zz_pX
(
d1
);

25 
	`S‘CÛff
(
t1a
, 
d1
, 1);

26 
t1b
 = 
	`¿ndom_zz_pX
(
d1
);

27 
	`S‘CÛff
(
t1b
, 
d1
, 1);

28 
t1
 = 
t1a
*
t1b
;

30 
	`¿ndom_zz_pXY
(
t2
, 
	`deg
(
t1
), 
d2
);

31 
zz_pEX_augm’‹d
 
	`T
(
t1
, 
t2
);

32 
	`magma_š™
();

33 
	`magma_š™_bi
();

34 
	`magma_assign
(
T
, "t");

36 
zz_pEX_augm’‹d
 
Tmod
;

37 
	`mod
(
Tmod
, 
T
, 
t1a
);

38 
	`magma_assign
(
Tmod
, "tmod");

40 
	`magma_assign
(
t1a
, "X", "u");

42 
cout
 << "print (Ideal(t) + Ideal([u]))ƒq Ideal(tmod);\n";

43 
	}
}

45 
	$maš
(
¬gc
, ** 
¬gv
){

46 
İt
 = 0;

47 ià(
¬gc
 > 1)

48 
İt
 = 
	`©oi
(
¬gv
[1]);

49 
	`check
(
İt
);

51 
	}
}

	@bivariate/test/test_zz_pEX_augmented_multimod.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pX
 
t1
, 
t1a
, 
t1b
, 
t1c
;

20 
zz_pXY
 
t2
;

22 
d1
 = 5, 
d2
 = 3;

24 
t1a
 = 
	`¿ndom_zz_pX
(
d1
);

25 
	`S‘CÛff
(
t1a
, 
d1
, 1);

26 
t1b
 = 
	`¿ndom_zz_pX
(
d1
);

27 
	`S‘CÛff
(
t1b
, 
d1
, 1);

28 
t1c
 = 
	`¿ndom_zz_pX
(
d1
);

29 
	`S‘CÛff
(
t1c
, 
d1
, 1);

30 
t1
 = 
t1a
*
t1b
*
t1c
;

32 
	`¿ndom_zz_pXY
(
t2
, 
	`deg
(
t1
), 
d2
);

33 
zz_pEX_augm’‹d
 
	`T
(
t1
, 
t2
);

34 
	`magma_š™
();

35 
	`magma_š™_bi
();

36 
	`magma_assign
(
T
, "t");

38 
Vec
<
zz_pX
> 
mods
;

39 
mods
.
	`S‘L’gth
(3);

40 
mods
[0] = 
t1a
;

41 
mods
[1] = 
t1b
;

42 
mods
[2] = 
t1c
;

43 
zz_pX_CRT
 
	`üt
(
mods
);

45 
Vec
<
zz_pEX_augm’‹d
> 
Tmod
;

46 
	`muÉimod
(
Tmod
, 
T
, 
mods
);

48 
	`magma_assign
(
Tmod
[0], "tmod0");

49 
	`magma_assign
(
Tmod
[1], "tmod1");

50 
	`magma_assign
(
Tmod
[2], "tmod2");

52 
	`magma_assign
(
t1a
, "X", "u0");

53 
	`magma_assign
(
t1b
, "X", "u1");

54 
	`magma_assign
(
t1c
, "X", "u2");

56 
cout
 << "print (Ideal(t) + Ideal([u0]))ƒq Ideal(tmod0);\n";

57 
cout
 << "print (Ideal(t) + Ideal([u1]))ƒq Ideal(tmod1);\n";

58 
cout
 << "print (Ideal(t) + Ideal([u2]))ƒq Ideal(tmod2);\n";

60 
	}
}

62 
	$maš
(
¬gc
, ** 
¬gv
){

63 
İt
 = 0;

64 ià(
¬gc
 > 1)

65 
İt
 = 
	`©oi
(
¬gv
[1]);

66 
	`check
(
İt
);

68 
	}
}

	@bivariate/test/test_zz_pXY.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pXY.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
d
 = 0; d < 10; d++){

18 
Vec
<
zz_pX
> 
F
;

19 
F
.
	`S‘L’gth
(
d
);

20 
i
 = 0; i < 
d
; i++){

21 
F
[
i
] = 
	`¿ndom_zz_pX
(
d
);

24 
zz_pXY
 
	`FpŞy
(
F
);

25 
cout
 << 
FpŞy
.
	`tdeg
(è<< 
’dl
;

28 
	}
}

30 
	$maš
(
¬gc
, ** 
¬gv
){

31 
İt
 = 0;

32 ià(
¬gc
 > 1)

33 
İt
 = 
	`©oi
(
¬gv
[1]);

34 
	`check
(
İt
);

36 
	}
}

	@bivariate/test/test_zz_pXY_diffY.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
d
 = 0; d < 10; d++){

20 
Vec
<
zz_pX
> 
F
;

21 
F
.
	`S‘L’gth
(
d
);

22 
i
 = 0; i < 
d
; i++){

23 
F
[
i
] = 
	`¿ndom_zz_pX
(
d
);

26 
zz_pXY
 
	`FpŞy
(
F
);

27 
zz_pXY
 
dFpŞy
;

28 
	`diffY
(
dFpŞy
, 
FpŞy
);

30 
	`magma_š™
();

31 
	`magma_š™_bi
();

32 
	`magma_assign_bi
(
F
, "F");

33 
	`magma_assign_bi
(
dFpŞy
, "Fy");

34 
cout
 << "print Fyƒq Derivative(F, Y);\n";

37 
	}
}

39 
	$maš
(
¬gc
, ** 
¬gv
){

40 
İt
 = 0;

41 ià(
¬gc
 > 1)

42 
İt
 = 
	`©oi
(
¬gv
[1]);

43 
	`check
(
İt
);

45 
	}
}

	@bivariate/test/test_zz_pXY_magma_output.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

5 
	~"magma_ouut.h
"

6 
	~"lzz_pXY.h
"

7 
	~"lzz_pEX_augm’‹d.h
"

9 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
zz_pXY
 
FpŞy
;

21 
d
 = 3;

23 
	`¿ndom_zz_pXY
(
FpŞy
, 
d
, d);

24 
	`magma_š™
();

25 
	`magma_š™_X
();

26 
	`magma_š™_Y
();

27 
	`magma_assign
(
FpŞy
, "F");

28 
	`magma_š™_bi
();

29 
	`magma_assign_bi
(
FpŞy
, "FF");

30 
cout
 << "print Evaluate(FF,[y,x])-F;\n";

31 
	}
}

33 
	$maš
(
¬gc
, ** 
¬gv
){

34 
İt
 = 0;

35 ià(
¬gc
 > 1)

36 
İt
 = 
	`©oi
(
¬gv
[1]);

37 
	`check
(
İt
);

39 
	}
}

	@bivariate/test/test_zz_pXY_solve.cpp

1 
	~<NTL/ZZX.h
>

2 
	~<NTL/lzz_pX.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"lzz_pX_CRT.h
"

6 
	~"magma_ouut.h
"

7 
	~"ZZXY.h
"

8 
	~"lzz_pXY.h
"

9 
	~"lzz_pEX_augm’‹d.h
"

11 
NTL_CLIENT


13 
	$check
(cÚ¡ 
¡ršg
 & 
Çme
){

15 
p
 = 1125899906842679;

16 
zz_p
::
	`š™
(
p
);

18 
ZZXY
 
FZ
 = 
	`ZZXY
();

19 
FZ
.
	`»ad_äom_fe
(
Çme
);

21 
zz_pXY
 
F
, 
Fy
;

22 
	`cÚv
(
F
, 
FZ
);

23 
	`diffY
(
Fy
, 
F
);

25 
	`magma_š™
();

26 
	`magma_š™_bi
();

27 
	`magma_assign_bi
(
F
, "F");

28 
	`magma_assign_bi
(
Fy
, "Fy");

30 
cout
 << "I:=Ideal([F,Fy]);\n";

32 
Vec
<
zz_pEX_augm’‹d
> 
sŞs
;

33 
	`sŞve
(
sŞs
, 
F
, 
Fy
);

35 
cout
 << "sol:=[];\n";

36 
i
 = 0; i < 
sŞs
.
	`Ëngth
(); i++)

37 
	`magma_assign
(
sŞs
[
i
], "sŞ[" + 
	`to_¡ršg
(i) + "+1]");

39 ià(
sŞs
.
	`Ëngth
() != 0)

40 
cout
 << "print {GroebnerBasis(y) :y in &cat [ProbableRadicalDecomposition(Ideal(x)): x in sol]}ƒq {GroebnerBasis(y) :y in ProbableRadicalDecomposition(Ideal(I))};\n";

42 
cout
 << "print Dimension(I)‚e 0;\n";

44 
	}
}

46 
	$maš
(
¬gc
, ** 
¬gv
){

48 
¡ršg
 
Çme
;

49 ià(
¬gc
 > 1)

50 
Çme
 = 
¬gv
[1];

52 
Çme
 = "../data/test_OL_16_009.txt.ntl";

54 
	`check
(
Çme
);

56 
	}
}

	@bivariatemodularcomp/bivariatemodularcomp.h

1 #iâdeà
__BIVARIATEMODULARCOMP_H__


2 
	#__BIVARIATEMODULARCOMP_H__


	)

3 
	~<NTL/ZZX.h
>

4 
	~<NTL/ZZ_pX.h
>

5 
	~<NTL/ZZ_p.h
>

6 
	~<NTL/veùÜ.h
>

7 
	~<NTL/m©rix.h
>

9 şas 
	cBiv¬Ÿ‹ModuÏrComp
 {

10 
	mNTL
::
ZZ_pX
 
f_f›ld
;

11 
	mNTL
::
ZZ_pX
 
F_f›ld
;

12 
	mNTL
::
Vec
<> 
ty³
;

13 
	mNTL
::
M©
<
NTL
::
ZZ_pX
> 
B
;

14 
	m´ec
;

15 
	msq¹P
;

16 
boŞ
 
	mš™Ÿlized
 = 
çl£
;

23 
	mNTL
::
Vec
<
NTL
::
ZZ_pX
> 
ü—‹_lhs_li¡
 (cÚ¡ NTL::Vec<NTL::
ZZ_p
>&);

26 
ü—‹_lhs_m©rix
 (
NTL
::
M©
<NTL::
ZZ_pX
>&,cÚ¡ NTL::
Vec
<NTL::ZZ_pX>&);

29 
ü—‹_rhs_m©rix
 (
NTL
::
M©
<NTL::
ZZ_pX
>&,cÚ¡ NTL::
Vec
<NTL::ZZ_pX>&);

31 
de¦iû
 (
NTL
::
M©
<NTL::
ZZ_pX
>&,const NTL::Mat<NTL::ZZ_pX> &);

33 
	mpublic
:

35 
Biv¬Ÿ‹ModuÏrComp
(cÚ¡ 
NTL
::
ZZ_pX
& 
f
, cÚ¡ NTL::
Vec
<> &
ty³
, 
´ec
);

38 
Biv¬Ÿ‹ModuÏrComp
(cÚ¡ 
NTL
::
Vec
<NTL::
ZZ_pX
> &
fs
, cÚ¡ NTL::Vec<> &
ty³
, 
´ec
);

41 
Biv¬Ÿ‹ModuÏrComp
();

44 
š™
(cÚ¡ 
NTL
::
ZZ_pX
& 
f
, cÚ¡ NTL::
Vec
<> &
ty³
, 
´ec
);

48 
š™
 (cÚ¡ 
NTL
::
Vec
<NTL::
ZZ_pX
>& 
fs
, cÚ¡ NTL::Vec<> &
ty³
, 
´ec
);

52 
	mNTL
::
Vec
<
NTL
::
ZZ_p
> 
muÉ_HÜÃrs
(cÚ¡ NTL::Vec<NTL::ZZ_p> &
rhs
);

55 
	mNTL
::
Vec
<
NTL
::
ZZ_p
> 
muÉ
 (cÚ¡ NTL::Vec<NTL::ZZ_p> &
rhs
);

	@bivariatemodularcomp/mat_ZZX.h

1 #iâdeà
__MAT_ZZX_H__


2 
	#__MAT_ZZX_H__


	)

4 
	~<NTL/m©rix.h
>

5 
	~<NTL/ZZX.h
>

7 
add
(
NTL
::
M©
<NTL::
ZZX
>&, const NTL::Mat<NTL::ZZX>&, const NTL::Mat<NTL::ZZX>&);

8 
mul
(
NTL
::
M©
<NTL::
ZZX
>&, const NTL::Mat<NTL::ZZX>&, const NTL::Mat<NTL::ZZX>&);

	@bivariatemodularcomp/mat_ZZ_pX.h

1 #iâdeà
__MAT_ZZpx_H__


2 
	#__MAT_ZZpX_H__


	)

4 
	~<NTL/m©rix.h
>

5 
	~<NTL/ZZ_pX.h
>

7 
add
(
NTL
::
M©
<NTL::
ZZ_pX
>&, const NTL::Mat<NTL::ZZ_pX>&, const NTL::Mat<NTL::ZZ_pX>&);

8 
mul
(
NTL
::
M©
<NTL::
ZZ_pX
>&, const NTL::Mat<NTL::ZZ_pX>&, const NTL::Mat<NTL::ZZ_pX>&);

	@bivariatemodularcomp/src/bivariatemodularcomp.cpp

1 
	~"biv¬Ÿ‹moduÏrcomp.h
"

2 
	~<cm©h
>

3 
	~"m©_ZZX.h
"

4 
	~"m©_ZZ_pX.h
"

5 
	~<NTL/toŞs.h
>

6 
	~<time.h
>

7 
usšg
 
Çme¥aû
 
	g¡d
;

8 
usšg
 
Çme¥aû
 
	gNTL
;

10 
	gBiv¬Ÿ‹ModuÏrComp
::
š™
 (cÚ¡ 
ZZ_pX
 &
f
, cÚ¡ 
Vec
<> &
ty³_Ãw
, 
´ec_Ãw
){

11 
	gty³
 = 
ty³_Ãw
;

12 
	gf_f›ld
 = 
f
;

13 
	g´ec
 = 
´ec_Ãw
;

14 
	gsq¹P
 = 
û
(
sq¹
(
ty³
.
Ëngth
()));

15 
ZZ_pX
 
	gruÂšg
 = ZZ_pX{1};

16 
	gVec
<
	gZZ_pX
> 
	gfs
;

17 
	gi
 = 0; i < 
	gsq¹P
; i++){

18 
	gfs
.
­³nd
(
ruÂšg
);

19 
	gruÂšg
 *ğ
f
;

20 
Œunc
(
ruÂšg
,
´ec
);

22 
	gF_f›ld
 = 
ruÂšg
;

23 
ü—‹_rhs_m©rix
(
B
,
fs
);

24 
	gš™Ÿlized
 = 
Œue
;

27 
	gBiv¬Ÿ‹ModuÏrComp
::
š™
(cÚ¡ 
Vec
<
ZZ_pX
>& 
fs
, cÚ¡ Vec<> &
ty³
, 
´ec
){

28 
	gsq¹P
 = 
û
(
sq¹
(
ty³
.
Ëngth
()));

29 ià(
	gfs
.
Ëngth
(è<ğ
sq¹P
è
throw
 "notƒnough…owers of f";

30 
	gthis
->
	gty³
 = 
ty³
;

31 
	gthis
->
	g´ec
 = 
´ec
;

32 
	gf_f›ld
 = 
fs
[1];

33 
	gVec
<
	gZZ_pX
> 
	gsub_fs
;

34 
	gsub_fs
.
S‘L’gth
(
sq¹P
);

35 
	gi
 = 0; i < 
	gsq¹P
; i++)

36 
	gsub_fs
[
i
] = 
fs
[i];

37 
	gF_f›ld
 = 
fs
[
sq¹P
];

38 
ü—‹_rhs_m©rix
(
B
,
fs
);

39 
	gš™Ÿlized
 = 
Œue
;

42 
	gBiv¬Ÿ‹ModuÏrComp
::
	$Biv¬Ÿ‹ModuÏrComp
(){
	}
}

44 
Biv¬Ÿ‹ModuÏrComp
::Biv¬Ÿ‹ModuÏrComp(cÚ¡ 
ZZ_pX
& 
f
, cÚ¡ 
Vec
<> &
ty³
, 
´ec
) {

45 
š™
(
f
,
ty³
,
´ec
);

48 
	gBiv¬Ÿ‹ModuÏrComp
::
Biv¬Ÿ‹ModuÏrComp
(cÚ¡ 
Vec
<
ZZ_pX
>& 
fs
, cÚ¡ Vec<> &
ty³
, 
´ec
){

49 
š™
(
fs
,
ty³
,
´ec
);

52 
	gVec
<
	gZZ_pX
> 
	gBiv¬Ÿ‹ModuÏrComp
::
ü—‹_lhs_li¡
 (cÚ¡ 
Vec
<
ZZ_p
> &
v
){

53 
Vec
<
ZZ_pX
> 
»suÉ
;

54 
	gacc
 = 0;

55 
	gi
 = 0; i < 
	gty³
.
Ëngth
(); i++){

56 
ZZ_pX
 
	gp
;

57 
	gj
 = 0; j < 
	gty³
[
i
]+1; j++)

58 
S‘CÛff
(
p
,
j
,
v
[
acc
+j]);

59 
	gacc
 +ğ
ty³
[
i
]+1;

60 
	g»suÉ
.
­³nd
(
p
);

62  
	g»suÉ
;

65 
	gBiv¬Ÿ‹ModuÏrComp
::
ü—‹_lhs_m©rix
(
M©
<
ZZ_pX
> &
A
,cÚ¡ 
Vec
<ZZ_pX> &
v
){

66 
	gA
.
S‘Dims
(
û
((
ty³
.
Ëngth
()*1.0)/
sq¹P
),sqrtP);

67 
	gi
 = 0; i < 
	gA
.
NumRows
(); i++){

68 
	gj
 = 0; j < 
	gA
.
NumCŞs
(); j++){

69 if(
	gA
.
NumCŞs
(è* 
	gi
 + 
	gj
 < 
	gv
.
Ëngth
()){

70 
	gA
.
put
(
i
,
j
,
v
[
A
.
NumCŞs
() * i + j]);

76 
	gBiv¬Ÿ‹ModuÏrComp
::
ü—‹_rhs_m©rix
(
M©
<
ZZ_pX
> &
B
,cÚ¡ 
Vec
<ZZ_pX> &
v
){

77 
	gB
.
S‘Dims
(
v
.
Ëngth
(),
ty³
.length());

78 
	gi
 = 0; i < 
	gB
.
NumRows
(); i++){

79 
	gacc
 = 0;

80 
	gj
 = 0; j < 
	gB
.
NumCŞs
(); j++){

81 
ZZ_pX
 
	gp
;

82 
	gs
 = 0; s < 
	gty³
[
j
]+1; s++){

83 
S‘CÛff
(
p
,
s
,
cÛff
(
v
[
i
],
acc
+s));

85 
	gacc
 +ğ
ty³
[
j
]+1;

86 
	gB
.
put
(
i
,
j
,
p
);

91 
	gBiv¬Ÿ‹ModuÏrComp
::
de¦iû
(
M©
<
ZZ_pX
> &
D
,cÚ¡ M©<ZZ_pX> &
C
){

92 
	gD
.
S‘Dims
(
C
.
NumRows
(),1);

93 
	gi
 = 0; i < 
	gC
.
NumRows
(); i++){

94 
ZZ_pX
 
	gv
;

95 
	gv
.
S‘L’gth
(
´ec
);

96 
	gacc
 = 0;

97 
	gj
 = 0; j < 
	gC
.
NumCŞs
(); j++){

98 autØ&
	gp
 = 
C
[
i
][
j
];

99 
	gs
 = 0; s < 
deg
(
p
)+1; s++)

100 if(
	gacc
+
	gs
 < 
	g´ec
)

101 
	gv
[
acc
 + 
s
] +ğ
cÛff
(
p
,s);

103 
	gacc
 +ğ
ty³
[
j
]+1;

105 
	gD
.
put
(
i
,0,
v
);

109 
	gVec
<
	gZZ_p
> 
	gBiv¬Ÿ‹ModuÏrComp
::
muÉ_HÜÃrs
(cÚ¡ 
Vec
<
ZZ_p
> &
rhs
){

110 ià(!
š™Ÿlized
è
throw
 "must init first";

111 autØ
	glhs
 = 
ü—‹_lhs_li¡
(
rhs
);

112 
	gVec
<
	gZZ_p
> 
	gv
;

113 
ZZ_pX
 
	g»suÉ
{
	glhs
[
lhs
.
Ëngth
()-1]};

114 
	gi
 = 
lhs
.
Ëngth
()-2; i >= 0; i--){

115 
	g»suÉ
 = 
Œunc
((
»suÉ
 * 
f_f›ld
),
´ec
è+ 
	glhs
[
i
];

117 
	gi
 = 0; i < 
	g´ec
; i++)

118 
	gv
.
­³nd
(
cÛff
(
»suÉ
,
i
));

119  
	gv
;

122 
	gVec
<
	gZZ_p
> 
	gBiv¬Ÿ‹ModuÏrComp
::
muÉ
(cÚ¡ 
Vec
<
ZZ_p
> &
rhs
){

123 ià(!
š™Ÿlized
è
throw
 "must init first";

124 
	gM©
<
	gZZ_pX
> 
	gA
;

125 
ü—‹_lhs_m©rix
(
A
,
ü—‹_lhs_li¡
(
rhs
));

126 
mul
(
A
,A,
B
);

127 
ZZ_pX
 
	gp
;

128 
	gM©
<
	gZZ_pX
> 
	gB
;

129 
de¦iû
(
B
,
A
);

130 
	gp
 +ğ
B
[B.
NumRows
()-1][0];

131 
	gi
 = 
B
.
NumRows
()-2; i >= 0; i--){

132 
	gp
 = 
Œunc
(
p
*
F_f›ld
,
´ec
è+ 
	gB
[
i
][0];

134 
	gVec
<
	gZZ_p
> 
	gv
;

135 
	gi
 = 0; i < 
	g´ec
; i++)

136 
	gv
.
­³nd
(
cÛff
(
p
,
i
));

137  
	gv
;

	@bivariatemodularcomp/src/mat_ZZX.cpp

1 
	~<NTL/m©rix.h
>

2 
	~<NTL/ZZX.h
>

4 
usšg
 
Çme¥aû
 
	g¡d
;

5 
usšg
 
Çme¥aû
 
	gNTL
;

7 
add
(
M©
<
ZZX
>& 
X
, cÚ¡ M©<ZZX>& 
A
, cÚ¡ M©<ZZX>& 
B
){

8 
	gn
 = 
A
.
NumRows
();

9 
	gm
 = 
A
.
NumCŞs
();

11 ià(
	gB
.
NumRows
(è!ğ
n
 || 
B
.
NumCŞs
(è!ğ
m
)

12 
throw
 "matrix‡dd: dimension mismatch";

14 
	gX
.
S‘Dims
(
n
,
m
);

16 
	gi
,
	gj
;

17 
	gi
 = 1; i <ğ
n
; i++)

18 
	gj
 = 1; j <ğ
m
; j++)

19 
add
(
X
(
i
,
j
),
A
(i,j),
B
(i,j));

22 
mul_aux
(
M©
<
ZZX
>& 
X
, cÚ¡ M©<ZZX>& 
A
, cÚ¡ M©<ZZX>& 
B
){

23 
	gn
 = 
A
.
NumRows
();

24 
	gl
 = 
A
.
NumCŞs
();

25 
	gm
 = 
B
.
NumCŞs
();

27 ià(
	gl
 !ğ
B
.
NumRows
())

28 
throw
 "matrix mul: dimension mismatch";

30 
	gX
.
S‘Dims
(
n
,
m
);

32 
	gi
, 
	gj
, 
	gk
;

33 
ZZX
 
	gacc
,
	gtmp
;

35 
	gi
 = 1; i <ğ
n
; i++){

36 
	gj
 = 1; j <ğ
m
; j++){

37 
ş—r
(
acc
);

38 
	gk
 = 1; k <ğ
l
; k++){

39 
mul
(
tmp
,
A
(
i
,
k
),
B
(k,
j
));

40 
add
(
acc
,acc,
tmp
);

42 
X
(
i
,
j
èğ
acc
;

47 
mul
(
M©
<
ZZX
>& 
X
, cÚ¡ M©<ZZX>& 
A
, cÚ¡ M©<ZZX>& 
B
){

48 ià(&
	gX
 =ğ&
A
 || &
X
 =ğ&
B
){

49 
M©
<
ZZX
> 
tmp
;

50 
mul_aux
(
tmp
,
A
,
B
);

51 
	gX
 = 
tmp
;

53 
mul_aux
(
X
,
A
,
B
);

	@bivariatemodularcomp/src/mat_ZZ_pX.cpp

1 
	~<NTL/m©rix.h
>

2 
	~<NTL/ZZ_pX.h
>

4 
usšg
 
Çme¥aû
 
	g¡d
;

5 
usšg
 
Çme¥aû
 
	gNTL
;

7 
add
(
M©
<
ZZ_pX
>& 
X
, cÚ¡ M©<ZZ_pX>& 
A
, cÚ¡ M©<ZZ_pX>& 
B
){

8 
	gn
 = 
A
.
NumRows
();

9 
	gm
 = 
A
.
NumCŞs
();

11 ià(
	gB
.
NumRows
(è!ğ
n
 || 
B
.
NumCŞs
(è!ğ
m
)

12 
throw
 "matrix‡dd: dimension mismatch";

14 
	gX
.
S‘Dims
(
n
,
m
);

16 
	gi
,
	gj
;

17 
	gi
 = 1; i <ğ
n
; i++)

18 
	gj
 = 1; j <ğ
m
; j++)

19 
add
(
X
(
i
,
j
),
A
(i,j),
B
(i,j));

22 
mul_aux
(
M©
<
ZZ_pX
>& 
X
, cÚ¡ M©<ZZ_pX>& 
A
, cÚ¡ M©<ZZ_pX>& 
B
){

23 
	gn
 = 
A
.
NumRows
();

24 
	gl
 = 
A
.
NumCŞs
();

25 
	gm
 = 
B
.
NumCŞs
();

27 ià(
	gl
 !ğ
B
.
NumRows
())

28 
throw
 "matrix mul: dimension mismatch";

30 
	gX
.
S‘Dims
(
n
,
m
);

32 
	gi
, 
	gj
, 
	gk
;

33 
ZZ_pX
 
	gacc
,
	gtmp
;

35 
	gi
 = 1; i <ğ
n
; i++){

36 
	gj
 = 1; j <ğ
m
; j++){

37 
ş—r
(
acc
);

38 
	gk
 = 1; k <ğ
l
; k++){

39 
mul
(
tmp
,
A
(
i
,
k
),
B
(k,
j
));

40 
add
(
acc
,acc,
tmp
);

42 
X
(
i
,
j
èğ
acc
;

47 
mul
(
M©
<
ZZ_pX
>& 
X
, cÚ¡ M©<ZZ_pX>& 
A
, cÚ¡ M©<ZZ_pX>& 
B
){

48 ià(&
	gX
 =ğ&
A
 || &
X
 =ğ&
B
){

49 
M©
<
ZZ_pX
> 
tmp
;

50 
mul_aux
(
tmp
,
A
,
B
);

51 
	gX
 = 
tmp
;

53 
mul_aux
(
X
,
A
,
B
);

	@bivariatemodularcomp/test/test_hankeltest.cpp

1 
	~"mo§ic_hªk–.h
"

2 
	~<s¡»am
>

3 
	~"h”m™e_·de.h
"

4 
	~<NTL/ZZX.h
>

5 
usšg
 
Çme¥aû
 
	gNTL
;

6 
usšg
 
Çme¥aû
 
	g¡d
;

8 
	$maš
(){

9 
zz_p
::
	`š™
(13);

10 
Vec
<
zz_p
> 
v
;

11 
cout
 << "EÁ”hfunùiÚ" << 
’dl
;

12 
¡ršg
 
s
;

13 
	`g‘lše
(
cš
,
s
);

14 
i¡ršg¡»am
 
iss
{
s
};

15 
šp
;

16 
iss
 >> 
šp
)

17 
v
.
	`­³nd
(
	`zz_p
(
šp
));

18 
´ec
 = 
v
.
	`Ëngth
();

19 
Vec
<> 
ty³
;

20 
cout
 << "EÁ”hty³" << 
’dl
;

21 
	`g‘lše
(
cš
,
s
);

22 
iss
 = 
	`i¡ršg¡»am
(
s
);

23 
iss
 >> 
šp
)

24 
ty³
.
	`­³nd
(
šp
);

25 
Vec
<
hªk–
> 
vec_h
;

26 
zz_pX
 
f
{1};

27 
zz_pX
 
f_Üigš®
;

28 
	`cÚv
(
f_Üigš®
, 
v
);

29 
i
 = 0; i < 
ty³
.
	`Ëngth
(); i++){

30 
Vec
<
zz_p
> 
v
;

31 
	`cÚv
(
v
,
f
);

32 
Vec
<
zz_p
> 
šp_vec
;

33 
v
.
	`S‘L’gth
(
´ec
,
zz_p
{0});

34 
j
 = 0; j < 
v
.
	`Ëngth
(); j++)

35 
šp_vec
.
	`­³nd
(
v
[v.
	`Ëngth
(è- 1 - 
j
]);

36 
j
 = 0; j < 
ty³
[
i
]; j++)

37 
šp_vec
.
	`­³nd
(
zz_p
{0});

38 
vec_h
.
	`­³nd
(
	`hªk–
(
šp_vec
,
´ec
,
ty³
[
i
]+1));

39 
f
 = f * 
f_Üigš®
;

41 
M©
<
zz_p
> 
M
;

42 
i
 = 0; i < 
ty³
.
	`Ëngth
(); i++){

43 
	`to_d’£
(
M
,
vec_h
[
i
]);

44 
cout
 << 
M
 << 
’dl
;

46 
Vec
<Vec<
hªk–
>> 
š™
;

47 
š™
.
	`­³nd
(
vec_h
);

48 
mo§ic_hªk–
 
	`mh
 (
š™
);

49 
	`to_d’£
(
M
,
mh
);

50 
cout
 << 
M
 << 
’dl
;

51 
ZZX
 
å
;

52 
	`cÚv
(
å
, 
f_Üigš®
);

53 
cout
 << "From H”m™e-Pade" << 
’dl
;

54 
	`h”m™e_·de
(
å
,
ty³
);

55 
	}
}

	@bivariatemodularcomp/test/test_test.cpp

1 
	~"biv¬Ÿ‹moduÏrcomp.h
"

2 
	~"m©_ZZX.h
"

3 
	~<s¡»am
>

4 
	~<f¡»am
>

5 
	~<veùÜ
>

6 
	~<time.h
>

7 
	~<iomª
>

8 
	~<¿ndom
>

9 
	~<funùiÚ®
>

10 
usšg
 
Çme¥aû
 
	gNTL
;

11 
usšg
 
Çme¥aû
 
	g¡d
;

13 
	go¡»am
& 
	gİ”©Ü
<< (o¡»am& 
	gout
, cÚ¡ 
	gveùÜ
<>& 
	gv
){

14 autØ&
	gi
: 
v
è
out
 << 
i
 << " ";

15  
	gout
;

19 
	$maš
 (){

20 
deçuÉ_¿ndom_’gše
 
g’
;

21 
unifÜm_št_di¡ributiÚ
<> 
di¡
;

22 autØ
¿nd
 = 
	`bšd
(
di¡
,
g’
);

23 
of¡»am
 
	`fout
("result.txt");

24 
¡ršg
 
s
;

25 
ZZX
 
f
;

26 
f_deg
 = 2500;

27 
ty³_size
 = 50;

28 
ty³_’Œy
 = 49;

29 
´ec
 = 2500;

30 
ZZ
 
p_f›ld
;

31 
Vec
<
ZZ
>
rhs_fuÎ
;

32 
Vec
<
ZZ_p
>
rhs
;

33 
Vec
<
ZZ
>
rhs_fuÎ2
;

34 
Vec
<
ZZ_p
>
rhs2
;

35 
Vec
<> 
ty³
;

36 
i¡ršg¡»am
 
iss
;

38 
cout
 << "EÁ”hf›ld" << 
’dl
;

39 
cš
 >> 
p_f›ld
;

40 
ZZ_p
::
	`š™
(
p_f›ld
);

42 
cout
 << "EÁ”hdeg»e" << 
’dl
;

43 
cš
 >> 
f_deg
;

44 
cout
 << "EÁ”h´ecisiÚ" << 
’dl
;

45 
cš
 >> 
´ec
;

46 
i
 = 0; i <ğ
f_deg
; i++)

47 
	`S‘CÛff
(
f
,
i
,
	`¿nd
());

49 
cout
 << "EÁ”hty³†’gth" << 
’dl
;

50 
cš
 >> 
ty³_size
;

51 
cout
 << "EÁ”hty³ƒÁry" << 
’dl
;

52 
cš
 >> 
ty³_’Œy
;

53 
i
 = 0; i < 
ty³_size
; i++)

54 
ty³
.
	`­³nd
(
ty³_’Œy
);

56 
to
 = 
ty³_size
 * (
ty³_’Œy
+1);

57 
i
 = 0; i < 
to
; i++){

58 
rhs_fuÎ
.
	`­³nd
(
	`ZZ
(
	`¿nd
()));

59 
rhs_fuÎ2
.
	`­³nd
(
	`ZZ
(
	`¿nd
()));

61 
	`cÚv
(
rhs
,
rhs_fuÎ
);

62 
ZZ_pX
 
f_p
;

63 
	`cÚv
(
f_p
,
f
);

64 
cout
 << "f: " << 
f_p
 << 
’dl
;

65 
cout
 << "rhs: " << 
rhs
 << 
’dl
;

67 
ZZ_pX
 
f_f›ld
;

68 
	`cÚv
(
f_f›ld
,
f
);

69 autØ
p
 = 
	`Biv¬Ÿ‹ModuÏrComp
(
f_f›ld
,
ty³
,
´ec
);

70 
şock_t
 
t
;

71 
of¡»am
 
	`ofs
("result.txt");

72 
t
 = 
	`şock
();

73 autØ
m1
 = 
p
.
	`muÉ
(
rhs
);

75 
cout
 << "M©rix muÉook: " << 
	`şock
()-
t
 << 
’dl
;

76 
fout
 << "M©rix: " << 
m1
 << 
’dl
;

77 
t
 = 
	`şock
();

78 autØ
m2
 = 
p
.
	`muÉ_HÜÃrs
(
rhs
);

80 
cout
 << "HÜÃr' ruËook: " << 
	`şock
()-
t
 << 
’dl
;

81 
fout
 << "HÜÃr's: " << 
m2
 << 
’dl
;

82 
cout
 << "equ®? " << 
boŞ®pha
 << (
m1
 =ğ
m2
è<< 
’dl
;

83 
	}
}

	@cauchy_like_geometric_special/cauchy_geometric_special.h

1 #iâdeà
__CAUCHY_GEOMETRIC_SPECIAL_H


2 
	#__CAUCHY_GEOMETRIC_SPECIAL_H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/m©_lzz_p.h
>

7 
	#THRESHOLD
 100

	)

9 
NTL_CLIENT


17 şas 
	cÿuchy_geom‘ric_¥ecŸl
{

19 
	mpublic
:

20 
zz_p
 
a
, 
	mb
, 
	mq
;

21 
	mn
, 
	mm
;

29 
	mVec
<
	mmulmod_´ecÚ_t
> 
	mP_´e
, 
	mQab_´e
, 
	mQa_´e
, 
	mQb_´e
;

30 
	mVec
<> 
	mP_r
, 
	mQab_r
, 
	mQa_r
, 
	mQb_r
;

35 
	$ÿuchy_geom‘ric_¥ecŸl
(){}

41 
	`ÿuchy_geom‘ric_¥ecŸl
(cÚ¡ 
zz_p
& 
a
, cÚ¡ zz_p& 
b
, cÚ¡ zz_p& 
q
, cÚ¡ 
n
, cÚ¡ 
m
);

42 
	}
};

47 
bud
(
ÿuchy_geom‘ric_¥ecŸl
& 
C
,

48 cÚ¡ 
zz_p
& 
a
, cÚ¡ zz_p& 
b
, cÚ¡ zz_p& 
q
, 
n
, 
m
);

57 şas 
	cÿuchy_like_geom‘ric_¥ecŸl
{

59 
	mpublic
:

60 
n
, 
	mm
;

61 
	m®pha
;

63 
	mVec
<> 
	mG
, 
	mH
;

65 
ÿuchy_geom‘ric_¥ecŸl
 
	mC
;

67 
	$NumRows
() const {

68  
n
;

71 
	$NumCŞs
() const {

72  
m
;

73 
	}
}

75 
	$AÍha
() const {

76  
®pha
;

77 
	}
}

82 
	$ÿuchy_like_geom‘ric_¥ecŸl
(){
	}
}

87 
	$ÿuchy_like_geom‘ric_¥ecŸl
(cÚ¡ 
m©_zz_p
& 
G_š
, cÚ¡ m©_zz_p& 
H_š
, cÚ¡ 
ÿuchy_geom‘ric_¥ecŸl
& 
C
){

88 
this
->
C
 = C;

89 
n
 = 
G_š
.
	`NumRows
();

90 
m
 = 
H_š
.
	`NumRows
();

91 
®pha
 = 
G_š
.
	`NumCŞs
();

93 
G
.
	`S‘L’gth
(
n
*
®pha
);

94 
H
.
	`S‘L’gth
(
m
*
®pha
);

96 
idx
;

97 
idx
 = 0;

98 
i
 = 0; i < 
n
; i++)

99 
j
 = 0; j < 
®pha
; j++)

100 
G
[
idx
++] = 
	`»p
(
G_š
[
i
][
j
]);

101 
idx
 = 0;

102 
i
 = 0; i < 
m
; i++)

103 
j
 = 0; j < 
®pha
; j++)

104 
H
[
idx
++] = 
	`»p
(
H_š
[
i
][
j
]);

105 
	}
}

107 ~
	$ÿuchy_like_geom‘ric_¥ecŸl
(){
	}
}

113 
to_d’£
(
m©_zz_p
& 
A
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
);

119 
šv”t
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
Cšv
,

120 cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
);

127 
šv”t_ç¡
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
Cšv
,

128 cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
, cÚ¡ 
th»sh
 = -1);

133 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

138 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

144 
m©_addmul
(*
A
,

145 cÚ¡ * 
B
,

146 cÚ¡ * 
G
, cÚ¡ * 
H
,

147 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

148 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

149 cÚ¡ 
Vec
<> & 
P_r
,

150 cÚ¡ 
Vec
<> & 
Q_r
,

151 
shiá_P
, 
shiá_Q
,

152 
N1
, 
N2
,

153 
a
);

159 
m©_submul
(*
A
,

160 cÚ¡ * 
B
,

161 cÚ¡ * 
G
, cÚ¡ * 
H
,

162 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

163 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

164 cÚ¡ 
Vec
<> & 
P_r
,

165 cÚ¡ 
Vec
<> & 
Q_r
,

166 
shiá_P
, 
shiá_Q
,

167 
N1
, 
N2
,

168 
a
);

174 
m©_addmul_t
(*
A
,

175 cÚ¡ * 
B
,

176 cÚ¡ * 
G
, cÚ¡ * 
H
,

177 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

178 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

179 cÚ¡ 
Vec
<> & 
P_r
,

180 cÚ¡ 
Vec
<> & 
Q_r
,

181 
shiá_P
, 
shiá_Q
,

182 
N1
, 
N2
,

183 
a
);

189 
m©_submul_t
(*
A
,

190 cÚ¡ * 
B
,

191 cÚ¡ * 
G
, cÚ¡ * 
H
,

192 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

193 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

194 cÚ¡ 
Vec
<> & 
P_r
,

195 cÚ¡ 
Vec
<> & 
Q_r
,

196 
shiá_P
, 
shiá_Q
,

197 
N1
, 
N2
,

198 
a
);

	@cauchy_like_geometric_special/src/cauchy_geometric_special.cpp

1 
	~<NTL/m©_lzz_p.h
>

2 
	~<NTL/lzz_pX.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

7 
NTL_CLIENT


15 
	$bud
(
ÿuchy_geom‘ric_¥ecŸl
& 
C
, cÚ¡ 
zz_p
& 
a
, cÚ¡ zz_p& 
b
, cÚ¡ zz_p& 
q
,

16 cÚ¡ 
n
, cÚ¡ 
m
){

18 
C
.
n
 =‚;

19 
C
.
m
 = m;

20 
C
.
q
 = q;

21 
C
.
a
 =‡;

22 
C
.
b
 = b;

24 ià(
m
 =ğ0 || 
n
 == 0)

27 
vec_zz_p
 
P
;

28 
P
.
	`S‘L’gth
(
n
);

29 
zz_p
 
iq
 = 1/
q
, 
pow_iq
 = 
	`to_zz_p
(1);

30 
i
 = 0; i < 
n
; i++){

31 
P
[
i
] = 
pow_iq
;

32 
pow_iq
 *ğ
iq
;

35 
vec_zz_p
 
tmp
, 
tmp_n
, 
tmp_m
, 
™mp_n
, 
™mp_m
;

37 
tmp
.
	`S‘L’gth
(
m
+
n
-1);

39 
zz_p
 
pow_iq_tmp
 = 
pow_iq
;

40 
i
 = 0; i < 
m
+
n
-1; i++){

41 
pow_iq_tmp
 *ğ
q
;

42 
tmp
[
i
] = 
a
 - 
b
*
pow_iq_tmp
;

44 
vec_zz_p
 
Qab
;

45 
	`šv
(
Qab
, 
tmp
);

47 
tmp_n
.
	`S‘L’gth
(
n
-1);

48 
i
 = 0; i < 
n
-1; i++){

49 
pow_iq
 *ğ
q
;

50 
tmp_n
[
i
] = 1 - 
pow_iq
;

52 
	`šv
(
™mp_n
, 
tmp_n
);

54 
tmp_m
.
	`S‘L’gth
(
m
-1);

55 
pow_iq
 *ğ
q
;

56 
i
 = 0; i < 
m
-1; i++){

57 
pow_iq
 *ğ
q
;

58 
tmp_m
[
i
] = 1 - 
pow_iq
;

60 
	`šv
(
™mp_m
, 
tmp_m
);

62 
zz_p
 
Ÿ
 = 1/
a
, 
ib
 = 1/
b
;

63 
vec_zz_p
 
Qa
, 
Qb
;

64 
Qa
.
	`S‘L’gth
(
n
+
m
-1);

65 
Qb
.
	`S‘L’gth
(
n
+
m
-1);

67 
i
 = 0; i < 
n
-1; i++){

68 
Qa
[
i
] = 
™mp_n
[i]*
Ÿ
;

69 
Qb
[
i
] = 
™mp_n
[i]*
ib
;

71 
Qa
[
n
-1] = 
	`to_zz_p
(0);

72 
Qb
[
n
-1] = 
	`to_zz_p
(0);

73 
i
 = 
n
; i <‚+
m
-1; i++){

74 
Qa
[
i
] = 
™mp_m
[i-
n
]*
Ÿ
;

75 
Qb
[
i
] = 
™mp_m
[i-
n
]*
ib
;

79 
p
 = 
zz_p
::
	`modulus
();

80 cÚ¡ 
mulmod_t
 
pšv
 = 
zz_p
::
	`ModulusInv”£
();

82 
C
.
P_´e
.
	`S‘L’gth
(
n
);

83 
i
 = 0; i < 
n
; i++)

84 
C
.
P_´e
[
i
] = 
	`P»pMulModP»cÚ
(
	`»p
(
P
[i]), 
p
, 
pšv
);

86 
C
.
Qab_´e
.
	`S‘L’gth
(
n
+
m
-1);

87 
C
.
Qa_´e
.
	`S‘L’gth
(
n
+
m
-1);

88 
C
.
Qb_´e
.
	`S‘L’gth
(
n
+
m
-1);

90 
i
 = 0; i < 
n
+
m
-1; i++){

91 
C
.
Qab_´e
[
i
] = 
	`P»pMulModP»cÚ
(
	`»p
(
Qab
[i]), 
p
, 
pšv
);

92 
C
.
Qa_´e
[
i
] = 
	`P»pMulModP»cÚ
(
	`»p
(
Qa
[i]), 
p
, 
pšv
);

93 
C
.
Qb_´e
[
i
] = 
	`P»pMulModP»cÚ
(
	`»p
(
Qb
[i]), 
p
, 
pšv
);

97 
C
.
P_r
.
	`S‘L’gth
(
n
);

98 
i
 = 0; i < 
n
; i++)

99 
C
.
P_r
[
i
] = 
	`»p
(
P
[i]);

101 
C
.
Qab_r
.
	`S‘L’gth
(
n
+
m
-1);

102 
C
.
Qa_r
.
	`S‘L’gth
(
n
+
m
-1);

103 
C
.
Qb_r
.
	`S‘L’gth
(
n
+
m
-1);

105 
i
 = 0; i < 
n
+
m
-1; i++){

106 
C
.
Qab_r
[
i
] = 
	`»p
(
Qab
[i]);

107 
C
.
Qa_r
[
i
] = 
	`»p
(
Qa
[i]);

108 
C
.
Qb_r
[
i
] = 
	`»p
(
Qb
[i]);

110 
	}
}

112 
	gÿuchy_geom‘ric_¥ecŸl
::
	$ÿuchy_geom‘ric_¥ecŸl
(cÚ¡ 
zz_p
& 
a
, cÚ¡ zz_p& 
b
, cÚ¡ zz_p& 
q
, 
n
, 
m
){

113 
	`bud
(*
this
, 
a
, 
b
, 
q
, 
n
, 
m
);

114 
	}
}

	@cauchy_like_geometric_special/src/cauchy_like_geometric_special.cpp

1 
	~<NTL/m©_lzz_p.h
>

2 
	~<NTL/lzz_pX.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

7 
NTL_CLIENT


24 
	$th»shŞd
(
®pha
){

25  100 + 
®pha
*12;

26 
	}
}

31 
to_d’£
(
M©
<
zz_p
> & 
A
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
){

32 
	gn
 = 
CL
.
NumRows
(), 
	gm
 = CL.
NumCŞs
(), 
	g®pha
 = CL.
AÍha
();

34 
	gA
.
S‘Dims
(
n
, 
m
);

35 
vec_zz_p
 
	gtmpg
, 
	gtmph
;

36 
	gtmpg
.
S‘L’gth
(
®pha
);

37 
	gtmph
.
S‘L’gth
(
®pha
);

38 
	gi
 = 0; i < 
	gn
; i++){

39 
	g–l
 = 0;ƒÎ < 
	g®pha
;ƒll++)

40 
	gtmpg
[
–l
] = 
CL
.
G
[
i
*
®pha
+ell];

41 
	gj
 = 0; j < 
	gm
; j++){

42 
	g–l
 = 0;ƒÎ < 
	g®pha
;ƒll++)

43 
	gtmph
[
–l
] = 
CL
.
H
[
j
*
®pha
+ell];

44 
IÂ”Produù
(
A
[
i
][
j
], 
tmpg
, 
tmph
);

45 
	gA
[
i
][
j
] /ğ(
CL
.
C
.
a
*
pow”
(CL.C.
q
, i)-
	gCL
.
	gC
.
b
*power(CL.C.q, j));

59 
	$šv”t_¿w
(*
Yp
, *
Zp
, cÚ¡ 
®pha
,

60 cÚ¡ 
ÿuchy_geom‘ric_¥ecŸl
& 
C
,

61 cÚ¡ 
i0
, cÚ¡ 
i1
, cÚ¡ 
j0
, cÚ¡ 
j1
){

68 cÚ¡ 
n
 = 
C
.n;

69 cÚ¡ 
p
 = 
zz_p
::
	`modulus
();

70 
mulmod_´ecÚ_t
 *
Y´e
 = 
Ãw
 mulmod_´ecÚ_t[
®pha
];

71 
mulmod_´ecÚ_t
 *
Z´e
 = 
Ãw
 mulmod_´ecÚ_t[
®pha
];

72 cÚ¡ 
mulmod_t
 
pšv
 = 
zz_p
::
	`ModulusInv”£
();

74 *
tmpYk
 = 
Yp
;

75 *
tmpZk
 = 
Zp
;

77 
N
 = 
	`mš
(
i1
-
i0
, 
j1
-
j0
);

79 
k
 = 0; k < 
N
; k++){

80 *
tmpYi
 = 
Yp
;

81 *
tmpZi
 = 
Zp
;

83 
j
 = 0; j < 
®pha
; j++){

84 
Y´e
[
j
] = 
	`P»pMulModP»cÚ
(
tmpYk
[j], 
p
, 
pšv
);

85 
Z´e
[
j
] = 
	`P»pMulModP»cÚ
(
tmpZk
[j], 
p
, 
pšv
);

89 
rd
 = 0;

90 
j
 = 0; j < 
®pha
; j++)

91 
rd
 = 
	`AddMod
Ôd, 
	`MulMod
(
tmpZk
[
j
], 
tmpYk
[j], 
p
, 
pšv
),…);

95 ià(
rd
 == 0){

96 *
tmpY
 = 
tmpYk
;

97 
a
 = 
k
;‡ < 
i1
-
i0
;‡++){

98 *
tmpZ
 = 
tmpZk
;

99 
b
 = 
k
; b < 
j1
-
j0
; b++){

100 
tmp
 = 0;

101 
j
 = 0; j < 
®pha
; j++)

102 
tmp
 = 
	`AddMod
Ñmp, 
	`MulMod
(
tmpZ
[
j
], 
tmpY
[j], 
p
, 
pšv
),…);

103 ià(
tmp
 != 0) {

104 
d–‘e
[] 
Y´e
;

105 
d–‘e
[] 
Z´e
;

108 
tmpZ
 +ğ
®pha
;

110 
tmpY
 +ğ
®pha
;

112 
d–‘e
[] 
Y´e
;

113 
d–‘e
[] 
Z´e
;

114  
k
;

117 
rd
 = 
	`MulModP»cÚ
Ôd, 
C
.
P_r
[
k
+
i0
], 
p
, C.
P_´e
[k+i0]);

118 
rd
 = 
	`MulModP»cÚ
Ôd, 
C
.
Qab_r
[
j0
-
i0
+
n
-1], 
p
, C.
Qab_´e
[j0-i0+n-1]);

120 
zz_p
 
	`d
(
rd
, 
INIT_LOOP_HOLE
);

121 
zz_p
 
id
 = 1/
d
;

122 
zz_p
 
mid
 = -
id
;

124 cÚ¡ 
rid
 = 
	`»p
(
id
);

125 cÚ¡ 
rmid
 = 
	`»p
(
mid
);

126 
mulmod_´ecÚ_t
 
pd
 = 
	`P»pMulModP»cÚ
(
rd
, 
p
, 
pšv
);

127 
mulmod_´ecÚ_t
 
´id
 = 
	`P»pMulModP»cÚ
(
rid
, 
p
, 
pšv
);

129 
i
 = 0; i < 
k
; i++){

131 
–l
 = 0, 
u
 = 0;

132 
j
 = 0; j < 
®pha
; j++){

133 
–l
 = 
	`AddMod
ÓÎ, 
	`MulModP»cÚ
(
tmpYi
[
j
], 
tmpZk
[j], 
p
, 
Z´e
[j]),…);

134 
u
 = 
	`AddMod
(u, 
	`MulModP»cÚ
(
tmpZi
[
j
], 
tmpYk
[j], 
p
, 
Y´e
[j]),…);

140 
–l
 = 
	`MulModP»cÚ
ÓÎ, 
rid
, 
p
, 
´id
);

141 
–l
 = 
	`MulModP»cÚ
ÓÎ, 
C
.
P_r
[
i
+
i0
], 
p
, C.
P_´e
[i+i0]);

142 
–l
 = 
	`MulModP»cÚ
ÓÎ, 
C
.
Qb_r
[
k
+
j0
-
i
-
i0
+
n
-1], 
p
, C.
Qb_´e
[k+j0-i-i0+n-1]);

144 
u
 = 
	`MulModP»cÚ
(u, 
rid
, 
p
, 
´id
);

145 
u
 = 
	`MulModP»cÚ
(u, 
C
.
P_r
[
i
+
i0
], 
p
, C.
P_´e
[i+i0]);

146 
u
 = 
	`MulModP»cÚ
(u, 
C
.
Qa_r
[
k
+
j0
-
i
-
i0
+
n
-1], 
p
, C.
Qa_´e
[k+j0-i-i0+n-1]);

148 
j
 = 0; j < 
®pha
; j++){

149 
tmpYi
[
j
] = 
	`SubMod
ÑmpYi[j], 
	`MulModP»cÚ
(
–l
, 
tmpYk
[j], 
p
, 
Y´e
[j]),…);

150 
tmpZi
[
j
] = 
	`AddMod
ÑmpZi[j], 
	`MulModP»cÚ
(
u
, 
tmpZk
[j], 
p
, 
Z´e
[j]),…);

153 
tmpYi
 +ğ
®pha
;

154 
tmpZi
 +ğ
®pha
;

157 
j
 = 0; j < 
®pha
; j++){

158 
tmpYk
[
j
] = 
	`MulModP»cÚ
(
rmid
,mpYk[j], 
p
, 
Y´e
[j]);

159 
Y´e
[
j
] = 
	`P»pMulModP»cÚ
(
tmpYk
[j], 
p
, 
pšv
);

160 
tmpZk
[
j
] = 
	`MulModP»cÚ
(
rid
,mpZk[j], 
p
, 
Z´e
[j]);

161 
Z´e
[
j
] = 
	`P»pMulModP»cÚ
(
tmpZk
[j], 
p
, 
pšv
);

164 
tmpYi
 +ğ
®pha
;

165 
tmpZi
 +ğ
®pha
;

167 
i
 = 
k
+1; i < 
N
; i++){

169 
–l
 = 0, 
u
 = 0;

170 
j
 = 0; j < 
®pha
; j++){

171 
–l
 = 
	`AddMod
ÓÎ, 
	`MulModP»cÚ
(
tmpYi
[
j
], 
tmpZk
[j], 
p
, 
Z´e
[j]),…);

172 
u
 = 
	`AddMod
(u, 
	`MulModP»cÚ
(
tmpZi
[
j
], 
tmpYk
[j], 
p
, 
Y´e
[j]),…);

177 
–l
 = 
	`MulModP»cÚ
ÓÎ, 
rd
, 
p
, 
pd
);

178 
–l
 = 
	`MulModP»cÚ
ÓÎ, 
C
.
P_r
[
i
+
i0
], 
p
, C.
P_´e
[i+i0]);

179 
–l
 = 
	`MulModP»cÚ
ÓÎ, 
C
.
Qab_r
[
k
+
j0
-
i
-
i0
+
n
-1], 
p
, C.
Qab_´e
[k+j0-i-i0+n-1]);

181 
u
 = 
	`MulModP»cÚ
(u, 
rd
, 
p
, 
pd
);

182 
u
 = 
	`MulModP»cÚ
(u, 
C
.
P_r
[
k
+
i0
], 
p
, C.
P_´e
[k+i0]);

183 
u
 = 
	`MulModP»cÚ
(u, 
C
.
Qab_r
[
i
+
j0
-
k
-
i0
+
n
-1], 
p
, C.
Qab_´e
[i+j0-k-i0+n-1]);

185 
j
 = 0; j < 
®pha
; j++){

186 
tmpYi
[
j
] = 
	`AddMod
ÑmpYi[j], 
	`MulModP»cÚ
(
–l
, 
tmpYk
[j], 
p
, 
Y´e
[j]),…);

187 
tmpZi
[
j
] = 
	`AddMod
ÑmpZi[j], 
	`MulModP»cÚ
(
u
, 
tmpZk
[j], 
p
, 
Z´e
[j]),…);

190 
tmpYi
 +ğ
®pha
;

191 
tmpZi
 +ğ
®pha
;

194 
tmpYk
 +ğ
®pha
;

195 
tmpZk
 +ğ
®pha
;

198 
d–‘e
[] 
Y´e
;

199 
d–‘e
[] 
Z´e
;

200  
N
;

201 
	}
}

207 
	$šv”t
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
Cšv
,

208 cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
){

210 
r
 = -1;

212 
n
 = 
CL
.
	`NumRows
();

213 
m
 = 
CL
.
	`NumCŞs
();

214 
®pha
 = 
CL
.
	`AÍha
();

216 *
Yp
 = 
Ãw
 [
n
*
®pha
];

217 
i
 = 0; i < 
n
*
®pha
; i++)

218 
Yp
[
i
] = 
CL
.
G
[i];

220 *
Zp
 = 
Ãw
 [
m
*
®pha
];

221 
i
 = 0; i < 
m
*
®pha
; i++)

222 
Zp
[
i
] = 
CL
.
H
[i];

224 
r
 = 
	`šv”t_¿w
(
Yp
, 
Zp
, 
®pha
, 
CL
.
C
, 0, 
n
, 0, 
m
);

226 ià(
r
 == -1){

227 
d–‘e
[] 
Yp
;

228 
d–‘e
[] 
Zp
;

232 
	`bud
(
Cšv
.
C
, 
CL
.C.
b
, CL.C.
a
, CL.C.
q
, 
r
,„);

233 
Cšv
.
n
 = 
r
;

234 
Cšv
.
m
 = 
r
;

235 
Cšv
.
®pha
 =‡lpha;

236 
Cšv
.
G
.
	`S‘L’gth
(
r
*
®pha
);

237 
Cšv
.
H
.
	`S‘L’gth
(
r
*
®pha
);

239 
i
 = 0; i < 
r
*
®pha
; i++){

240 
Cšv
.
G
[
i
] = 
Yp
[i];

241 
Cšv
.
H
[
i
] = 
Zp
[i];

244 
d–‘e
[] 
Yp
;

245 
d–‘e
[] 
Zp
;

246  
r
;

247 
	}
}

255 
	$šv”t_ç¡_¿w
(*
Yp
, *
Zp
, cÚ¡ 
®pha
,

256 cÚ¡ 
ÿuchy_geom‘ric_¥ecŸl
& 
C
,

257 cÚ¡ 
i0
, cÚ¡ 
i1
, cÚ¡ 
j0
, cÚ¡ 
j1
, cÚ¡ 
th»sh
){

259 cÚ¡ 
N
 = 
	`mš
(
i1
-
i0
, 
j1
-
j0
);

260 ià(
N
 < 
th»sh
)

261  
	`šv”t_¿w
(
Yp
, 
Zp
, 
®pha
, 
C
, 
i0
, 
i1
, 
j0
, 
j1
);

263 cÚ¡ 
n
 = 
C
.n;

264 cÚ¡ 
N1
 = 
N
/2;

265 cÚ¡ 
N2
 = 
N
-
N1
;

267 cÚ¡ 
®phaN
 = 
N
*
®pha
;

268 cÚ¡ 
®phaN1
 = 
N1
*
®pha
;

270 *
G1
 = 
Ãw
 [
®pha
*(
i1
-
i0
)];

271 *
H1
 = 
Ãw
 [
®pha
*(
j1
-
j0
)];

272 *
G2
 = 
G1
 + 
®phaN1
;

273 *
H2
 = 
H1
 + 
®phaN1
;

274 *
iSG
 = 
Yp
 + 
®phaN1
;

275 *
iSH
 = 
Zp
 + 
®phaN1
;

278 
i
 = 0; i < 
®phaN
; i++){

279 
G1
[
i
] = 
Yp
[i];

280 
H1
[
i
] = 
Zp
[i];

283 
r
 = 
	`šv”t_ç¡_¿w
(
G1
, 
H1
, 
®pha
, 
C
, 
i0
, i0+
N1
, 
j0
, j0+N1, 
th»sh
);

286 ià(
r
 == -1){

287 
d–‘e
[] 
G1
;

288 
d–‘e
[] 
H1
;

293 ià(
r
 < 
N1
){

294 
G2
 = 
G1
 + 
®pha
*
r
;

295 
H2
 = 
H1
 + 
®pha
*
r
;

296 
iSG
 = 
Yp
 + 
®pha
*
r
;

297 
iSH
 = 
Zp
 + 
®pha
*
r
;

300 
	`m©_addmul
(
G2
, 
G1
, 
iSG
, 
Zp
, 
C
.
P_´e
, C.
Qab_´e
, C.
P_r
, C.
Qab_r
, 
i0
+
r
, 
n
+
j0
-
i1
, i1-i0-r,„, 
®pha
);

301 
	`m©_submul_t
(
H2
, 
H1
, 
iSH
, 
Yp
, 
C
.
P_´e
, C.
Qab_´e
, C.
P_r
, C.
Qab_r
, 
i0
, 
n
+
j0
-i0, 
r
, 
j1
-j0-r, 
®pha
);

304 *
tmpG
 = 
Ãw
 [
®pha
];

305 *
tmpH
 = 
Ãw
 [
®pha
];

307 
j
 = 0; j < 
®pha
; j++)

308 
tmpG
[
j
] = 
tmpH
[j] = 0;

310 
i
 = 0; i < 
i1
-
i0
-
r
; i++){

311 
cf
 = 
	`»p
(
	`¿ndom_zz_p
());

312 
j
 = 0; j < 
®pha
; j++)

313 
tmpG
[
j
] = 
	`AddMod
ÑmpG[j], 
	`MulMod
(
G2
[
i
*
®pha
+j], 
cf
, 
zz_p
::
	`modulus
()), zz_p::modulus());

316 
i
 = 0; i < 
j1
-
j0
-
r
; i++){

317 
cf
 = 
	`»p
(
	`¿ndom_zz_p
());

318 
j
 = 0; j < 
®pha
; j++)

319 
tmpH
[
j
] = 
	`AddMod
ÑmpH[j], 
	`MulMod
(
H2
[
i
*
®pha
+j], 
cf
, 
zz_p
::
	`modulus
()), zz_p::modulus());

322 
sum
 = 0;

323 
k
 = 0; k < 
®pha
; k++)

324 
sum
 = 
	`AddMod
(sum, 
	`MulMod
(
tmpG
[
k
], 
tmpH
[k], 
zz_p
::
	`modulus
()), zz_p::modulus());

325 ià(
sum
 != 0)

326 
r
 = -1;

328 
d–‘e
[] 
tmpG
;

329 
d–‘e
[] 
tmpH
;

331 ià(
r
 != -1){

332 
i
 = 0; i < 
®pha
*
r
; i++){

333 
Yp
[
i
] = 
G1
[i];

334 
Zp
[
i
] = 
H1
[i];

338 
d–‘e
[] 
G1
;

339 
d–‘e
[] 
H1
;

340  
r
;

345 
	`m©_addmul
(
G2
, 
G1
, 
iSG
, 
Zp
, 
C
.
P_´e
, C.
Qab_´e
, C.
P_r
, C.
Qab_r
, 
i0
+
N1
, 
n
+
j0
-
i1
, i1-i0-N1, N1, 
®pha
);

346 
	`m©_submul_t
(
H2
, 
H1
, 
iSH
, 
Yp
, 
C
.
P_´e
, C.
Qab_´e
, C.
P_r
, C.
Qab_r
, 
i0
, 
n
+
j0
-i0, 
N1
, 
j1
-j0-N1, 
®pha
);

349 
i
 = 0; i < 
®phaN
; i++){

350 
Yp
[
i
] = 
G1
[i];

351 
Zp
[
i
] = 
H1
[i];

355 
r
 = 
	`šv”t_ç¡_¿w
(
iSG
, 
iSH
, 
®pha
, 
C
, 
i0
+
N1
, 
i1
, 
j0
+N1, 
j1
, 
th»sh
);

357 ià(
r
 == -1){

358 
d–‘e
[] 
G1
;

359 
d–‘e
[] 
H1
;

363 
	`m©_addmul
(
Yp
, 
iSG
, 
G1
, 
H2
, 
C
.
P_´e
, C.
Qb_´e
, C.
P_r
, C.
Qb_r
, 
i0
, 
n
+
j0
-i0, 
N1
, 
N2
, 
®pha
);

364 
	`m©_addmul
(
Zp
, 
iSH
, 
H1
, 
G2
, 
C
.
P_´e
, C.
Qa_´e
, C.
P_r
, C.
Qa_r
, 
i0
, 
n
+
j0
-i0, 
N1
, 
N2
, 
®pha
);

366 
d–‘e
[] 
G1
;

367 
d–‘e
[] 
H1
;

368  
N1
+
r
;

369 
	}
}

375 
	$šv”t_ç¡
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
Cšv
,

376 cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
, cÚ¡ 
th»sh
){

378 
n
 = 
CL
.
	`NumRows
();

379 
m
 = 
CL
.
	`NumCŞs
();

380 
®pha
 = 
CL
.
	`AÍha
();

382 
do_th»sh
;

383 ià(
th»sh
 == -1)

384 
do_th»sh
 = 
	`th»shŞd
(
®pha
);

386 
do_th»sh
 = 
th»sh
;

388 *
Yp
 = 
Ãw
 [
n
*
®pha
];

389 
i
 = 0; i < 
n
*
®pha
; i++)

390 
Yp
[
i
] = 
CL
.
G
[i];

392 *
Zp
 = 
Ãw
 [
m
*
®pha
];

393 
i
 = 0; i < 
m
*
®pha
; i++)

394 
Zp
[
i
] = 
CL
.
H
[i];

396 
r
 = 
	`šv”t_ç¡_¿w
(
Yp
, 
Zp
, 
®pha
, 
CL
.
C
, 0, 
n
, 0, 
m
, 
do_th»sh
);

398 ià(
r
 == -1){

399 
d–‘e
[] 
Yp
;

400 
d–‘e
[] 
Zp
;

404 
	`bud
(
Cšv
.
C
, 
CL
.C.
b
, CL.C.
a
, CL.C.
q
, 
r
,„);

405 
Cšv
.
n
 = 
r
;

406 
Cšv
.
m
 = 
r
;

407 
Cšv
.
®pha
 =‡lpha;

408 
Cšv
.
G
.
	`S‘L’gth
(
r
*
®pha
);

409 
Cšv
.
H
.
	`S‘L’gth
(
r
*
®pha
);

411 
i
 = 0; i < 
r
*
®pha
; i++){

412 
Cšv
.
G
[
i
] = 
Yp
[i];

413 
Cšv
.
H
[
i
] = 
Zp
[i];

416 
d–‘e
[] 
Yp
;

417 
d–‘e
[] 
Zp
;

418  
r
;

419 
	}
}

	@cauchy_like_geometric_special/src/mat_addmul.cpp

1 
	~<NTL/lzz_pX.h
>

3 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

5 
NTL_CLIENT


18 
m©_addmul_fá
(*
A
,

19 cÚ¡ * 
B
,

20 cÚ¡ * 
G
, cÚ¡ * 
H
,

21 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

22 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

23 cÚ¡ 
Vec
<> & 
P_r
,

24 cÚ¡ 
Vec
<> & 
Q_r
,

25 
shiá_P
, 
shiá_Q
,

26 
N1
, 
N2
,

27 
a
, 
b
){

29 cÚ¡ 
	gp
 = 
zz_p
::
modulus
();

30 cÚ¡ 
mulmod_t
 
	gpšv
 = 
zz_p
::
ModulusInv”£
();

32 
zz_p
 *
	gw
 = 
Ãw
 zz_p[
N1
];

34 
	gK
 = 
NextPow”OfTwo
(
N1
+
N2
-1);

35 
fáR•
 
	gfáR
 = fáR•(
INIT_SIZE
, 
K
);

36 
fáR•
 
	gfáUV
 = fáR•(
INIT_SIZE
, 
K
);

38 
	gd
 = 
N1
+
N2
-1;

39 
zz_pX
 
	g»vA
, 
	gpŞU
, 
	gpŞV
;

41 
	g»vA
.
	g»p
.
S‘L’gth
(
d
);

42 
zz_p
* 
	g»vAp
 = 
»vA
.
»p
.
–ts
();

43 
	gi
 = 0; i < 
	gd
; i++)

44 
	g»vAp
[
i
] = 
Q_r
[
d
-i-1+
shiá_Q
];

45 
	g»vA
.
nÜm®ize
();

46 
TofáR•
(
fáR
, 
»vA
, 
K
);

48 
	gpŞV
.
	g»p
.
S‘L’gth
(
N2
);

49 
zz_p
 *
	gpŞVp
 = 
pŞV
.
»p
.
–ts
();

51 * 
	g¡k
 = 
Ãw
 [
N1
];

53 
	gk
 = 0; k < 
	gb
; k++){

55 
	gi
 = 0; i < 
	gN1
; i++)

56 
	g¡k
[
i
] = 0;

58 
	gi
 = 0; i < 
	ga
; i++){

59 
	gj
 = 0, 
	gaj
 = 0, 
	gbj
 = 0; j < 
	gN2
; j++, bj +ğ
b
,‡j +ğ
a
)

60 
pŞVp
[
j
].
_zz_p__»p
 = 
MulMod
(
B
[
bj
+
k
], 
H
[
aj
+
i
], 
p
, 
pšv
);

62 
TofáR•
(
fáUV
, 
pŞV
, 
K
);

63 
mul
(
fáUV
, fáUV, 
fáR
);

64 
FromfáR•
(
pŞU
, 
fáUV
, 
N2
-1, 
d
-1);

66 cÚ¡ 
	gUl
 = 
pŞU
.
»p
.
Ëngth
();

67 cÚ¡ 
zz_p
 *
	gpŞUp
 = 
pŞU
.
»p
.
–ts
();

69 
	gj
 = 0, 
	gaj
 = 0; j < 
	gUl
; j++,‡j +ğ
a
)

70 
¡k
[
j
] = 
AddMod
(¡k[j], 
MulMod
(
»p
(
pŞUp
[j]), 
G
[
aj
+
i
], 
p
, 
pšv
),…);

72 
	gj
 = 0, 
	gaj
 = 0, 
	gbj
 = 0; j < 
	gN1
; j++,‡j +ğ
a
, bj +ğ
b
)

73 
A
[
bj
+
k
] = 
AddMod
(A[bj+k], 
MulModP»cÚ
(
¡k
[
j
], 
P_r
[j+
shiá_P
], 
p
, 
P_´e
[j+shift_P]),…);

76 
	gd–‘e
[] 
	g¡k
;

77 
	gd–‘e
[] 
	gw
;

85 
m©_submul_fá
(*
A
,

86 cÚ¡ * 
B
,

87 cÚ¡ * 
G
, cÚ¡ * 
H
,

88 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

89 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

90 cÚ¡ 
Vec
<> & 
P_r
,

91 cÚ¡ 
Vec
<> & 
Q_r
,

92 
shiá_P
, 
shiá_Q
,

93 
N1
, 
N2
,

94 
a
, 
b
){

96 cÚ¡ 
	gp
 = 
zz_p
::
modulus
();

97 cÚ¡ 
mulmod_t
 
	gpšv
 = 
zz_p
::
ModulusInv”£
();

99 
zz_p
 *
	gw
 = 
Ãw
 zz_p[
N1
];

101 
	gK
 = 
NextPow”OfTwo
(
N1
+
N2
-1);

102 
fáR•
 
	gfáR
 = fáR•(
INIT_SIZE
, 
K
);

103 
fáR•
 
	gfáUV
 = fáR•(
INIT_SIZE
, 
K
);

105 
	gd
 = 
N1
+
N2
-1;

106 
zz_pX
 
	g»vA
, 
	gpŞU
, 
	gpŞV
;

108 
	g»vA
.
	g»p
.
S‘L’gth
(
d
);

109 
zz_p
* 
	g»vAp
 = 
»vA
.
»p
.
–ts
();

110 
	gi
 = 0; i < 
	gd
; i++)

111 
	g»vAp
[
i
] = 
Q_r
[
d
-i-1+
shiá_Q
];

112 
	g»vA
.
nÜm®ize
();

113 
TofáR•
(
fáR
, 
»vA
, 
K
);

115 
	gpŞV
.
	g»p
.
S‘L’gth
(
N2
);

116 
zz_p
 *
	gpŞVp
 = 
pŞV
.
»p
.
–ts
();

118 * 
	g¡k
 = 
Ãw
 [
N1
];

120 
	gk
 = 0; k < 
	gb
; k++){

122 
	gi
 = 0; i < 
	gN1
; i++)

123 
	g¡k
[
i
] = 0;

125 
	gi
 = 0; i < 
	ga
; i++){

126 
	gj
 = 0, 
	gaj
 = 0, 
	gbj
 = 0; j < 
	gN2
; j++, bj +ğ
b
,‡j +ğ
a
)

127 
pŞVp
[
j
].
_zz_p__»p
 = 
MulMod
(
B
[
bj
+
k
], 
H
[
aj
+
i
], 
p
, 
pšv
);

129 
TofáR•
(
fáUV
, 
pŞV
, 
K
);

130 
mul
(
fáUV
, fáUV, 
fáR
);

131 
FromfáR•
(
pŞU
, 
fáUV
, 
N2
-1, 
d
-1);

133 cÚ¡ 
	gUl
 = 
pŞU
.
»p
.
Ëngth
();

134 cÚ¡ 
zz_p
 *
	gpŞUp
 = 
pŞU
.
»p
.
–ts
();

136 
	gj
 = 0, 
	gaj
 = 0; j < 
	gUl
; j++,‡j +ğ
a
)

137 
¡k
[
j
] = 
AddMod
(¡k[j], 
MulMod
(
»p
(
pŞUp
[j]), 
G
[
aj
+
i
], 
p
, 
pšv
),…);

139 
	gj
 = 0, 
	gaj
 = 0, 
	gbj
 = 0; j < 
	gN1
; j++,‡j +ğ
a
, bj +ğ
b
)

140 
A
[
bj
+
k
] = 
SubMod
(A[bj+k], 
MulModP»cÚ
(
¡k
[
j
], 
P_r
[j+
shiá_P
], 
p
, 
P_´e
[j+shift_P]),…);

143 
	gd–‘e
[] 
	g¡k
;

144 
	gd–‘e
[] 
	gw
;

152 
šlše
 
m©_addmul_t_fá
(*
A
,

153 cÚ¡ * 
B
,

154 cÚ¡ * 
G
, cÚ¡ * 
H
,

155 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

156 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

157 cÚ¡ 
Vec
<> & 
P_r
,

158 cÚ¡ 
Vec
<> & 
Q_r
,

159 
shiá_P
, 
shiá_Q
,

160 
N1
, 
N2
,

161 
a
, 
b
){

163 cÚ¡ 
	gp
 = 
zz_p
::
modulus
();

164 cÚ¡ 
mulmod_t
 
	gpšv
 = 
zz_p
::
ModulusInv”£
();

166 
	gK
 = 
NextPow”OfTwo
(
N1
+
N2
-1);

167 
fáR•
 
	gfáS
 = fáR•(
INIT_SIZE
, 
K
);

168 
fáR•
 
	gfáUV
 = fáR•(
INIT_SIZE
, 
K
);

170 
	gd
 = 
N1
+
N2
-1;

171 
zz_pX
 
	gpŞA
, 
	gpŞV
, 
	gpŞU
;

173 
	gpŞA
.
	g»p
.
S‘L’gth
(
d
);

174 
zz_p
* 
	gA­
 = 
pŞA
.
»p
.
–ts
();

175 
	gi
 = 0; i < 
	gd
; i++)

176 
	gA­
[
i
] = 
Q_r
[i+
shiá_Q
];

177 
	gpŞA
.
nÜm®ize
();

179 
TofáR•
(
fáS
, 
pŞA
, 
K
);

181 
	gpŞV
.
	g»p
.
S‘L’gth
(
N1
);

182 
zz_p
 *
	gpŞVp
 = 
pŞV
.
»p
.
–ts
();

184 * 
	g¡k
 = 
Ãw
 [
N2
];

185 * 
	gBk
 = 
Ãw
 [
N1
];

187 
	gk
 = 0; k < 
	gb
; k++){

189 
	gj
 = 0, 
	gbj
 = 0; j < 
	gN1
; j++, bj +ğ
b
)

190 
Bk
[
j
] = 
MulModP»cÚ
(
B
[
bj
+
k
], 
P_r
[j+
shiá_P
], 
p
, 
P_´e
[j+shift_P]);

191 
	gj
 = 0; j < 
	gN2
; j++)

192 
	g¡k
[
j
] = 0;

194 
	gi
 = 0; i < 
	ga
; i++){

195 
	gj
 = 0, 
	gaj
 = 0; j < 
	gN1
; j++,‡j +ğ
a
)

196 
pŞVp
[
j
].
LoİHŞe
(èğ
MulMod
(
Bk
[j], 
H
[
aj
+
i
], 
p
, 
pšv
);

198 
TofáR•
(
fáUV
, 
pŞV
, 
K
);

199 
mul
(
fáUV
, fáUV, 
fáS
);

200 
FromfáR•
(
pŞU
, 
fáUV
, 
N1
-1, 
d
-1);

202 
	gUl
 = 
pŞU
.
»p
.
Ëngth
();

203 
zz_p
 *
	gpŞUp
 = 
pŞU
.
»p
.
–ts
();

205 
	gj
 = 0, 
	gaj
 = 0; j < 
	gUl
; j++,‡j +ğ
a
)

206 
¡k
[
j
] = 
AddMod
(¡k[j], 
MulMod
(
»p
(
pŞUp
[j]), 
G
[
aj
+
i
], 
p
, 
pšv
),…);

208 
	gj
 = 0, 
	gbj
 = 0; j < 
	gN2
; j++, bj +ğ
b
)

209 
A
[
bj
+
k
] = 
AddMod
(A[bj+k], 
¡k
[
j
], 
p
);

212 
	gd–‘e
[] 
	g¡k
;

213 
	gd–‘e
[] 
	gBk
;

221 
šlše
 
m©_submul_t_fá
(*
A
,

222 cÚ¡ * 
B
,

223 cÚ¡ * 
G
, cÚ¡ * 
H
,

224 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

225 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

226 cÚ¡ 
Vec
<> & 
P_r
,

227 cÚ¡ 
Vec
<> & 
Q_r
,

228 
shiá_P
, 
shiá_Q
,

229 
N1
, 
N2
,

230 
a
, 
b
){

232 cÚ¡ 
	gp
 = 
zz_p
::
modulus
();

233 cÚ¡ 
mulmod_t
 
	gpšv
 = 
zz_p
::
ModulusInv”£
();

235 
	gK
 = 
NextPow”OfTwo
(
N1
+
N2
-1);

236 
fáR•
 
	gfáS
 = fáR•(
INIT_SIZE
, 
K
);

237 
fáR•
 
	gfáUV
 = fáR•(
INIT_SIZE
, 
K
);

239 
	gd
 = 
N1
+
N2
-1;

240 
zz_pX
 
	gpŞA
, 
	gpŞV
, 
	gpŞU
;

242 
	gpŞA
.
	g»p
.
S‘L’gth
(
d
);

243 
zz_p
* 
	gA­
 = 
pŞA
.
»p
.
–ts
();

244 
	gi
 = 0; i < 
	gd
; i++)

245 
	gA­
[
i
] = 
Q_r
[i+
shiá_Q
];

246 
	gpŞA
.
nÜm®ize
();

248 
TofáR•
(
fáS
, 
pŞA
, 
K
);

250 
	gpŞV
.
	g»p
.
S‘L’gth
(
N1
);

251 
zz_p
 *
	gpŞVp
 = 
pŞV
.
»p
.
–ts
();

253 * 
	g¡k
 = 
Ãw
 [
N2
];

254 * 
	gBk
 = 
Ãw
 [
N1
];

256 
	gk
 = 0; k < 
	gb
; k++){

258 
	gj
 = 0, 
	gbj
 = 0; j < 
	gN1
; j++, bj +ğ
b
)

259 
Bk
[
j
] = 
MulModP»cÚ
(
B
[
bj
+
k
], 
P_r
[j+
shiá_P
], 
p
, 
P_´e
[j+shift_P]);

260 
	gj
 = 0; j < 
	gN2
; j++)

261 
	g¡k
[
j
] = 0;

263 
	gi
 = 0; i < 
	ga
; i++){

264 
	gj
 = 0, 
	gaj
 = 0; j < 
	gN1
; j++,‡j +ğ
a
)

265 
pŞVp
[
j
].
LoİHŞe
(èğ
MulMod
(
Bk
[j], 
H
[
aj
+
i
], 
p
, 
pšv
);

267 
TofáR•
(
fáUV
, 
pŞV
, 
K
);

268 
mul
(
fáUV
, fáUV, 
fáS
);

269 
FromfáR•
(
pŞU
, 
fáUV
, 
N1
-1, 
d
-1);

271 
	gUl
 = 
pŞU
.
»p
.
Ëngth
();

272 
zz_p
 *
	gpŞUp
 = 
pŞU
.
»p
.
–ts
();

274 
	gj
 = 0, 
	gaj
 = 0; j < 
	gUl
; j++,‡j +ğ
a
)

275 
¡k
[
j
] = 
SubMod
(¡k[j], 
MulMod
(
»p
(
pŞUp
[j]), 
G
[
aj
+
i
], 
p
, 
pšv
),…);

277 
	gj
 = 0, 
	gbj
 = 0; j < 
	gN2
; j++, bj +ğ
b
)

278 
A
[
bj
+
k
] = 
AddMod
(A[bj+k], 
¡k
[
j
], 
p
);

281 
	gd–‘e
[] 
	g¡k
;

282 
	gd–‘e
[] 
	gBk
;

297 
m©_addmul
(*
A
,

298 cÚ¡ * 
B
,

299 cÚ¡ * 
G
, cÚ¡ * 
H
,

300 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

301 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

302 cÚ¡ 
Vec
<> & 
P_r
,

303 cÚ¡ 
Vec
<> & 
Q_r
,

304 
shiá_P
, 
shiá_Q
,

305 
N1
, 
N2
,

306 
a
){

308 
m©_addmul_fá
(
A
, 
B
, 
G
, 
H
, 
P_´e
, 
Q_´e
, 
P_r
, 
Q_r
, 
shiá_P
, 
shiá_Q
, 
N1
, 
N2
, 
a
,‡);

315 
m©_submul
(*
A
,

316 cÚ¡ * 
B
,

317 cÚ¡ * 
G
, cÚ¡ * 
H
,

318 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

319 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

320 cÚ¡ 
Vec
<> & 
P_r
,

321 cÚ¡ 
Vec
<> & 
Q_r
,

322 
shiá_P
, 
shiá_Q
,

323 
N1
, 
N2
,

324 
a
){

326 
m©_submul_fá
(
A
, 
B
, 
G
, 
H
, 
P_´e
, 
Q_´e
, 
P_r
, 
Q_r
, 
shiá_P
, 
shiá_Q
, 
N1
, 
N2
, 
a
,‡);

333 
m©_addmul_t
(*
A
,

334 cÚ¡ * 
B
,

335 cÚ¡ * 
G
, cÚ¡ * 
H
,

336 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

337 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

338 cÚ¡ 
Vec
<> & 
P_r
,

339 cÚ¡ 
Vec
<> & 
Q_r
,

340 
shiá_P
, 
shiá_Q
,

341 
N1
, 
N2
,

342 
a
){

344 
m©_addmul_t_fá
(
A
, 
B
, 
G
, 
H
, 
P_´e
, 
Q_´e
, 
P_r
, 
Q_r
, 
shiá_P
, 
shiá_Q
, 
N1
, 
N2
, 
a
,‡);

351 
m©_submul_t
(*
A
,

352 cÚ¡ * 
B
,

353 cÚ¡ * 
G
, cÚ¡ * 
H
,

354 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

355 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

356 cÚ¡ 
Vec
<> & 
P_r
,

357 cÚ¡ 
Vec
<> & 
Q_r
,

358 
shiá_P
, 
shiá_Q
,

359 
N1
, 
N2
,

360 
a
){

362 
m©_submul_t_fá
(
A
, 
B
, 
G
, 
H
, 
P_´e
, 
Q_´e
, 
P_r
, 
Q_r
, 
shiá_P
, 
shiá_Q
, 
N1
, 
N2
, 
a
,‡);

368 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
M
, cÚ¡ Vec<zz_p>& 
šput
){

369 
	gN1
 = 
M
.
NumRows
();

370 
	gN2
 = 
M
.
NumCŞs
();

371 *
	gA
 = 
Ãw
 [
N1
];

372 *
	gB
 = 
Ãw
 [
N2
];

374 
	gi
 = 0; i < 
	gN2
; i++)

375 
	gB
[
i
] = 
»p
(
šput
[i]);

376 
	gi
 = 0; i < 
	gN1
; i++)

377 
	gA
[
i
] = 0;

379 
m©_addmul_fá
(
A
, 
B
, 
M
.
G
.
_vec__»p
, M.
H
._vec__»p, M.
C
.
P_´e
, M.C.
Qab_´e
, M.C.
P_r
, M.C.
Qab_r
, 0, 0, 
N1
, 
N2
, M.
AÍha
(), 1);

381 
	g»s
.
S‘L’gth
(
N1
);

382 
	gi
 = 0; i < 
	gN1
; i++)

383 
	g»s
[
i
].
LoİHŞe
(èğ
A
[i];

385 
	gd–‘e
[] 
	gA
;

386 
	gd–‘e
[] 
	gB
;

392 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
M
, cÚ¡ Vec<zz_p>& 
šput
){

393 
	gN1
 = 
M
.
NumRows
();

394 
	gN2
 = 
M
.
NumCŞs
();

395 *
	gA
 = 
Ãw
 [
N2
];

396 *
	gB
 = 
Ãw
 [
N1
];

398 
	gi
 = 0; i < 
	gN1
; i++)

399 
	gB
[
i
] = 
»p
(
šput
[i]);

400 
	gi
 = 0; i < 
	gN2
; i++)

401 
	gA
[
i
] = 0;

403 
m©_addmul_t_fá
(
A
, 
B
, 
M
.
H
.
_vec__»p
, M.
G
._vec__»p, M.
C
.
P_´e
, M.C.
Qab_´e
, M.C.
P_r
, M.C.
Qab_r
, 0, 0, 
N1
, 
N2
, M.
AÍha
(), 1);

405 
	g»s
.
S‘L’gth
(
N2
);

406 
	gi
 = 0; i < 
	gN2
; i++)

407 
	g»s
[
i
].
LoİHŞe
(èğ
A
[i];

409 
	gd–‘e
[] 
	gA
;

410 
	gd–‘e
[] 
	gB
;

	@cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_invert.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<NTL/m©_lzz_p.h
>

3 
	~<as£¹.h
>

5 
	~"vec_lzz_p_exŒa.h
"

6 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

8 
NTL_CLIENT


13 
g’”©e_g’”ic_¿nk_´ofe
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, 
rk
){

14 
	gn
 = 
G
.
NumRows
();

15 
	gm
 = 
H
.
NumRows
();

16 
	g®pha
 = 
G
.
NumCŞs
();

18 
	gi
 = 0; i < 
	grk
; i++)

19 
	gj
 = 0; j < 
	g®pha
; j++)

20 
	gG
[
i
][
j
] = 
¿ndom_zz_p
();

21 
	gi
 = 
rk
; i < 
	gn
; i++)

22 
	gj
 = 0; j < 
	g®pha
; j++)

23 
	gG
[
i
][
j
] = 0;

25 
	gi
 = 0; i < 
	grk
; i++)

26 
	gj
 = 0; j < 
	g®pha
; j++)

27 
	gH
[
i
][
j
] = 
¿ndom_zz_p
();

28 
	gi
 = 
rk
; i < 
	gm
; i++)

29 
	gj
 = 0; j < 
	g®pha
; j++)

30 
	gH
[
i
][
j
] = 0;

38 
g’”©e_nÚ_g’”ic_¿nk_´ofe
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, 
rk
, 
exŒa
){

39 
	g®pha
 = 
G
.
NumCŞs
();

41 ià(
	gexŒa
 <ğ
rk
){

42 
cout
 << 
rk
 << " " << 
exŒa
 << 
’dl
;

43 
E¼Ü
("Matrix will have generic„ank…rofile");

45 
g’”©e_g’”ic_¿nk_´ofe
(
G
, 
H
, 
rk
);

47 
	gj
 = 0; j < 
	g®pha
; j++){

48 
	gG
[
exŒa
][
j
] = 
¿ndom_zz_p
();

49 
	gH
[
exŒa
][
j
] = 
¿ndom_zz_p
();

60 
	$‹¡
(
i
, 
j
, 
®pha
, 
rk
, 
İt
){

62 ià(()
rk
 < 0 || (ìk > 
i
 || (ìk > 
j
){

63 
cout
 << "# " << 
i
 << " " << 
j
 << "‚othingo do\n";

67 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

68 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, 
j
);

69 
M©
<
zz_p
> 
A
, 
B
;

71 
A
.
	`S‘Dims
(
i
, 
®pha
);

72 
B
.
	`S‘Dims
(
j
, 
®pha
);

74 
ÿuchy_like_geom‘ric_¥ecŸl
 
M
, 
švM
;

75 
M©
<
zz_p
> 
Z
, 
švZ
;

76 
r
;

78 ià(
İt
 == 1){

80 ià(
Œue
) {

81 
	`g’”©e_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
);

82 
M
 = 
	`ÿuchy_like_geom‘ric_¥ecŸl
(
A
, 
B
, 
C
);

83 
	`to_d’£
(
Z
, 
M
);

84 
r
 = 
	`šv”t
(
švM
, 
M
);

85 
	`to_d’£
(
švZ
, 
švM
);

86 
M©
<
zz_p
> 
Z2
 = 
Z
;

87 
	`as£¹
 (
r
 =ğ
	`gauss
(
Z2
));

88 
M©
<
zz_p
> 
subZ
;

89 
subZ
.
	`S‘Dims
(
r
,„);

90 
u
 = 0; u < 
r
; u++)

91 
v
 = 0; v < 
r
; v++)

92 
subZ
[
u
][
v
] = 
Z
[u][v];

93 
subZ
 = subZ*
švZ
;

94 
	`as£¹
 (
	`IsId’t
(
subZ
, 
r
));

95 
cout
 << "# " << 
i
 << " " << 
j
 << " grp\n";

97 ià(()
rk
 < 
	`mš
(
i
, 
j
)-1) {

98 ià((()
rk
+5 < 
i
è&& ((ìk+5 < 
j
))

99 
	`g’”©e_nÚ_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
,„k + 5);

101 
	`g’”©e_nÚ_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
, 
	`mš
(
i
-1, 
j
-1));

102 
M
 = 
	`ÿuchy_like_geom‘ric_¥ecŸl
(
A
, 
B
, 
C
);

103 
	`to_d’£
(
Z
, 
M
);

104 
r
 = 
	`šv”t
(
švM
, 
M
);

105 
	`as£¹
 (
r
 == -1);

106 
cout
 << "# " << 
i
 << " " << 
j
 << "‚ot grp\n";

110 
cout
 << 
i
 << " ";

112 
t
;

114 
	`g’”©e_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
);

115 
M
 = 
	`ÿuchy_like_geom‘ric_¥ecŸl
(
A
, 
B
, 
C
);

116 
t
 = 
	`G‘Time
();

117 
j
 = 0; j < 10; j++)

118 
	`šv”t
(
švM
, 
M
);

119 
t
 = 
	`G‘Time
() -;

120 
cout
 << 
t
 << " ";

122 
cout
 << 
’dl
;

124 
	}
}

131 
	$check
(
İt
){

132 
zz_p
::
	`FFTIn™
(0);

134 
cout
 << "# " << 
zz_p
::
	`modulus
(è<< 
’dl
;

135 
i
 = 3; i < 200; i += 1){

136 
®pha
 = 4;

137 ià(
İt
 == 1){

138 
j
;

139 
j
 = 
i
-2;

140 
	`‹¡
(
i
, 
j
, 
®pha
, 5, 1);

141 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)/2, 1);

142 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)-7, 1);

143 
j
 = 
i
+2;

144 
	`‹¡
(
i
, 
j
, 
®pha
, 5, 1);

145 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)/2, 1);

146 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)-7, 1);

149 
	`‹¡
(
i
, i, 
®pha
, i, 0);

152 
	}
}

159 
	$maš
(
¬gc
, ** 
¬gv
){

160 
İt
 = 0;

161 ià(
¬gc
 > 1)

162 
İt
 = 
	`©oi
(
¬gv
[1]);

163 
	`check
(
İt
);

166 
	}
}

	@cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_invert_dac.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<NTL/m©_lzz_p.h
>

3 
	~<as£¹.h
>

5 
	~"vec_lzz_p_exŒa.h
"

6 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

8 
NTL_CLIENT


13 
g’”©e_g’”ic_¿nk_´ofe
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, 
rk
){

14 
	gn
 = 
G
.
NumRows
();

15 
	gm
 = 
H
.
NumRows
();

16 
	g®pha
 = 
G
.
NumCŞs
();

18 
	gi
 = 0; i < 
	grk
; i++)

19 
	gj
 = 0; j < 
	g®pha
; j++)

20 
	gG
[
i
][
j
] = 
¿ndom_zz_p
();

21 
	gi
 = 
rk
; i < 
	gn
; i++)

22 
	gj
 = 0; j < 
	g®pha
; j++)

23 
	gG
[
i
][
j
] = 0;

25 
	gi
 = 0; i < 
	grk
; i++)

26 
	gj
 = 0; j < 
	g®pha
; j++)

27 
	gH
[
i
][
j
] = 
¿ndom_zz_p
();

28 
	gi
 = 
rk
; i < 
	gm
; i++)

29 
	gj
 = 0; j < 
	g®pha
; j++)

30 
	gH
[
i
][
j
] = 0;

38 
g’”©e_nÚ_g’”ic_¿nk_´ofe
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, 
rk
, 
exŒa
){

39 
	g®pha
 = 
G
.
NumCŞs
();

41 ià(
	gexŒa
 <ğ
rk
){

42 
cout
 << 
rk
 << " " << 
exŒa
 << 
’dl
;

43 
E¼Ü
("Matrix will have generic„ank…rofile");

45 
g’”©e_g’”ic_¿nk_´ofe
(
G
, 
H
, 
rk
);

47 
	gj
 = 0; j < 
	g®pha
; j++){

48 
	gG
[
exŒa
][
j
] = 
¿ndom_zz_p
();

49 
	gH
[
exŒa
][
j
] = 
¿ndom_zz_p
();

60 
	$‹¡
(
i
, 
j
, 
®pha
, 
rk
, 
İt
){

62 ià(()
rk
 < 0 || (ìk > 
i
 || (ìk > 
j
){

63 
cout
 << "# " << 
i
 << " " << 
j
 << "‚othingo do\n";

67 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

68 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, 
j
);

69 
M©
<
zz_p
> 
A
, 
B
;

71 
A
.
	`S‘Dims
(
i
, 
®pha
);

72 
B
.
	`S‘Dims
(
j
, 
®pha
);

74 
ÿuchy_like_geom‘ric_¥ecŸl
 
M
, 
švM
;

75 
M©
<
zz_p
> 
Z
, 
švZ
;

76 
r
;

78 ià(
İt
 == 1){

80 ià(
Œue
) {

81 
	`g’”©e_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
);

82 
M
 = 
	`ÿuchy_like_geom‘ric_¥ecŸl
(
A
, 
B
, 
C
);

83 
	`to_d’£
(
Z
, 
M
);

84 
r
 = 
	`šv”t_ç¡
(
švM
, 
M
);

85 
	`to_d’£
(
švZ
, 
švM
);

86 
M©
<
zz_p
> 
Z2
 = 
Z
;

87 
	`as£¹
 (
r
 =ğ
	`gauss
(
Z2
));

88 
M©
<
zz_p
> 
subZ
;

89 
subZ
.
	`S‘Dims
(
r
,„);

90 
u
 = 0; u < 
r
; u++)

91 
v
 = 0; v < 
r
; v++)

92 
subZ
[
u
][
v
] = 
Z
[u][v];

93 
subZ
 = subZ*
švZ
;

94 
	`as£¹
 (
	`IsId’t
(
subZ
, 
r
));

95 
cout
 << "# " << 
i
 << " " << 
j
 << " grp\n";

97 ià(()
rk
 < 
	`mš
(
i
, 
j
)-1) {

98 ià((()
rk
+5 < 
i
è&& ((ìk+5 < 
j
))

99 
	`g’”©e_nÚ_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
,„k + 5);

101 
	`g’”©e_nÚ_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
, 
	`mš
(
i
-1, 
j
-1));

102 
M
 = 
	`ÿuchy_like_geom‘ric_¥ecŸl
(
A
, 
B
, 
C
);

103 
	`to_d’£
(
Z
, 
M
);

104 
r
 = 
	`šv”t_ç¡
(
švM
, 
M
);

105 
	`as£¹
 (
r
 == -1);

106 
cout
 << "# " << 
i
 << " " << 
j
 << "‚ot grp\n";

110 
cout
 << 
i
 << " ";

112 
t
;

114 
	`g’”©e_g’”ic_¿nk_´ofe
(
A
, 
B
, 
rk
);

115 
M
 = 
	`ÿuchy_like_geom‘ric_¥ecŸl
(
A
, 
B
, 
C
);

116 
t
 = 
	`G‘Time
();

117 
j
 = 0; j < 10; j++)

118 
	`šv”t
(
švM
, 
M
);

119 
t
 = 
	`G‘Time
() -;

120 
cout
 << 
t
 << " ";

122 
t
 = 
	`G‘Time
();

123 
j
 = 0; j < 10; j++)

124 
	`šv”t_ç¡
(
švM
, 
M
);

125 
t
 = 
	`G‘Time
() -;

126 
cout
 << 
t
 << " ";

128 
cout
 << 
’dl
;

130 
	}
}

137 
	$check
(
İt
){

138 
zz_p
::
	`FFTIn™
(0);

140 
cout
 << "# " << 
zz_p
::
	`modulus
(è<< 
’dl
;

141 
i
 = 100; i < 10000; i += 50){

142 
®pha
 = 4;

143 ià(
İt
 == 1){

144 
j
;

145 
j
 = 
i
-2;

146 
	`‹¡
(
i
, 
j
, 
®pha
, 5, 1);

147 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)/2, 1);

148 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)-7, 1);

149 
j
 = 
i
+2;

150 
	`‹¡
(
i
, 
j
, 
®pha
, 5, 1);

151 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)/2, 1);

152 
	`‹¡
(
i
, 
j
, 
®pha
, 
	`mš
(i,j)-7, 1);

155 
	`‹¡
(
i
, i, 
®pha
, i, 0);

158 
	}
}

165 
	$maš
(
¬gc
, ** 
¬gv
){

166 
İt
 = 0;

167 ià(
¬gc
 > 1)

168 
İt
 = 
	`©oi
(
¬gv
[1]);

169 
	`check
(
İt
);

172 
	}
}

	@cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_mul_left.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

14 
zz_p
::
	`FFTIn™
(0);

16 
i
 = 1; i < 10000; i += 1){

18 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

19 
j
 = 
i
+10;

20 
®pha
 = 4;

21 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, 
j
);

22 
m©_zz_p
 
A
, 
B
;

23 
	`¿ndom
(
A
, 
i
, 
®pha
);

24 
	`¿ndom
(
B
, 
j
, 
®pha
);

25 
ÿuchy_like_geom‘ric_¥ecŸl
 
	`M
(
A
, 
B
, 
C
);

26 
m©_zz_p
 
Z
;

28 
vec_zz_p
 
š
, 
out
;

29 
	`¿ndom
(
š
, 
i
);

31 ià(
İt
 == 1){

32 
vec_zz_p
 
out2
;

33 
	`mul_Ëá
(
out
, 
M
, 
š
);

34 
	`to_d’£
(
Z
, 
M
);

35 
	`mul
(
out2
, 
š
, 
Z
);

36 
	`as£¹
 (
out2
 =ğ
out
);

39 
cout
 << 
i
 << " ";

41 
t
;

43 
t
 = 
	`G‘Time
();

44 
j
 = 0; j < 10000; j++)

45 
	`mul_Ëá
(
out
, 
M
, 
š
);

46 
t
 = 
	`G‘Time
() -;

47 
cout
 << 
t
 << " ";

49 
cout
 << 
’dl
;

52 
	}
}

59 
	$maš
(
¬gc
, ** 
¬gv
){

61 #ifdeà
NTL_HAVE_AVX


62 
	#MAX_DBL_INT
 ((1L << 
NTL_DOUBLE_PRECISION
)-1)

	)

63 
cout
 << 
MAX_DBL_INT
 << 
’dl
;

67 
İt
 = 0;

68 ià(
¬gc
 > 1)

69 
İt
 = 
	`©oi
(
¬gv
[1]);

70 
	`check
(
İt
);

73 
	}
}

	@cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_mul_right.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

14 
zz_p
::
	`FFTIn™
(0);

16 
i
 = 1; i < 10000; i += 1){

18 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

19 
j
 = 
i
+10;

20 
®pha
 = 4;

21 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, 
j
);

22 
m©_zz_p
 
A
, 
B
;

23 
	`¿ndom
(
A
, 
i
, 
®pha
);

24 
	`¿ndom
(
B
, 
j
, 
®pha
);

25 
ÿuchy_like_geom‘ric_¥ecŸl
 
	`M
(
A
, 
B
, 
C
);

26 
m©_zz_p
 
Z
;

28 
vec_zz_p
 
š
, 
out
;

29 
	`¿ndom
(
š
, 
j
);

31 ià(
İt
 == 1){

32 
	`mul_right
(
out
, 
M
, 
š
);

33 
	`to_d’£
(
Z
, 
M
);

34 
vec_zz_p
 
out2
;

35 
	`mul
(
out2
, 
Z
, 
š
);

36 
	`as£¹
 (
out2
 =ğ
out
);

39 
cout
 << 
i
 << " ";

41 
t
;

43 
t
 = 
	`G‘Time
();

44 
j
 = 0; j < 10000; j++)

45 
	`mul_right
(
out
, 
M
, 
š
);

46 
t
 = 
	`G‘Time
() -;

47 
cout
 << 
t
 << " ";

49 
cout
 << 
’dl
;

52 
	}
}

59 
	$maš
(
¬gc
, ** 
¬gv
){

60 
İt
 = 0;

61 ià(
¬gc
 > 1)

62 
İt
 = 
	`©oi
(
¬gv
[1]);

63 
	`check
(
İt
);

66 
	}
}

	@cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_to_dense.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

14 
zz_p
::
	`FFTIn™
(0);

16 
i
 = 1; i < 10000; i += 1){

18 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

19 
j
 = 
i
+10;

20 
®pha
 = 4;

21 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, 
j
);

22 
m©_zz_p
 
A
, 
B
;

23 
	`¿ndom
(
A
, 
i
, 
®pha
);

24 
	`¿ndom
(
B
, 
j
, 
®pha
);

25 
ÿuchy_like_geom‘ric_¥ecŸl
 
	`M
(
A
, 
B
, 
C
);

26 
m©_zz_p
 
Z
;

29 ià(
İt
 == 1){

30 
	`to_d’£
(
Z
, 
M
);

31 
m©_zz_p
 
D1
, 
D2
;

32 
D1
.
	`S‘Dims
(
i
, i);

33 
k
 = 0; k < 
i
; k++)

34 
D1
[
k
][k] = 
	`pow”
(
a
, k);

35 
D2
.
	`S‘Dims
(
j
, j);

36 
k
 = 0; k < 
j
; k++)

37 
D2
[
k
][k] = 
	`pow”
(
a
, 
i
)*power(a, k);

38 
	`as£¹
 ((
D1
*
Z
-Z*
D2
è=ğ(
A
*
	`Œª¥o£
(
B
)));

41 
cout
 << 
i
 << " ";

43 
t
;

45 
t
 = 
	`G‘Time
();

46 
j
 = 0; j < 10000; j++)

47 
	`to_d’£
(
A
, 
M
);

48 
t
 = 
	`G‘Time
() -;

49 
cout
 << 
t
 << " ";

51 
cout
 << 
’dl
;

54 
	}
}

61 
	$maš
(
¬gc
, ** 
¬gv
){

62 
İt
 = 0;

63 ià(
¬gc
 > 1)

64 
İt
 = 
	`©oi
(
¬gv
[1]);

65 
	`check
(
İt
);

68 
	}
}

	@cauchy_like_geometric_special/test/test_init_cauchy_geometric_special.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i
 = 1; i < 10000; i += 1){

17 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

19 ià(
İt
 == 1){

20 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, i);

23 
cout
 << 
i
 << " ";

25 
t
;

27 
t
 = 
	`G‘Time
();

28 
j
 = 0; j < 10000; j++)

29 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, i);

30 
t
 = 
	`G‘Time
() -;

31 
cout
 << 
t
 << " ";

33 
cout
 << 
’dl
;

36 
	}
}

43 
	$maš
(
¬gc
, ** 
¬gv
){

44 
İt
 = 0;

45 ià(
¬gc
 > 1)

46 
İt
 = 
	`©oi
(
¬gv
[1]);

47 
	`check
(
İt
);

50 
	}
}

	@cauchy_like_geometric_special/test/test_init_cauchy_like_geometric_special.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

14 
zz_p
::
	`FFTIn™
(0);

16 
i
 = 1; i < 10000; i += 1){

18 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

19 
j
 = 
i
+10;

20 
®pha
 = 4;

21 
ÿuchy_geom‘ric_¥ecŸl
 
	`C
(
	`to_zz_p
(1), 
	`pow”
(
a
, 
i
),‡, i, 
j
);

22 
m©_zz_p
 
A
, 
B
;

23 
	`¿ndom
(
A
, 
i
, 
®pha
);

24 
	`¿ndom
(
B
, 
j
, 
®pha
);

26 ià(
İt
 == 1){

27 
ÿuchy_like_geom‘ric_¥ecŸl
 
	`M
(
A
, 
B
, 
C
);

30 
cout
 << 
i
 << " ";

32 
t
;

34 
t
 = 
	`G‘Time
();

35 
j
 = 0; j < 10000; j++)

36 
ÿuchy_like_geom‘ric_¥ecŸl
 
	`M
(
A
, 
B
, 
C
);

37 
t
 = 
	`G‘Time
() -;

38 
cout
 << 
t
 << " ";

40 
cout
 << 
’dl
;

43 
	}
}

50 
	$maš
(
¬gc
, ** 
¬gv
){

51 
İt
 = 0;

52 ià(
¬gc
 > 1)

53 
İt
 = 
	`©oi
(
¬gv
[1]);

54 
	`check
(
İt
);

57 
	}
}

	@hermite_pade/hermite_pade.h

1 #iâdeà
__h”m™e_·de_h__


2 
	#__h”m™e_·de_h__


	)

4 
	~"biv¬Ÿ‹moduÏrcomp.h
"

5 
	~<NTL/ZZ_pX.h
>

6 
	~<NTL/lzz_pX.h
>

7 
	~<NTL/toŞs.h
>

8 
	~<NTL/m©rix.h
>

9 
	~<NTL/veùÜ.h
>

10 
	~"mo§ic_hªk–.h
"

11 
	~"ZZ_pX_CRT.h
"

12 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

14 şas 
	ch”m™e_·de
{

15 
	mVec
<
	mBiv¬Ÿ‹ModuÏrComp
> 
	mvec_M
;

16 
ÿuchy_like_geom‘ric_¥ecŸl
 
	mšvM
;

17 
	mVec
<
	mZZ_p
> 
	me
, 
	mf
;

18 
	mVec
<
	mZZ_pX_MuÉošt_FFT
> 
	mvec_X_št
, 
	mvec_Y_št
;

19 
Biv¬Ÿ‹ModuÏrComp
 *
	mM
;

20 
ZZ_pX_MuÉošt_FFT
 *
	mX_št
, *
	mY_št
;

21 
ZZX
 
	mf_fuÎ_´ec
;

22 
	mVec
<> 
	mty³
;

23 
	m¿nk
;

27 
	mpublic
:

32 
h”m™e_·de
(cÚ¡ 
ZZX
 &
f
, cÚ¡ 
Vec
<>& 
ty³
);

35 
g‘_¿nd_sŞ
(
Vec
<
ZZ
> &);

	@hermite_pade/src/hermite_pade.cpp

1 
	~"h”m™e_·de.h
"

3 
	gh”m™e_·de
::
h”m™e_·de
(cÚ¡ 
ZZX
 &
f
, cÚ¡ 
Vec
<>& 
ty³
){

4 
	g´ec
 = 
deg
(
f
) + 1;

5 
	gf_fuÎ_´ec
 = 
f
;

6 
	gthis
->
	gty³
 = 
ty³
;

7 
zz_pX
 
	gf_f›ld
;

8 
cÚv
(
f_f›ld
, 
f
);

11 
	gVec
<
	ghªk–
> 
	gvec_H
;

12 
zz_pX
 
	gruÂšg
 {1};

13 
	gi
 = 0; i < 
	gty³
.
Ëngth
(); i++){

14 
	gVec
<
	gzz_p
> 
	gv
;

15 
	gVec
<
	gzz_p
> 
	gšp_vec
;

16 
cÚv
(
v
,
ruÂšg
);

17 
	gv
.
S‘L’gth
(
´ec
, 
zz_p
{0});

18 
	gj
 = 0; j < 
	gv
.
Ëngth
(); j++)

19 
	gšp_vec
.
­³nd
(
v
[v.
Ëngth
(è- 1 - 
j
]);

20 
	gj
 = 0; j < 
	gty³
[
i
]; j++)

21 
	gšp_vec
.
­³nd
(
zz_p
{0});

22 
	gvec_H
.
­³nd
(
hªk–
(
šp_vec
,
´ec
,
ty³
[
i
]+1));

23 
	gruÂšg
 = 
ruÂšg
 * 
f_f›ld
;

25 
	gVec
<Vec<
	ghªk–
>> 
	ghªk–_m©riûs
;

26 
	ghªk–_m©riûs
.
­³nd
(
vec_H
);

27 
mo§ic_hªk–
 
MH
(
hªk–_m©riûs
);

30 
ÿuchy_like_geom‘ric_¥ecŸl
 
	gCL
;

31 
zz_pX_MuÉošt_Geom‘ric
 
	gX_št
, 
	gY_št
;

32 
	gVec
<
	gzz_p
> 
	ge_zz_p
, 
	gf_zz_p
;

33 
to_ÿuchy_g½
(
CL
, 
X_št
, 
Y_št
, 
e_zz_p
, 
f_zz_p
, 
MH
);

34 
	g¿nk
 = 
šv”t_ç¡
(
švM
,
CL
);

37 
ZZ_pX
 
	gf_ZZ_pX
;

38 
cÚv
(
f_ZZ_pX
, 
f
);

39 
Biv¬Ÿ‹ModuÏrComp
 
M
(
f_ZZ_pX
, 
ty³
, 
¿nk
);

42 
	gvec_M
.
­³nd
(
M
);

43 
	gVec
<
	gZZ
> 
	ge_ZZ
, 
	gf_ZZ
;

44 
cÚv
(
e_ZZ
, 
e_zz_p
);

45 
cÚv
(
f_ZZ
, 
f_zz_p
);

46 
cÚv
(
this
->
e
, 
e_ZZ
);

47 
cÚv
(
this
->
f
, 
f_ZZ
);

	@include/ZZXY.h

1 #iâdeà
ZZXY__H


2 
	#ZZXY__H


	)

4 
	~<f¡»am
>

5 
	~<io¡»am
>

6 
	~<¡ršg.h
>

8 
	~<NTL/ZZX.h
>

9 
	~<NTL/veùÜ.h
>

11 
NTL_CLIENT


22 şas 
	cZZXY
{

23 
	mpublic
:

24 
Vec
<
ZZX
> 
cÛffX
;

29 
	$tdeg
() const;

33 
	$degY
() const;

37 
	$degX
() const;

44 
	`nÜm®ize
();

46 
	$ZZXY
(){}

51 
	`ZZXY
(cÚ¡ 
Vec
<
ZZX
> & 
cÛff
){

52 
cÛffX
 = 
cÛff
;

53 
	`nÜm®ize
();

54 
	}
}

61 
»ad_äom_fe
(cÚ¡ 
¡ršg
& 
f’ame
);

63 ~
	$ZZXY
(){
	}
}

69 
	gi¡»am
& 
	gİ”©Ü
>>(i¡»am& 
	gs
, 
	gZZXY
& 
	gx
);

70 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gs
, cÚ¡ 
	gZZXY
& 
	ga
);

75 
magma_š™_bi_QQ
();

80 
magma_ouut
(cÚ¡ 
ZZXY
 & 
a
);

85 
magma_assign
(cÚ¡ 
ZZXY
 & 
a
, cÚ¡ 
¡ršg
 & 
Çme
);

90 
diffY
(
ZZXY
 & 
dyF
, cÚ¡ ZZXY & 
F
);

99 
	sZZ_biv¬Ÿ‹_»guÏr_chaš
{

100 
ZZX
 
	mT1
;

101 
ZZXY
 
	mT2
;

107 
magma_ouut
(cÚ¡ 
ZZ_biv¬Ÿ‹_»guÏr_chaš
& 
T
);

112 
magma_assign
(cÚ¡ 
ZZ_biv¬Ÿ‹_»guÏr_chaš
& 
T
, cÚ¡ 
¡ršg
& 
Çme
);

117 
magma_ouut
(cÚ¡ 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
>& 
T
);

122 
magma_assign
(cÚ¡ 
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
>& 
T
, cÚ¡ 
¡ršg
& 
Çme
);

131 
sŞve
(
Vec
<
ZZ_biv¬Ÿ‹_»guÏr_chaš
> & 
sŞs
, cÚ¡ 
ZZXY
 & 
FZ
, cÚ¡ ZZXY & 
GZ
);

	@include/ZZ_CRT.h

1 #iâdeà
ZZ_CRT__H


2 
	#ZZ_CRT__H


	)

4 
	~<NTL/¥_¬™h.h
>

5 
	~<NTL/veùÜ.h
>

6 
	~<NTL/m©rix.h
>

7 
	~<NTL/ZZ.h
>

8 
	~<gmp.h
>

10 
NTL_CLIENT


30 
ä“_vec_gbigšt
(
Vec
<
_Ál_gbigšt
>& 
v
);

35 
z”o_vec_gbigšt
(
Vec
<
_Ál_gbigšt
>& 
v
);

47 şas 
	cZZ_CRT_»m
 {

48 
	mpublic
:

49 
n
;

50 
ZZ
 
	mp
;

51 
vœtu®
 
ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
) = 0;

53 
	m´Ùeùed
:

55 
Vec
<> 
moduli
;

63 şas 
	cZZ_CRT_»m_tbl
 : 
public
 
ZZ_CRT_»m
 {

64 
public
:

65 
	$ZZ_CRT_»m_tbl
(){}

66 
	`ZZ_CRT_»m_tbl
(cÚ¡ 
Vec
<>& 
moduli
);

67 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

69 
´Ùeùed
:

70 
Vec
<
mp_limb_t
> 
šv_moduli
;

71 
M©
<
mp_limb_t
> 
tbl
;

72 
	}
};

78 şas 
	cZZ_CRT_»m_ç¡
 : 
public
 
ZZ_CRT_»m
 {

79 
public
:

80 
	$ZZ_CRT_»m_ç¡
(){}

81 
	`ZZ_CRT_»m_ç¡
(cÚ¡ 
Vec
<>& 
moduli
);

82 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

84 ~
	$ZZ_CRT_»m_ç¡
(){

85 
	`ä“_vec_gbigšt
(
´od_vec
);

86 
	`ä“_vec_gbigšt
(
»m_vec
);

87 
	}
}

89 
	g´Ùeùed
:

90 
Ëv–s
;

91 
	gvec_Ën
;

92 
	gVec
<> 
	gšdex_vec
;

93 
	gVec
<
	g_Ál_gbigšt
> 
	g´od_vec
;

94 
	gVec
<
	g_Ál_gbigšt
> 
	g»m_vec
;

95 
	gp_size
;

101 şas 
	cZZ_CRT_»m_medium
 : 
public
 
ZZ_CRT_»m
 {

102 
public
:

103 
	$ZZ_CRT_»m_medium
(){}

104 
	`ZZ_CRT_»m_medium
(cÚ¡ 
Vec
<>& 
moduli
);

105 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

107 ~
	$ZZ_CRT_»m_medium
(){

108 
	`ä“_vec_gbigšt
(
´od_vec
);

109 
	`ä“_vec_gbigšt
(
»m_vec
);

110 
	}
}

112 
	g´Ùeùed
:

113 
Ëv–s
;

114 
	gvec_Ën
;

115 
	gVec
<> 
	gšdex_vec
;

116 
	gVec
<> 
	gËn_vec
, 
	gcÜr_vec
;

117 
	gVec
<
	gmulmod_´ecÚ_t
> 
	gcÜ¿ux_vec
;

118 
	gVec
<
	gmp_limb_t
> 
	gšv_vec
;

119 
	gVec
<
	g_Ál_gbigšt
> 
	g´od_vec
;

120 
	gVec
<
	g_Ál_gbigšt
> 
	g»m_vec
;

127 şas 
	cZZ_CRT_»m_basic
 : 
public
 
ZZ_CRT_»m
 {

128 
public
:

129 
	$ZZ_CRT_»m_basic
(){}

130 
	`ZZ_CRT_»m_basic
(cÚ¡ 
Vec
<>& 
moduli
);

131 
	`ev®
(
Vec
<>& 
x_vec
, cÚ¡ 
ZZ
& 
a_ZZ
);

132 
	}
};

144 şas 
	cZZ_CRT_üt
{

145 
	mpublic
:

146 
vœtu®
 
üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
) = 0;

148 
	m´Ùeùed
:

149 
n
;

150 
ZZ
 
	mp
;

151 
	mVec
<> 
	mmoduli
;

152 
	mVec
<> 
	mmoduli_»c
;

153 
	mVec
<> 
	mu
;

154 
	mVec
<
	mmulmod_´ecÚ_t
> 
	muqšv
;

155 
ZZ_ReduûSŒuùAd­‹r
 
	m»duû_¡ruù
;

157 
make
();

158 
´emuÉly
(
Vec
<>& 
b
, cÚ¡ Vec<>& 
a
);

159 
vœtu®
 
š£¹
(
i
, 
_Ál_gbigšt
 
m
) = 0;

167 şas 
	cZZ_CRT_üt_tbl
 : 
public
 
ZZ_CRT_üt
 {

168 
public
:

169 
	$ZZ_CRT_üt_tbl
(){}

170 
	`ZZ_CRT_üt_tbl
(cÚ¡ 
Vec
<>& 
moduli
);

171 
	`üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
);

173 
´iv©e
:

174 
Vec
<Vec<
mp_limb_t
>> 
v
;

175 
sz
;

176 
	`š£¹
(
i
, 
_Ál_gbigšt
 
m
);

177 
	}
};

183 şas 
	cZZ_CRT_üt_ç¡
 : 
public
 
ZZ_CRT_üt
 {

184 
public
:

185 
	$ZZ_CRT_üt_ç¡
(){}

186 
	`ZZ_CRT_üt_ç¡
(cÚ¡ 
Vec
<>& 
moduli
);

187 
	`üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
);

189 ~
	$ZZ_CRT_üt_ç¡
(){

190 
	`ä“_vec_gbigšt
(
´od_vec
);

191 
	`ä“_vec_gbigšt
(
cÛff_vec
);

192 
	`ä“_vec_gbigšt
(
»m_vec
);

193 
	`ä“_vec_gbigšt
(
‹mps
);

194 
	}
}

196 
	g´iv©e
:

197 
Ëv–s
;

198 
	gvec_Ën
;

199 
	gVec
<> 
	gšv_vec
;

200 
	gVec
<> 
	gšdex_vec
;

201 
	gVec
<
	g_Ál_gbigšt
> 
	g´od_vec
;

202 
	gVec
<
	g_Ál_gbigšt
> 
	gcÛff_vec
;

203 
	gVec
<
	g_Ál_gbigšt
> 
	g»m_vec
;

204 
	gVec
<
	g_Ál_gbigšt
> 
	g‹mps
;

205 
	gVec
<> 
	gv®_vec
;

207 
š£¹
(
i
, 
_Ál_gbigšt
 
m
);

214 şas 
	cZZ_CRT_üt_basic
 : 
public
 
ZZ_CRT_üt
 {

215 
public
:

216 
	$ZZ_CRT_üt_basic
(){}

217 
	`ZZ_CRT_üt_basic
(cÚ¡ 
Vec
<>& 
moduli
);

218 
	`üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
b
);

220 ~
	$ZZ_CRT_üt_basic
(){

221 
	`ä“_vec_gbigšt
(
v
);

222 
	}
}

224 
	g´iv©e
:

225 
Vec
<
_Ál_gbigšt
> 
v
;

226 
	gsbuf
;

228 
š£¹
(
i
, 
_Ál_gbigšt
 
m
);

237 şas 
	cZZ_CRT
 {

238 
	mpublic
:

239 
ZZ_CRT
(cÚ¡ 
Vec
<>& 
moduli
);

241 
ev®
(
Vec
<>& 
x
, cÚ¡ 
ZZ
& 
a
){

242 
	m»m_¡ruù
->
ev®
(
x
, 
a
);

245 
üt
(
ZZ
& 
a
, cÚ¡ 
Vec
<>& 
x
){

246 
	güt_¡ruù
->
üt
(
a
, 
x
);

250 
ZZ_CRT_üt
* 
	güt_¡ruù
;

251 
ZZ_CRT_»m
* 
	g»m_¡ruù
;

253 
ZZ_CRT_»m_tbl
 
	g»m_tbl
;

254 
ZZ_CRT_»m_ç¡
 
	g»m_ç¡
;

255 
ZZ_CRT_»m_medium
 
	g»m_medium
;

256 
ZZ_CRT_»m_basic
 
	g»m_basic
;

258 #ià((
defšed
(
NTL_VIABLE_LL
)è&& (defšed(
NTL_CRT_ALTCODE
))è|| ((defšed(NTL_VIABLE_LL)è&& (
	$defšed
(
NTL_CRT_ALTCODE_SMALL
)))

259 
ZZ_CRT_üt_tbl
 
üt_tbl
;

261 
ZZ_CRT_üt_ç¡
 
üt_ç¡
;

262 
ZZ_CRT_üt_basic
 
üt_basic
;

267 
	`bud_»m_¡ruù
(cÚ¡ 
Vec
<>& 
moduli
);

268 
	`bud_üt_¡ruù
(cÚ¡ 
Vec
<>& 
moduli
);

269 
	}
};

	@include/ZZ_pX_CRT.h

1 #iâdeà
ZZ_PX_CRT__H


2 
	#ZZ_PX_CRT__H


	)

4 
	~<NTL/ZZ_pX.h
>

5 
	~<NTL/veùÜ.h
>

6 
	~<NTL/m©rix.h
>

8 
NTL_CLIENT


23 şas 
	cZZ_pX_MuÉošt
{

24 
	mpublic
:

29 
vœtu®
 
ev®u©e
(
Vec
<
ZZ_p
>& 
v®
, cÚ¡ 
ZZ_pX
& 
f
) const = 0;

30 
vœtu®
 
š‹½Ş©e
(
ZZ_pX
& 
f
, cÚ¡ 
Vec
<
ZZ_p
>& 
v®
) const = 0;

35 
	$Ëngth
() const{

36  
n
;

43 
n
;

44 
	}
};

53 şas 
	cZZ_pX_MuÉošt_FFT
 : 
public
 
ZZ_pX_MuÉošt
{

54 
public
:

56 
	$ZZ_pX_MuÉošt_FFT
(){}

59 
	`ZZ_pX_MuÉošt_FFT
(cÚ¡ 
ZZ_p
 & 
w
, 
n
);

62 
	`ZZ_pX_MuÉošt_FFT
(cÚ¡ 
ZZ_p
 & 
w
, cÚ¡ ZZ_°& 
c
, 
n
);

67 
	`ev®u©e
(
Vec
<
ZZ_p
>& 
v®
, cÚ¡ 
ZZ_pX
& 
f
) const;

69 
	`š‹½Ş©e
(
ZZ_pX
& 
f
, cÚ¡ 
Vec
<
ZZ_p
>& 
v®
) const{

70 
	`LogicE¼Ü
("inverse TFT‚ot implemented");

71 
	}
}

73 ~
	$ZZ_pX_MuÉošt_FFT
(){
	}
};

75 
	g´iv©e
:

76 
k
, 
	gmax_n
;

77 
	gVec
<Vec<
	gZZ_p
>> 
	gpow”sW
;

78 
	gVec
<
	gZZ_p
> 
	gpow”sC
, 
	gšv_pow”sC
;

79 
	gVec
<> 
	g»v
;

86 
fšd_roÙ_of_un™y
(
p
, 
s
);

92 
liá_roÙ_of_un™y
(
ZZ
& 
Omega
, 
omega
, 
s
, 
p
, 
k
);

	@include/bivariatemodularcomp.h

1 #iâdeà
__BIVARIATEMODULARCOMP_H__


2 
	#__BIVARIATEMODULARCOMP_H__


	)

3 
	~<NTL/ZZX.h
>

4 
	~<NTL/ZZ_pX.h
>

5 
	~<NTL/ZZ_p.h
>

6 
	~<NTL/veùÜ.h
>

7 
	~<NTL/m©rix.h
>

9 şas 
	cBiv¬Ÿ‹ModuÏrComp
 {

10 
	mNTL
::
ZZ_pX
 
f_f›ld
;

11 
	mNTL
::
ZZ_pX
 
F_f›ld
;

12 
	mNTL
::
Vec
<> 
ty³
;

13 
	mNTL
::
M©
<
NTL
::
ZZ_pX
> 
B
;

14 
	m´ec
;

15 
	msq¹P
;

16 
boŞ
 
	mš™Ÿlized
 = 
çl£
;

23 
	mNTL
::
Vec
<
NTL
::
ZZ_pX
> 
ü—‹_lhs_li¡
 (cÚ¡ NTL::Vec<NTL::
ZZ_p
>&);

26 
ü—‹_lhs_m©rix
 (
NTL
::
M©
<NTL::
ZZ_pX
>&,cÚ¡ NTL::
Vec
<NTL::ZZ_pX>&);

29 
ü—‹_rhs_m©rix
 (
NTL
::
M©
<NTL::
ZZ_pX
>&,cÚ¡ NTL::
Vec
<NTL::ZZ_pX>&);

31 
de¦iû
 (
NTL
::
M©
<NTL::
ZZ_pX
>&,const NTL::Mat<NTL::ZZ_pX> &);

33 
	mpublic
:

35 
Biv¬Ÿ‹ModuÏrComp
(cÚ¡ 
NTL
::
ZZ_pX
& 
f
, cÚ¡ NTL::
Vec
<> &
ty³
, 
´ec
);

38 
Biv¬Ÿ‹ModuÏrComp
(cÚ¡ 
NTL
::
Vec
<NTL::
ZZ_pX
> &
fs
, cÚ¡ NTL::Vec<> &
ty³
, 
´ec
);

41 
Biv¬Ÿ‹ModuÏrComp
();

44 
š™
(cÚ¡ 
NTL
::
ZZ_pX
& 
f
, cÚ¡ NTL::
Vec
<> &
ty³
, 
´ec
);

48 
š™
 (cÚ¡ 
NTL
::
Vec
<NTL::
ZZ_pX
>& 
fs
, cÚ¡ NTL::Vec<> &
ty³
, 
´ec
);

52 
	mNTL
::
Vec
<
NTL
::
ZZ_p
> 
muÉ_HÜÃrs
(cÚ¡ NTL::Vec<NTL::ZZ_p> &
rhs
);

55 
	mNTL
::
Vec
<
NTL
::
ZZ_p
> 
muÉ
 (cÚ¡ NTL::Vec<NTL::ZZ_p> &
rhs
);

	@include/cauchy_geometric_special.h

1 #iâdeà
__CAUCHY_GEOMETRIC_SPECIAL_H


2 
	#__CAUCHY_GEOMETRIC_SPECIAL_H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/m©_lzz_p.h
>

7 
	#THRESHOLD
 100

	)

9 
NTL_CLIENT


17 şas 
	cÿuchy_geom‘ric_¥ecŸl
{

19 
	mpublic
:

20 
zz_p
 
a
, 
	mb
, 
	mq
;

21 
	mn
, 
	mm
;

29 
	mVec
<
	mmulmod_´ecÚ_t
> 
	mP_´e
, 
	mQab_´e
, 
	mQa_´e
, 
	mQb_´e
;

30 
	mVec
<> 
	mP_r
, 
	mQab_r
, 
	mQa_r
, 
	mQb_r
;

35 
	$ÿuchy_geom‘ric_¥ecŸl
(){}

41 
	`ÿuchy_geom‘ric_¥ecŸl
(cÚ¡ 
zz_p
& 
a
, cÚ¡ zz_p& 
b
, cÚ¡ zz_p& 
q
, cÚ¡ 
n
, cÚ¡ 
m
);

42 
	}
};

47 
bud
(
ÿuchy_geom‘ric_¥ecŸl
& 
C
,

48 cÚ¡ 
zz_p
& 
a
, cÚ¡ zz_p& 
b
, cÚ¡ zz_p& 
q
, 
n
, 
m
);

57 şas 
	cÿuchy_like_geom‘ric_¥ecŸl
{

59 
	mpublic
:

60 
n
, 
	mm
;

61 
	m®pha
;

63 
	mVec
<> 
	mG
, 
	mH
;

65 
ÿuchy_geom‘ric_¥ecŸl
 
	mC
;

67 
	$NumRows
() const {

68  
n
;

71 
	$NumCŞs
() const {

72  
m
;

73 
	}
}

75 
	$AÍha
() const {

76  
®pha
;

77 
	}
}

82 
	$ÿuchy_like_geom‘ric_¥ecŸl
(){
	}
}

87 
	$ÿuchy_like_geom‘ric_¥ecŸl
(cÚ¡ 
m©_zz_p
& 
G_š
, cÚ¡ m©_zz_p& 
H_š
, cÚ¡ 
ÿuchy_geom‘ric_¥ecŸl
& 
C
){

88 
this
->
C
 = C;

89 
n
 = 
G_š
.
	`NumRows
();

90 
m
 = 
H_š
.
	`NumRows
();

91 
®pha
 = 
G_š
.
	`NumCŞs
();

93 
G
.
	`S‘L’gth
(
n
*
®pha
);

94 
H
.
	`S‘L’gth
(
m
*
®pha
);

96 
idx
;

97 
idx
 = 0;

98 
i
 = 0; i < 
n
; i++)

99 
j
 = 0; j < 
®pha
; j++)

100 
G
[
idx
++] = 
	`»p
(
G_š
[
i
][
j
]);

101 
idx
 = 0;

102 
i
 = 0; i < 
m
; i++)

103 
j
 = 0; j < 
®pha
; j++)

104 
H
[
idx
++] = 
	`»p
(
H_š
[
i
][
j
]);

105 
	}
}

107 ~
	$ÿuchy_like_geom‘ric_¥ecŸl
(){
	}
}

113 
to_d’£
(
m©_zz_p
& 
A
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
);

119 
šv”t
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
Cšv
,

120 cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
);

127 
šv”t_ç¡
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
Cšv
,

128 cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
, cÚ¡ 
th»sh
 = -1);

133 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

138 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
ÿuchy_like_geom‘ric_¥ecŸl
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

144 
m©_addmul
(*
A
,

145 cÚ¡ * 
B
,

146 cÚ¡ * 
G
, cÚ¡ * 
H
,

147 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

148 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

149 cÚ¡ 
Vec
<> & 
P_r
,

150 cÚ¡ 
Vec
<> & 
Q_r
,

151 
shiá_P
, 
shiá_Q
,

152 
N1
, 
N2
,

153 
a
);

159 
m©_submul
(*
A
,

160 cÚ¡ * 
B
,

161 cÚ¡ * 
G
, cÚ¡ * 
H
,

162 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

163 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

164 cÚ¡ 
Vec
<> & 
P_r
,

165 cÚ¡ 
Vec
<> & 
Q_r
,

166 
shiá_P
, 
shiá_Q
,

167 
N1
, 
N2
,

168 
a
);

174 
m©_addmul_t
(*
A
,

175 cÚ¡ * 
B
,

176 cÚ¡ * 
G
, cÚ¡ * 
H
,

177 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

178 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

179 cÚ¡ 
Vec
<> & 
P_r
,

180 cÚ¡ 
Vec
<> & 
Q_r
,

181 
shiá_P
, 
shiá_Q
,

182 
N1
, 
N2
,

183 
a
);

189 
m©_submul_t
(*
A
,

190 cÚ¡ * 
B
,

191 cÚ¡ * 
G
, cÚ¡ * 
H
,

192 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
P_´e
,

193 cÚ¡ 
Vec
<
mulmod_´ecÚ_t
> & 
Q_´e
,

194 cÚ¡ 
Vec
<> & 
P_r
,

195 cÚ¡ 
Vec
<> & 
Q_r
,

196 
shiá_P
, 
shiá_Q
,

197 
N1
, 
N2
,

198 
a
);

	@include/hermite_pade.h

1 #iâdeà
__h”m™e_·de_h__


2 
	#__h”m™e_·de_h__


	)

4 
	~"biv¬Ÿ‹moduÏrcomp.h
"

5 
	~<NTL/ZZ_pX.h
>

6 
	~<NTL/lzz_pX.h
>

7 
	~<NTL/toŞs.h
>

8 
	~<NTL/m©rix.h
>

9 
	~<NTL/veùÜ.h
>

10 
	~"mo§ic_hªk–.h
"

11 
	~"ZZ_pX_CRT.h
"

12 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

14 şas 
	ch”m™e_·de
{

15 
	mVec
<
	mBiv¬Ÿ‹ModuÏrComp
> 
	mvec_M
;

16 
ÿuchy_like_geom‘ric_¥ecŸl
 
	mšvM
;

17 
	mVec
<
	mZZ_p
> 
	me
, 
	mf
;

18 
	mVec
<
	mZZ_pX_MuÉošt_FFT
> 
	mvec_X_št
, 
	mvec_Y_št
;

19 
Biv¬Ÿ‹ModuÏrComp
 *
	mM
;

20 
ZZ_pX_MuÉošt_FFT
 *
	mX_št
, *
	mY_št
;

21 
ZZX
 
	mf_fuÎ_´ec
;

22 
	mVec
<> 
	mty³
;

23 
	m¿nk
;

27 
	mpublic
:

32 
h”m™e_·de
(cÚ¡ 
ZZX
 &
f
, cÚ¡ 
Vec
<>& 
ty³
);

35 
g‘_¿nd_sŞ
(
Vec
<
ZZ
> &);

	@include/lzz_pEX_augmented.h

1 #iâdeà
LZZ_PX_AUGMENTED__H


2 
	#LZZ_PX_AUGMENTED__H


	)

4 
	~<f¡»am
>

5 
	~<io¡»am
>

6 
	~<s¡»am
>

7 
	~<¡ršg.h
>

8 
	~<®gÜ™hm
>

10 
	~<NTL/ZZX.h
>

11 
	~<NTL/lzz_pX.h
>

12 
	~<NTL/lzz_pEX.h
>

13 
	~<NTL/veùÜ.h
>

15 
	~"lzz_pX_CRT.h
"

17 
NTL_CLIENT


26 
¥l™
(
zz_pX
 & 
mod_z”o
, zz_pX & 
mod_un™
, zz_pX & 
šv”£
, cÚ¡ zz_pX & 
–t
, cÚ¡ zz_pX & 
modulus
);

37 
¥l™_fÜ_»guÏrize
(
Vec
<
zz_pX
> & 
çùÜ_modulus
, cÚ¡ Vec<zz_pX> & 
–ts
, cÚ¡ zz_pX & 
modulus
);

46 şas 
	czz_pEX_augm’‹d
{

47 
	mpublic
:

48 
zz_pX
 
T1X
;

49 
zz_pECÚ‹xt
 
	mT1
;

50 
zz_pEX
 
	mT2
;

52 
	$zz_pEX_augm’‹d
(){}

54 
	$zz_pEX_augm’‹d
(cÚ¡ 
zz_pEX
 & 
t2
){

55 
T1X
 = 
zz_pE
::
	`modulus
();

56 
T1
 = 
	`zz_pECÚ‹xt
(
T1X
);

57 
T2
 = 
t2
;

58 
	}
}

60 
	$zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
zz_pXY
 & 
t2
){

61 
T1X
 = 
t1
;

62 
T1
 = 
	`zz_pECÚ‹xt
(
t1
);

63 
zz_pEPush
 
	`push
(
T1
);

64 
	`cÚv
(
T2
, 
t2
);

65 
	}
}

67 
zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
Vec
<zz_pX> & 
t2
){

68 
	gT1X
 = 
t1
;

69 
	gT1
 = 
zz_pECÚ‹xt
(
t1
);

70 
zz_pEPush
 
push
(
T1
);

72 
	gVec
<
	gzz_pE
> 
	gt2E
;

73 
cÚv
(
t2E
, 
t2
);

74 
cÚv
(
T2
, 
t2E
);

77 ~
	$zz_pEX_augm’‹d
(){
	}
}

83 
magma_ouuts
(cÚ¡ 
zz_pEX_augm’‹d
 & 
F
);

88 
magma_assign
(cÚ¡ 
zz_pEX_augm’‹d
 & 
F
, cÚ¡ 
¡ršg
 & 
Çme
);

93 
¿ndom_mÚic_zz_pEX_augm’‹d
(
zz_pEX_augm’‹d
 & 
»s
, 
dX
, 
dY
);

98 
mod
(
zz_pEX_augm’‹d
 & 
»duûd
, cÚ¡ zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX
 & 
Ãw_mod
);

103 
muÉimod
(
Vec
<
zz_pEX_augm’‹d
> & 
»duûd
, cÚ¡ zz_pEX_augm’‹d & 
F
, cÚ¡ 
zz_pX_CRT
 & 
Ãw_mod
);

109 
combše
(
zz_pEX_augm’‹d
 & 
»suÉ
, cÚ¡ 
Vec
<zz_pEX_augm’‹d> & 
»ms
);

114 
make_mÚic_ªd_¥l™
(
Vec
<
zz_pEX_augm’‹d
> & 
mÚic_F
, cÚ¡ zz_pEX_augm’‹d & 
F
);

120 
squ¬eä“
(
Vec
<
zz_pEX_augm’‹d
> & 
sqä“
, cÚ¡ zz_pEX_augm’‹d & 
f
);

126 
squ¬eä“
(
Vec
<
zz_pEX_augm’‹d
> & 
sqä“
, cÚ¡ Vec<zz_pEX_augm’‹d> & 
f
);

132 
sŞve
(
Vec
<
zz_pEX_augm’‹d
> & 
sŞs
, cÚ¡ 
zz_pXY
 & 
f
, cÚ¡ zz_pXY & 
g
);

140 şas 
	c·œ_zz_pEX_augm’‹d
{

141 
	mpublic
:

142 
zz_pX
 
T1X
;

143 
zz_pECÚ‹xt
 
	mT1
;

144 
zz_pEX
 
	mT20
, 
	mT21
;

146 
	$·œ_zz_pEX_augm’‹d
(){}

148 
	$·œ_zz_pEX_augm’‹d
(cÚ¡ 
zz_pEX
 & 
t2_0
, cÚ¡ zz_pEX & 
t2_1
){

149 
T1X
 = 
zz_pE
::
	`modulus
();

150 
T1
 = 
	`zz_pECÚ‹xt
(
T1X
);

151 
T20
 = 
t2_0
;

152 
T21
 = 
t2_1
;

153 
	}
}

155 
	$·œ_zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
zz_pXY
 & 
t2_0
, cÚ¡ zz_pXY & 
t2_1
){

156 
T1X
 = 
t1
;

157 
T1
 = 
	`zz_pECÚ‹xt
(
t1
);

158 
zz_pEPush
 
	`push
(
T1
);

159 
	`cÚv
(
T20
, 
t2_0
);

160 
	`cÚv
(
T21
, 
t2_1
);

161 
	}
}

163 
·œ_zz_pEX_augm’‹d
(cÚ¡ 
zz_pX
 & 
t1
, cÚ¡ 
Vec
<zz_pX> & 
t2_0
, cÚ¡ Vec<zz_pX> & 
t2_1
){

164 
	gT1X
 = 
t1
;

165 
	gT1
 = 
zz_pECÚ‹xt
(
t1
);

166 
zz_pEPush
 
push
(
T1
);

167 
	gVec
<
	gzz_pE
> 
	gt2E0
, 
	gt2E1
;

169 
cÚv
(
t2E0
, 
t2_0
);

170 
cÚv
(
T20
, 
t2E0
);

171 
cÚv
(
t2E1
, 
t2_1
);

172 
cÚv
(
T21
, 
t2E1
);

175 ~
	$·œ_zz_pEX_augm’‹d
(){
	}
}

181 
magma_ouut
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
F
);

186 
magma_assign
(cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
F
, cÚ¡ 
¡ršg
 & 
Çme
);

191 
¿ndom_·œ_mÚic_zz_pEX_augm’‹d
(
·œ_zz_pEX_augm’‹d
 & 
»s
, 
dX
, 
dY0
, 
dY1
);

196 
mod
(
·œ_zz_pEX_augm’‹d
 & 
»duûd
, cÚ¡…aœ_zz_pEX_augm’‹d & 
Üig
, cÚ¡ 
zz_pX
 & 
Ãw_mod
);

201 
muÉimod
(
Vec
<
·œ_zz_pEX_augm’‹d
> & 
»duûd
, cÚ¡…aœ_zz_pEX_augm’‹d & 
Üig
, cÚ¡ 
zz_pX_CRT
 & 
Ãw_mod
);

206 
combše
(
·œ_zz_pEX_augm’‹d
 & 
»suÉ
, cÚ¡ 
Vec
<·œ_zz_pEX_augm’‹d> & 
»ms
);

211 
make_mÚic_ªd_¥l™
(
Vec
<
·œ_zz_pEX_augm’‹d
> & 
mÚic_F
, cÚ¡…aœ_zz_pEX_augm’‹d & 
F
, 
idx
);

216 
»guÏr_gcd
(
Vec
<
zz_pEX_augm’‹d
> & 
h
, cÚ¡ 
·œ_zz_pEX_augm’‹d
 & 
a_b
);

	@include/lzz_pXY.h

1 #iâdeà
LZZ_PXY__H


2 
	#LZZ_PXY__H


	)

4 
	~<NTL/ZZX.h
>

5 
	~<NTL/lzz_pX.h
>

6 
	~<NTL/lzz_pEX.h
>

7 
	~<NTL/veùÜ.h
>

9 
	~"lzz_pX_CRT.h
"

10 
	~"ZZXY.h
"

12 
NTL_CLIENT


24 şas 
	czz_pXY
{

25 
	mpublic
:

26 
Vec
<
zz_pX
> 
cÛffX
;

31 
	$tdeg
() const;

36 
	$degX
() const;

41 
	$degY
() const;

47 
	`nÜm®ize
();

49 
	$zz_pXY
(){}

54 
	`zz_pXY
(cÚ¡ 
Vec
<
zz_pX
> & 
cÛff
){

55 
cÛffX
 = 
cÛff
;

56 
	`nÜm®ize
();

57 
	}
}

59 ~
	$zz_pXY
(){
	}
}

65 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gs
, cÚ¡ 
	gzz_pXY
& 
	ga
);

70 
magma_š™_Y
();

75 
magma_š™_bi
();

80 
magma_ouut
(cÚ¡ 
zz_pXY
 & 
a
);

85 
magma_assign
(cÚ¡ 
zz_pXY
 & 
a
, cÚ¡ 
¡ršg
 & 
n
);

90 
magma_ouut_bi
(cÚ¡ 
zz_pXY
 & 
a
);

95 
magma_assign_bi
(cÚ¡ 
zz_pXY
 & 
a
, cÚ¡ 
¡ršg
 & 
Çme
);

100 
¿ndom_zz_pXY
(
zz_pXY
 & 
f
, 
dx
, 
dy
);

106 
ev®u©e
(
Vec
<
zz_pX
> & 
v®ues
, cÚ¡ 
zz_pXY
 & 
f
, cÚ¡ 
zz_pX_MuÉošt
 & 
ev
);

112 
»suÉªt
(
zz_pX
 & 
»s
, zz_pX& 
sub»s0
, zz_pX& 
sub»s1
, cÚ¡ 
zz_pXY
& 
f
, cÚ¡ zz_pXY& 
g
);

118 
diffY
(
zz_pXY
 & 
dyF
, cÚ¡ zz_pXY & 
F
);

123 
cÚv
(
zz_pEX
 & 
fEX
, cÚ¡ 
zz_pXY
 & 
f
);

124 
cÚv
(
zz_pXY
 & 
f
, cÚ¡ 
zz_pEX
 & 
fEX
);

125 
cÚv
(
zz_pXY
 & 
f
, cÚ¡ 
ZZXY
 & 
fZ
);

130 
»duû_Çive
(
zz_pX
 & 
»m
, cÚ¡ zz_pX& 
R
, cÚ¡ zz_pX& 
S
, cÚ¡ 
zz_pXY
 & 
F
);

131 
»duû
(
zz_pX
 & 
»m
, cÚ¡ zz_pX& 
R
, cÚ¡ zz_pX& 
S
, cÚ¡ 
zz_pXY
 & 
F
);

	@include/lzz_pX_CRT.h

1 #iâdeà
LZZ_PX_CRT__H


2 
	#LZZ_PX_CRT__H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/veùÜ.h
>

6 
	~<NTL/m©rix.h
>

7 
	~<NTL/m©_lzz_p.h
>

9 
NTL_CLIENT


21 
bud_sub´oduù_Œ“
(
Vec
<Vec<
zz_pX
>> & 
Œ“
, cÚ¡ Vec<zz_pX> & 
q
);

31 şas 
	czz_pX_MuÉošt
{

32 
	mpublic
:

37 
vœtu®
 
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const = 0;

38 
vœtu®
 
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const = 0;

39 
vœtu®
 
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const = 0;

44 
	$Ëngth
() const{

45  
n
;

51 
	$pošt
(
zz_p
& 
±
, 
i
) const{

52 
±
 = 
±s
[
i
];

53 
	}
}

56 
	gVec
<
	gzz_p
> 
	g±s
;

57 
	gn
;

67 şas 
	czz_pX_MuÉošt_G’”®
 : 
public
 
zz_pX_MuÉošt
{

68 
public
:

70 
	$zz_pX_MuÉošt_G’”®
(){}

75 
	`zz_pX_MuÉošt_G’”®
(cÚ¡ 
Vec
<
zz_p
>& 
q
){

76 
±s
 = 
q
;

77 
n
 = 
q
.
	`Ëngth
();

78 
Vec
<
zz_pX
> 
qpŞ
;

79 
qpŞ
.
	`S‘L’gth
(
n
);

80 
i
 = 0; i < 
n
; i++){

81 
	`S‘CÛff
(
qpŞ
[
i
], 0, -
q
[i]);

82 
	`S‘CÛff
(
qpŞ
[
i
], 1, 1);

84 
	`bud_sub´oduù_Œ“
(
Œ“
, 
qpŞ
);

86 
	`ev®u©e
(
coçùÜs
, 
	`diff
(
Œ“
[Œ“.
	`Ëngth
()-1][0]));

87 
i
 = 0; i < 
n
; i++)

88 
coçùÜs
[
i
] = 1/cofactors[i];

89 
	}
}

94 
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

95 
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const;

96 
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const;

98 ~
	$zz_pX_MuÉošt_G’”®
(){
	}
};

100 
	g´iv©e
:

101 
Vec
<
zz_p
> 
coçùÜs
;

102 
	gVec
<Vec<
	gzz_pX
> > 
	gŒ“
;

112 şas 
	czz_pX_MuÉošt_Geom‘ric
 : 
public
 
zz_pX_MuÉošt
{

113 
public
:

115 
	$zz_pX_MuÉošt_Geom‘ric
(){}

121 
	`zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
a
, 
N
, 
i0
);

127 
	`zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
a
, 
N
, cÚ¡ zz_p& 
c
);

134 
	`zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
a
, 
ev®_N
, 
N
, 
i0
);

139 
	`ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

140 
	`ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const;

141 
	`š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const;

144 ~
	$zz_pX_MuÉošt_Geom‘ric
(){
	}
};

149 
	gev®_n
;

150 
	gi0
;

151 
	gVec
<
	gzz_p
> 
	gev®_šv”£_pow”s_squ¬e_q
, 
	gev®_šv”£_pow”s_squ¬e_q_shiáed
, 
	gšv”£_pow”s_squ¬e_q
, 
	gšv”£_pow”s_squ¬e_q_shiáed
, 
	gšv”£_d”iv©ive
, 
	gpow”s_c
, 
	gšv_pow”s_c
;

152 
zz_pX
 
	gM
, 
	g»vM
, 
	gev®_S
, 
	gS
;

153 
zz_p
 
	gq
, 
	gc
;

154 
fáR•
 
	gev®_S_FFT
, 
	gS_FFT
, 
	g»vM_FFT
;

155 
	gM©
<
	gzz_p
> 
	gshiá_m©rix
;

157 
	g´iv©e
:

158 
ev®u©e_Úe
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

166 
to_d’£
(
M©
<
zz_p
>& 
M
, cÚ¡ 
zz_pX_MuÉošt_Geom‘ric
& 
X
);

174 şas 
	czz_pX_MuÉošt_FFT
 : 
public
 
zz_pX_MuÉošt
{

175 
public
:

177 
	$zz_pX_MuÉošt_FFT
(){}

179 
	$zz_pX_MuÉošt_FFT
(
n
){

180 
k
 = 
	`NextPow”OfTwo
(
n
);

181 ià(
n
 !ğ(1L << 
k
)){

182 
û¼
 << "Wrong†ength for zz_pX_Multipoint_FFT\n";

183 
	`ex™
(-1);

186 
this
->
n
 =‚;

187 ià(
zz_pInfo
->
p_šfo
 =ğ
NULL
){

188 
û¼
 << "Attempto init‡ zz_pX_Multipoint_FFT without zz_p::FFTInit\n";

189 
	`ex™
(-1);

192 
±s
.
	`S‘L’gth
(
n
);

193 
zz_pX
 
X
;

194 
	`S‘CÛff
(
X
, 1, 
	`to_zz_p
(1));

195 
	`ev®u©e
(
±s
, 
X
);

196 
	}
}

201 
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

202 
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const;

203 
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const;

205 ~
	$zz_pX_MuÉošt_FFT
(){
	}
};

207 
	g´iv©e
:

208 
k
;

217 şas 
	czz_pX_CRT
{

219 
	mpublic
:

224 
zz_pX_CRT
(cÚ¡ 
Vec
<
zz_pX
>& 
q
){

225 
n
 = 
q
.
Ëngth
();

226 
bud_sub´oduù_Œ“
(
Œ“
, 
q
);

228 
muÉimod
(
coçùÜs
, 
diff
(
Œ“
[Œ“.
Ëngth
()-1][0]));

229 
	mi
 = 0; i < 
	mn
; i++)

230 
	mcoçùÜs
[
i
] = 
MulMod
(
InvMod
(
coçùÜs
[i], 
Œ“
[0][i]), 
diff
(tree[0][i]),ree[0][i]);

233 ~
	$zz_pX_CRT
(){
	}
};

238 
muÉimod
(
Vec
<
zz_pX
>& 
v®
, cÚ¡ zz_pX& 
f
) const;

239 
combše
(
zz_pX
& 
f
, cÚ¡ 
Vec
<zz_pX>& 
v®
) const;

244 
šlše
 
zz_pX
 
	$ma¡”
() const{

245  
Œ“
[Œ“.
	`Ëngth
()-1][0];

246 
	}
}

251 
šlše
 
zz_pX
 
	$moduli
(
i
) const{

252  
Œ“
[0][
i
];

253 
	}
}

258 
	$Ëngth
() const{

259  
n
;

260 
	}
}

262 
	g´iv©e
:

263 
n
;

264 
	gVec
<
	gzz_pX
> 
	gcoçùÜs
;

265 
	gVec
<Vec<
	gzz_pX
>> 
	gŒ“
;

	@include/lzz_pX_middle_product.h

1 #iâdeà
__LZZ_PX_MIDDLE_PRODUCT__H


2 
	#__LZZ_PX_MIDDLE_PRODUCT__H


	)

4 
	#KARX
 (32)

	)

6 
	~<NTL/lzz_pX.h
>

8 
NTL_CLIENT


13 
tPÏšMul
(
zz_p
 *
xp
, cÚ¡ zz_°*
­
, cÚ¡ zz_°*
bp
, 
N
);

18 
K¬_¡k_size
(
N
);

23 
tK¬Mul_aux
(
zz_p
 *
b
, cÚ¡ 
sb
, cÚ¡ zz_°*
a
, cÚ¡ 
§
, cÚ¡ zz_°*
c
, cÚ¡ 
sc
, zz_°*
¡k
);

29 
middË_FFT
(
zz_pX
& 
x
, cÚ¡ zz_pX& 
a
, cÚ¡ zz_pX& 
b
, 
N
);

38 
zz_pX
 
middË_´oduù
(cÚ¡ zz_pX& 
c
, cÚ¡ zz_pX& 
a
, 
N
);

	@include/lzz_p_extra.h

1 #iâdeà
__LZZ_P_EXTRA__H


2 
	#__LZZ_P_EXTRA__H


	)

4 
NTL_CLIENT


10 
Üd”
(cÚ¡ 
zz_p
& 
a
);

16 
–em’t_of_Üd”
(
zz_p
& 
a
, 
Üd
);

	@include/magma_output.h

1 #iâdeà
MAGMA_OUTPUT__H


2 
	#MAGMA_OUTPUT__H


	)

4 
	~<NTL/ZZX.h
>

5 
	~<NTL/lzz_pX.h
>

6 
	~<NTL/veùÜ.h
>

8 
NTL_CLIENT


20 
magma_ouut
(cÚ¡ 
Vec
<
ZZ
> & 
v
);

25 
magma_assign
(cÚ¡ 
Vec
<
ZZ
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

30 
magma_š™_ZZX
();

35 
magma_ouut
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

40 
magma_ouut
(cÚ¡ 
ZZX
 & 
v
);

45 
magma_assign
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

50 
magma_assign
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

55 
magma_ouut
(cÚ¡ 
Vec
<> & 
v
);

60 
magma_assign
(cÚ¡ 
Vec
<> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

65 
magma_š™
();

70 
magma_š™_X
();

75 
magma_ouut
(cÚ¡ 
Vec
<
zz_p
> & 
v
);

80 
magma_assign
(cÚ¡ 
Vec
<
zz_p
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

85 
magma_ouut
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

90 
magma_ouut
(cÚ¡ 
zz_pX
 & 
v
);

95 
magma_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

100 
magma_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

106 
magma_ouut
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

111 
magma_ouut
(cÚ¡ 
Vec
<
zz_pX
> & 
v
);

116 
magma_assign
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

121 
magma_assign
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

	@include/mat_ZZX.h

1 #iâdeà
__MAT_ZZX_H__


2 
	#__MAT_ZZX_H__


	)

4 
	~<NTL/m©rix.h
>

5 
	~<NTL/ZZX.h
>

7 
add
(
NTL
::
M©
<NTL::
ZZX
>&, const NTL::Mat<NTL::ZZX>&, const NTL::Mat<NTL::ZZX>&);

8 
mul
(
NTL
::
M©
<NTL::
ZZX
>&, const NTL::Mat<NTL::ZZX>&, const NTL::Mat<NTL::ZZX>&);

	@include/mat_ZZ_pX.h

1 #iâdeà
__MAT_ZZpx_H__


2 
	#__MAT_ZZpX_H__


	)

4 
	~<NTL/m©rix.h
>

5 
	~<NTL/ZZ_pX.h
>

7 
add
(
NTL
::
M©
<NTL::
ZZ_pX
>&, const NTL::Mat<NTL::ZZ_pX>&, const NTL::Mat<NTL::ZZ_pX>&);

8 
mul
(
NTL
::
M©
<NTL::
ZZ_pX
>&, const NTL::Mat<NTL::ZZ_pX>&, const NTL::Mat<NTL::ZZ_pX>&);

	@include/mat_lzz_pX_extra.h

1 #iâdeà
MAT_LZZ_PX_EXTRA__H


2 
	#MAT_LZZ_PX_EXTRA__H


	)

4 
	~<NTL/m©rix.h
>

5 
	~<NTL/lzz_pX.h
>

7 
NTL_CLIENT


12 
magma_ouut
(cÚ¡ 
M©
<
zz_pX
>& 
a
, cÚ¡ 
¡ršg
 & 
v¬
);

17 
magma_assign
(cÚ¡ 
M©
<
zz_pX
>& 
a
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

22 
¿ndom_m©_zz_pX
(
M©
<
zz_pX
>& 
a
, 
n
, 
m
, 
d
);

27 
deg
(cÚ¡ 
M©
<
zz_pX
> & 
a
);

32 
muÉly_waksmª
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
);

33 
muÉly_Çive
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
);

34 
muÉly_ev®u©e
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
);

	@include/mosaic_hankel.h

1 #iâdeà
__MOSAIC_HANKEL_H


2 
	#__MOSAIC_HANKEL_H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/m©_lzz_p.h
>

7 
	~"lzz_pX_CRT.h
"

8 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

10 
NTL_CLIENT


22 şas 
	chªk–
{

25 
	mn
, 
	mm
;

26 
	mVec
<
	mzz_p
> 
	md©a
;

28 
	mpublic
:

30 
Vec
<
zz_p
> 
d©a_»v
;

31 
fáR•
 
	mfá_d©a
;

33 
	$hªk–
(){

34 
d©a
.
	`S‘L’gth
(0);

35 
n
 = 
m
 = 0;

41 
	`hªk–
(
Vec
<
zz_p
>& 
šput
, 
rows
, 
cŞs
){

42 
n
 = 
rows
;

43 
m
 = 
cŞs
;

44 
d©a
 = 
šput
;

45 
d©a_»v
.
	`S‘L’gth
(
n
+
m
-1);

46 
zz_pX
 
d©a_X
;

47 
d©a_X
.
»p
.
	`S‘L’gth
(
n
+
m
-1);

49 
i
 = 0;˜< 
n
+
m
-1; i++){

50 
d©a_»v
[
i
] = 
šput
[
n
+
m
-2-i];

51 
d©a_X
.
»p
[
i
] = 
d©a_»v
[i];

53 
d©a_X
.
	`nÜm®ize
();

55 
K
 = 
	`NextPow”OfTwo
(
n
+
m
-1);

56 
fá_d©a
 = 
	`fáR•
(
INIT_SIZE
, 
K
);

57 
	`TofáR•
(
fá_d©a
, 
d©a_X
, 
K
);

58 
	}
}

63 
	$NumCŞs
() const{

64  
m
;

65 
	}
}

66 
	$NumRows
() const{

67  
n
;

68 
	}
}

69 cÚ¡ 
	gzz_p
& 
	$İ”©Ü
 ()(
i
, 
j
) const{

70  
d©a
[
m
+
n
-2-
i
-
j
];

71 
	}
}

78 
to_d’£
(
M©
<
zz_p
>& 
Md’£
, cÚ¡ 
hªk–
& 
M
);

84 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

90 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

101 şas 
	cmo§ic_hªk–
{

102 
	mn
, 
	mm
;

103 
	mnb
, 
	mmb
;

105 
	mpublic
:

108 
Vec
< Vec<
hªk–
> > 
d©a
;

113 
	$mo§ic_hªk–
(){

114 
d©a
.
	`S‘L’gth
(0);

115 
n
 = 
m
 = 
nb
 = 
mb
 = 0;

121 
	`mo§ic_hªk–
(
Vec
< Vec<
hªk–
> > 
š™
){

122 
d©a
 = 
š™
;

123 
nb
 = 
š™
.
	`Ëngth
();

124 
mb
 = 
š™
[0].
	`Ëngth
();

126 
n
 = 0;

127 
m
 = 0;

129 
i
 = 0; i < 
nb
; i++)

130 
n
 +ğ
š™
[
i
][0].
	`NumRows
();

131 
j
 = 0; j < 
mb
; j++)

132 
m
 +ğ
š™
[0][
j
].
	`NumCŞs
();

133 
	}
}

138 
	$NumRows
() const{

139  
n
;

140 
	}
}

141 
	$NumCŞs
() const{

142  
m
;

143 
	}
}

144 
	$NumBlockRows
() const{

145  
nb
;

146 
	}
}

147 
	$NumBlockCŞs
() const{

148  
mb
;

149 
	}
}

150 
	$NumRows_of_block
(
i
) const{

151  
d©a
[
i
][0].
	`NumRows
();

152 
	}
}

153 
	$NumCŞs_of_block
(
i
) const{

154  
d©a
[0][
i
].
	`NumCŞs
();

155 
	}
}

157 cÚ¡ 
	gzz_p
& 
	$İ”©Ü
 ()(
i
, 
j
) const{

159 ià(
i
 >ğ
n
 || 
j
 >ğ
m
)

160 
	`E¼Ü
("matrix indices out of bounds\n");

161 
idx
, 
jdx
;

163 
idx
 = 0;

164 
i
 >ğ
d©a
[
idx
][0].
	`NumRows
()){

165 
i
 -ğ
d©a
[
idx
][0].
	`NumRows
();

166 
idx
++;

169 
jdx
 = 0;

170 
j
 >ğ
d©a
[0][
jdx
].
	`NumCŞs
()){

171 
j
 -ğ
d©a
[0][
jdx
].
	`NumCŞs
();

172 
jdx
++;

174  
d©a
[
idx
][
jdx
](
i
, 
j
);

175 
	}
}

182 
to_d’£
(
M©
<
zz_p
>& 
Md’£
, cÚ¡ 
mo§ic_hªk–
& 
M
);

187 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
mo§ic_hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

192 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
mo§ic_hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

197 
fœ¡_cŞumn_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

198 
Ï¡_cŞumn_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

199 
fœ¡_row_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

200 
Ï¡_row_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

205 
g’”©Üs
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, cÚ¡ 
mo§ic_hªk–
& 
M
);

215 
to_ÿuchy_g½
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
,

216 
zz_pX_MuÉošt_Geom‘ric
& 
X_št
, zz_pX_MuÉošt_Geom‘ric& 
Y_št
,

217 
Vec
<
zz_p
> &
e
, Vec<zz_p> &
f
,

218 cÚ¡ 
mo§ic_hªk–
& 
M
);

	@include/ratrecon.h

1 #iâdeà
RATRECON__H


2 
	#RATRECON__H


	)

4 
	~<NTL/ZZ.h
>

5 
	~<NTL/veùÜ.h
>

7 
NTL_CLIENT


23 
šlše


24 
	$mulmod
 (
ZZ
& 
a
, cÚ¡ ZZ& 
b
, cÚ¡ ZZ& 
d
, cÚ¡ ZZ& 
m
){

25 
	`MulMod
(
a
, 
b
, 
d
, 
m
);

26 
	}
}

32 
	g‹m¶©e
 <
şass
 
	gT
>

33 
mulmod
(
Vec
<
T
>& 
a
, cÚ¡ Vec<T>& 
b
, cÚ¡ 
ZZ
& 
d
, cÚ¡ ZZ& 
m
){

34 
	gn
 = 
b
.
Ëngth
();

35 
	ga
.
S‘L’gth
(
n
);

36 
	gi
 = 0; i < 
	gn
; i++)

37 
mulmod
(
a
[
i
], 
b
[i], 
d
, 
m
);

46 
šlše


47 
boŞ
 
	$Ëss_thª
(cÚ¡ 
ZZ
& 
a
, cÚ¡ ZZ& 
bound
){

48  
	`abs
(
a
è< 
bound
;

49 
	}
}

56 
	g‹m¶©e
 <
şass
 
	gT
>

57 
boŞ
 
Ëss_thª
(cÚ¡ 
Vec
<
T
>& 
a
, cÚ¡ 
ZZ
& 
bound
){

58 
	gi
 = 0; i < 
	ga
.
Ëngth
(); i++)

59 ià(!
Ëss_thª
(
a
[
i
], 
bound
))

60  
	gçl£
;

61  
	gŒue
;

70 
šlše


71 
	$ûÁ”
(
ZZ
& 
ac
, cÚ¡ ZZ& 
a
, cÚ¡ ZZ& 
m
){

72 ià((
m
-
a
) <‡)

73 
ac
 = 
a
-
m
;

75 
ac
 = 
a
;

76 
	}
}

83 
	g‹m¶©e
 <
şass
 
	gT
>

84 
ûÁ”
(
Vec
<
T
>& 
ac
, cÚ¡ Vec<T>& 
a
, cÚ¡ 
ZZ
& 
m
){

85 
	gac
.
S‘L’gth
(
a
.
Ëngth
());

86 
	gi
 = 0; i < 
	ga
.
Ëngth
(); i++)

87 
ûÁ”
(
ac
[
i
], 
a
[i], 
m
);

95 
	g‹m¶©e
 <
şass
 
	gT
>

96 
mul
(
Vec
<
T
>& 
a
, cÚ¡ Vec<T>& 
b
, cÚ¡ 
ZZ
& 
d
){

97 
	gn
 = 
b
.
Ëngth
();

98 
	ga
.
S‘L’gth
(
n
);

99 
	gi
 = 0; i < 
	gn
; i++)

100 
mul
(
a
[
i
], 
b
[i], 
d
);

109 
šlše


110 
boŞ
 
	$check_mod
(cÚ¡ 
ZZ
& 
a
, cÚ¡ 
d’om
, cÚ¡ & 
w™Ãss
, cÚ¡ 
´ime
){

111  (
a
 % 
´ime
è=ğ
	`MulMod
(
d’om
, 
w™Ãss
,…rime);

112 
	}
}

119 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gU
>

120 
boŞ
 
check_mod
(cÚ¡ 
Vec
<
T
>& 
a
, cÚ¡ 
d’om
, cÚ¡ Vec<
U
>& 
w™Ãss
, cÚ¡ 
´ime
){

121 
	gn
 = 
a
.
Ëngth
();

122 ià(
	gw™Ãss
.
Ëngth
(è!ğ
n
)

123  
çl£
;

124 
	gi
 = 0; i < 
	gn
; i++){

125 
boŞ
 
	gb
 = 
check_mod
(
a
[
i
], 
d’om
, 
w™Ãss
[i], 
´ime
);

126 ià(
	gb
 =ğ
çl£
)

127  
çl£
;

129  
	gŒue
;

144 
šlše


145 
	$RecÚ¡ruùR©iÚ®_ªd_check
(
ZZ
& 
a
, ZZ& 
b
, cÚ¡ ZZ& 
x
, cÚ¡ ZZ& 
m
, cÚ¡ ZZ& 
h®f
, cÚ¡ ZZ& 
mo¡
,

146 cÚ¡ & 
w™Ãss
, cÚ¡ 
´ime
, 
muÉl›r
){

147 
s
 = 
	`RecÚ¡ruùR©iÚ®
(
a
, 
b
, 
x
, 
m
, 
h®f
, half);

148 ià(
s
 == 0)

150 ià((
a
 % 
´ime
è=ğ
	`MulMod
(MulMod(
b
 %…rime, 
w™Ãss
,…rime), 
muÉl›r
,…rime))

154 
	}
}

169 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gU
>

170 
RecÚ¡ruùR©iÚ®_ªd_check
(
Vec
<
T
>& 
a
, 
ZZ
& 
b
, cÚ¡ Vec<T>& 
u
, cÚ¡ ZZ& 
m
, cÚ¡ ZZ& 
h®f_´ec
, cÚ¡ ZZ& 
mo¡_´ec
,

171 cÚ¡ 
Vec
<
U
>& 
w™Ãss
, cÚ¡ 
´ime
, 
muÉl›r
){

172 
	gn
 = 
u
.
Ëngth
();

173 
	ga
.
S‘L’gth
(
n
);

175 
	gVec
<
	gZZ
> 
	gd’s
, 
	g´od
, 
	gšv_´od
;

176 
	g´od
.
S‘L’gth
(
n
+1);

177 
	g´od
[
n
] = 
to_ZZ
(1);

178 
	gd’s
.
S‘L’gth
(
n
);

180 
	gVec
<> 
	g´od_mod
;

181 
	g´od_mod
.
S‘L’gth
(
n
+1);

182 
	g´od_mod
[
n
] = 
muÉl›r
;

184 
	gVec
<
	gT
> 
	gtmp_a1
, 
	gtmp_a1_ûÁ”
, 
	gtmp_a2
;

185 
	gtmp_a1
.
S‘L’gth
(
n
);

186 
	gtmp_a1_ûÁ”
.
S‘L’gth
(
n
);

187 
	gtmp_a2
.
S‘L’gth
(
n
);

189 
	gi
 = 
n
-1; i >= 0; i--){

190 
mulmod
(
tmp_a1
[
i
], 
u
[i], 
´od
[i+1], 
m
);

191 
ûÁ”
(
tmp_a1_ûÁ”
[
i
], 
tmp_a1
[i], 
m
);

193 ià(
Ëss_thª
(
tmp_a1_ûÁ”
[
i
], 
mo¡_´ec
)){

195 
	gtmp_a2
[
i
] = 
tmp_a1_ûÁ”
[i];

196 
boŞ
 
	gboo
 = 
check_mod
(
tmp_a2
[
i
], 
´od_mod
[i+1], 
w™Ãss
[i], 
´ime
);

197 ià(
	gboo
 =ğ
çl£
)

199 
	gd’s
[
i
] = 
to_ZZ
(1);

200 
	g´od
[
i
] = 
´od
[i+1];

201 
	g´od_mod
[
i
] = 
´od_mod
[i+1];

204 
	gs
 = 
RecÚ¡ruùR©iÚ®_ªd_check
(
tmp_a2
[
i
], 
d’s
[i], 
tmp_a1
[i], 
m
, 
h®f_´ec
, 
mo¡_´ec
, 
w™Ãss
[i], 
´ime
, 
´od_mod
[i+1]);

208 ià(
	gs
 == 0)

210 
	g´od
[
i
] = 
d’s
[i]*
´od
[i+1];

211 
	g´od_mod
[
i
] = 
MulMod
(
d’s
[i] % 
´ime
, 
´od_mod
[i+1],…rime);

216 
ZZ
 
	gçc
 = 
to_ZZ
(1);

217 
	ga
[0] = 
tmp_a2
[0];

218 
	gi
 = 1; i < 
	gn
; i++){

219 
	gçc
 = 
çc
*
d’s
[
i
-1];

220 
mul
(
a
[
i
], 
tmp_a2
[i], 
çc
);

222 
	gb
 = 
´od
[0];

235 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gU
>

236 
RecÚ¡ruùR©iÚ®
(
Vec
<
T
>& 
a
, 
ZZ
& 
b
, cÚ¡ Vec<T>& 
u
, cÚ¡ ZZ& 
m
, cÚ¡ Vec<
U
>& 
w™Ãss
, cÚ¡ 
´ime
){

237 
ZZ
 
	gh®f
 = 
SqrRoÙ
(
m
/2);

238 
ZZ
 
	gmo¡
 = 
h®f
*
SqrRoÙ
(half);

240  
RecÚ¡ruùR©iÚ®_ªd_check
(
a
, 
b
, 
u
, 
m
, 
h®f
, 
mo¡
, 
w™Ãss
, 
´ime
, 1L);

	@include/sage_output.h

1 #iâdeà
SAGE_OUTPUT__H


2 
	#SAGE_OUTPUT__H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/veùÜ.h
>

7 
NTL_CLIENT


20 
§ge_š™
();

25 
§ge_š™_X
();

30 
§ge_ouut
(cÚ¡ 
Vec
<
zz_p
> & 
v
);

35 
§ge_assign
(cÚ¡ 
Vec
<
zz_p
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

40 
§ge_ouut
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

45 
§ge_ouut
(cÚ¡ 
zz_pX
 & 
v
);

50 
§ge_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

55 
§ge_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

	@include/vec_lzz_p_extra.h

1 #iâdeà
__VEC_LZZ_P_EXTRA_H


2 
	#__VEC_LZZ_P_EXTRA_H


	)

4 
	~<NTL/m©_lzz_p.h
>

5 
	~<NTL/vec_lzz_p.h
>

7 
NTL_CLIENT


12 
¿ndom
(
vec_zz_p
& 
A
, 
d
);

17 
¿ndom
(
m©_zz_p
& 
A
, 
d
, 
e
);

22 
šv_Çive
(
vec_zz_p
& 
švA
, cÚ¡ vec_zz_p& 
A
);

27 
šv
(
vec_zz_p
& 
švA
, cÚ¡ vec_zz_p& 
A
);

32 
šv
(
vec_zz_p
& 
A
);

34 #ifdeà
NTL_HAVE_LL_TYPE


38 
IÂ”Prod_LL
(cÚ¡ *
­
, cÚ¡ *
bp
, 
n
);

39 
IÂ”Prod_L
(cÚ¡ *
­
, cÚ¡ *
bp
, 
n
);

	@lzz_pX_CRT/lzz_pX_CRT.h

1 #iâdeà
LZZ_PX_CRT__H


2 
	#LZZ_PX_CRT__H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/veùÜ.h
>

6 
	~<NTL/m©rix.h
>

7 
	~<NTL/m©_lzz_p.h
>

9 
NTL_CLIENT


21 
bud_sub´oduù_Œ“
(
Vec
<Vec<
zz_pX
>> & 
Œ“
, cÚ¡ Vec<zz_pX> & 
q
);

31 şas 
	czz_pX_MuÉošt
{

32 
	mpublic
:

37 
vœtu®
 
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const = 0;

38 
vœtu®
 
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const = 0;

39 
vœtu®
 
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const = 0;

44 
	$Ëngth
() const{

45  
n
;

51 
	$pošt
(
zz_p
& 
±
, 
i
) const{

52 
±
 = 
±s
[
i
];

53 
	}
}

56 
	gVec
<
	gzz_p
> 
	g±s
;

57 
	gn
;

67 şas 
	czz_pX_MuÉošt_G’”®
 : 
public
 
zz_pX_MuÉošt
{

68 
public
:

70 
	$zz_pX_MuÉošt_G’”®
(){}

75 
	`zz_pX_MuÉošt_G’”®
(cÚ¡ 
Vec
<
zz_p
>& 
q
){

76 
±s
 = 
q
;

77 
n
 = 
q
.
	`Ëngth
();

78 
Vec
<
zz_pX
> 
qpŞ
;

79 
qpŞ
.
	`S‘L’gth
(
n
);

80 
i
 = 0; i < 
n
; i++){

81 
	`S‘CÛff
(
qpŞ
[
i
], 0, -
q
[i]);

82 
	`S‘CÛff
(
qpŞ
[
i
], 1, 1);

84 
	`bud_sub´oduù_Œ“
(
Œ“
, 
qpŞ
);

86 
	`ev®u©e
(
coçùÜs
, 
	`diff
(
Œ“
[Œ“.
	`Ëngth
()-1][0]));

87 
i
 = 0; i < 
n
; i++)

88 
coçùÜs
[
i
] = 1/cofactors[i];

89 
	}
}

94 
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

95 
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const;

96 
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const;

98 ~
	$zz_pX_MuÉošt_G’”®
(){
	}
};

100 
	g´iv©e
:

101 
Vec
<
zz_p
> 
coçùÜs
;

102 
	gVec
<Vec<
	gzz_pX
> > 
	gŒ“
;

112 şas 
	czz_pX_MuÉošt_Geom‘ric
 : 
public
 
zz_pX_MuÉošt
{

113 
public
:

115 
	$zz_pX_MuÉošt_Geom‘ric
(){}

121 
	`zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
a
, 
N
, 
i0
);

127 
	`zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
a
, 
N
, cÚ¡ zz_p& 
c
);

134 
	`zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
a
, 
ev®_N
, 
N
, 
i0
);

139 
	`ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

140 
	`ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const;

141 
	`š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const;

144 ~
	$zz_pX_MuÉošt_Geom‘ric
(){
	}
};

149 
	gev®_n
;

150 
	gi0
;

151 
	gVec
<
	gzz_p
> 
	gev®_šv”£_pow”s_squ¬e_q
, 
	gev®_šv”£_pow”s_squ¬e_q_shiáed
, 
	gšv”£_pow”s_squ¬e_q
, 
	gšv”£_pow”s_squ¬e_q_shiáed
, 
	gšv”£_d”iv©ive
, 
	gpow”s_c
, 
	gšv_pow”s_c
;

152 
zz_pX
 
	gM
, 
	g»vM
, 
	gev®_S
, 
	gS
;

153 
zz_p
 
	gq
, 
	gc
;

154 
fáR•
 
	gev®_S_FFT
, 
	gS_FFT
, 
	g»vM_FFT
;

155 
	gM©
<
	gzz_p
> 
	gshiá_m©rix
;

157 
	g´iv©e
:

158 
ev®u©e_Úe
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

166 
to_d’£
(
M©
<
zz_p
>& 
M
, cÚ¡ 
zz_pX_MuÉošt_Geom‘ric
& 
X
);

174 şas 
	czz_pX_MuÉošt_FFT
 : 
public
 
zz_pX_MuÉošt
{

175 
public
:

177 
	$zz_pX_MuÉošt_FFT
(){}

179 
	$zz_pX_MuÉošt_FFT
(
n
){

180 
k
 = 
	`NextPow”OfTwo
(
n
);

181 ià(
n
 !ğ(1L << 
k
)){

182 
û¼
 << "Wrong†ength for zz_pX_Multipoint_FFT\n";

183 
	`ex™
(-1);

186 
this
->
n
 =‚;

187 ià(
zz_pInfo
->
p_šfo
 =ğ
NULL
){

188 
û¼
 << "Attempto init‡ zz_pX_Multipoint_FFT without zz_p::FFTInit\n";

189 
	`ex™
(-1);

192 
±s
.
	`S‘L’gth
(
n
);

193 
zz_pX
 
X
;

194 
	`S‘CÛff
(
X
, 1, 
	`to_zz_p
(1));

195 
	`ev®u©e
(
±s
, 
X
);

196 
	}
}

201 
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const;

202 
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const;

203 
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const;

205 ~
	$zz_pX_MuÉošt_FFT
(){
	}
};

207 
	g´iv©e
:

208 
k
;

217 şas 
	czz_pX_CRT
{

219 
	mpublic
:

224 
zz_pX_CRT
(cÚ¡ 
Vec
<
zz_pX
>& 
q
){

225 
n
 = 
q
.
Ëngth
();

226 
bud_sub´oduù_Œ“
(
Œ“
, 
q
);

228 
muÉimod
(
coçùÜs
, 
diff
(
Œ“
[Œ“.
Ëngth
()-1][0]));

229 
	mi
 = 0; i < 
	mn
; i++)

230 
	mcoçùÜs
[
i
] = 
MulMod
(
InvMod
(
coçùÜs
[i], 
Œ“
[0][i]), 
diff
(tree[0][i]),ree[0][i]);

233 ~
	$zz_pX_CRT
(){
	}
};

238 
muÉimod
(
Vec
<
zz_pX
>& 
v®
, cÚ¡ zz_pX& 
f
) const;

239 
combše
(
zz_pX
& 
f
, cÚ¡ 
Vec
<zz_pX>& 
v®
) const;

244 
šlše
 
zz_pX
 
	$ma¡”
() const{

245  
Œ“
[Œ“.
	`Ëngth
()-1][0];

246 
	}
}

251 
šlše
 
zz_pX
 
	$moduli
(
i
) const{

252  
Œ“
[0][
i
];

253 
	}
}

258 
	$Ëngth
() const{

259  
n
;

260 
	}
}

262 
	g´iv©e
:

263 
n
;

264 
	gVec
<
	gzz_pX
> 
	gcoçùÜs
;

265 
	gVec
<Vec<
	gzz_pX
>> 
	gŒ“
;

	@lzz_pX_CRT/src/lzz_pX_CRT.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_middË_´oduù.h
"

5 
	~"lzz_pX_CRT.h
"

7 
NTL_CLIENT


18 
	gzz_pX_CRT
::
muÉimod
(
Vec
<
zz_pX
>& 
v®
, cÚ¡ zz_pX& 
f
) const {

19 
	gn
 = 
this
->
n
;

20 
	gv®
.
S‘L’gth
(
n
);

21 
	gd
 = 
this
->
Œ“
.
Ëngth
();

22 
	gv®
.
S‘L’gth
(
n
);

23 
	gv®
[0] = 
f
 % 
Œ“
[
d
-1][0];

25 
	gi
 = 
d
-2; i >= 0; i--){

26 
	gËn
 = 
Œ“
[
i
].
Ëngth
();

27 ià(
	gËn
 & 1)

28 
	gv®
[
Ën
-1] = 
v®
[(len-1)/2];

29 
	gj
 = 
Ën
/2-1; j >= 0; j--){

30 
	gv®
[2*
j
+1] = 
v®
[j] % 
Œ“
[
i
][2*j+1];

31 
	gv®
[2*
j
] = 
v®
[j] % 
Œ“
[
i
][2*j];

39 
	gzz_pX_CRT
::
combše
(
zz_pX
& 
f
, cÚ¡ 
Vec
<zz_pX>& 
v®
) const {

40 
	gn
 = 
this
->
n
;

41 
	gd
 = 
this
->
Œ“
.
Ëngth
();

43 
	gVec
<
	gzz_pX
> 
	gcombš©iÚs
;

44 
	gcombš©iÚs
.
S‘L’gth
(
n
);

46 
	gi
 = 0; i < 
	gn
; i++)

47 
	gcombš©iÚs
[
i
] = 
MulMod
((
v®
[i] % 
Œ“
[0][i]), 
coçùÜs
[i],ree[0][i]);

48 
	gi
 = 0; i < 
	gd
-1; i++){

49 
	gËn
 = 
Œ“
[
i
].
Ëngth
();

50 
	gj
 = 0; j < 
	gËn
/2; j++)

51 
	gcombš©iÚs
[
j
] = 
combš©iÚs
[2*j]*
Œ“
[
i
][2*j+1] + combinations[2*j+1]*tree[i][2*j];

52 ià(
	gËn
 & 1)

53 
	gcombš©iÚs
[(
Ën
-1)/2] = 
combš©iÚs
[len-1];

56 
	gf
 = 
combš©iÚs
[0];

	@lzz_pX_CRT/src/lzz_pX_Multipoint_FFT.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_p_exŒa.h
"

5 
	~"lzz_pX_middË_´oduù.h
"

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


21 
	gzz_pX_MuÉošt_FFT
::
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const {

22 
fáR•
 
ä•
(
INIT_SIZE
, 
k
);

23 
TofáR•
(
ä•
, 
f
, 
k
);

24 *
	gä•t
 = &
ä•
.
tbl
[0][0];

26 
	gv®
.
S‘L’gth
(
n
);

27 
	gi
 = 0; i < 
	gn
; i++)

28 
	gv®
[
i
] = 
ä•t
[i];

34 
	gzz_pX_MuÉošt_FFT
::
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const{

35 
	gv®
.
S‘L’gth
(
f
.
Ëngth
());

36 
	gi
 = 0; i < 
	gf
.
Ëngth
(); i++)

37 
ev®u©e
(
v®
[
i
], 
f
[i]);

43 
	gzz_pX_MuÉošt_FFT
::
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const{

44 
fáR•
 
ä•
(
INIT_SIZE
, 
k
);

45 *
	gä•t
 = &
ä•
.
tbl
[0][0];

47 
	gi
 = 0; i < 
	gn
; i++)

48 
	gä•t
[
i
] = 
»p
(
v®
[i]);

50 
FromfáR•
(
f
, 
ä•
, 0, 
n
-1);

	@lzz_pX_CRT/src/lzz_pX_Multipoint_General.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_middË_´oduù.h
"

5 
	~"lzz_pX_CRT.h
"

7 
NTL_CLIENT


13 
bud_sub´oduù_Œ“
(
Vec
<Vec<
zz_pX
>> & 
Œ“
, cÚ¡ Vec<zz_pX> & 
q
){

15 
	gËn_Œ“
 = 1;

16 
	gËn
 = 
q
.
Ëngth
();

17 
	gËn
 != 1){

18 
Ën_Œ“
++;

19 
	gËn
 = (
Ën
+1) / 2;

22 
	gŒ“
.
S‘L’gth
(
Ën_Œ“
);

23 
	gŒ“
[0] = 
q
;

25 
	gidx
 = 1;

26 
	gËn
 = 
q
.
Ëngth
();

27 
	gËn
 != 1){

28 
Ën_Ãw
 = (
Ën
+1) / 2;

29 
	gŒ“
[
idx
].
S‘L’gth
(
Ën_Ãw
);

30 
	gj
 = 0; j < 
	gËn
 / 2; j++)

31 
	gŒ“
[
idx
][
j
] = 
Œ“
[idx-1][2*j] *ree[idx-1][2*j+1];

32 ià(
	gËn
 & 1)

33 
	gŒ“
[
idx
][
Ën_Ãw
-1] = 
Œ“
[idx-1][
Ën
-1];

34 
	gËn
 = 
Ën_Ãw
;

35 
	gidx
++;

50 
	gzz_pX_MuÉošt_G’”®
::
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const {

54 
	gn
 = 
this
->
n
;

55 
	gv®
.
S‘L’gth
(
n
);

56 
	gd
 = 
this
->
Œ“
.
Ëngth
();

57 
	gVec
<
	gzz_pX
> 
	g»mašd”s
;

58 
	g»mašd”s
.
S‘L’gth
(
n
);

59 
	g»mašd”s
[0] = 
f
 % 
Œ“
[
d
-1][0];

61 
	gi
 = 
d
-2; i >= 0; i--){

62 
	gËn
 = 
Œ“
[
i
].
Ëngth
();

63 ià(
	gËn
 & 1)

64 
	g»mašd”s
[
Ën
-1] = 
»mašd”s
[(len-1)/2];

65 
	gj
 = 
Ën
/2-1; j >= 0; j--){

66 
	g»mašd”s
[2*
j
+1] = 
»mašd”s
[j] % 
Œ“
[
i
][2*j+1];

67 
	g»mašd”s
[2*
j
] = 
»mašd”s
[j] % 
Œ“
[
i
][2*j];

70 
	gi
 = 0; i < 
	gn
; i++)

71 
	gv®
[
i
] = 
cÛff
(
»mašd”s
[i], 0);

78 
	gzz_pX_MuÉošt_G’”®
::
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f
) const{

79 
	gv®
.
S‘L’gth
(
f
.
Ëngth
());

80 
	gi
 = 0; i < 
	gf
.
Ëngth
(); i++)

81 
ev®u©e
(
v®
[
i
], 
f
[i]);

87 
	gzz_pX_MuÉošt_G’”®
::
š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
Vec
<
zz_p
>& 
v®
) const {

88 
	gn
 = 
this
->
n
;

89 
	gd
 = 
this
->
Œ“
.
Ëngth
();

91 
	gVec
<
	gzz_pX
> 
	gcombš©iÚs
;

92 
	gcombš©iÚs
.
S‘L’gth
(
n
);

94 
	gi
 = 0; i < 
	gn
; i++)

95 
S‘CÛff
(
combš©iÚs
[
i
], 0, 
v®
[i]*
this
->
coçùÜs
[i]);

96 
	gi
 = 0; i < 
	gd
-1; i++){

97 
	gËn
 = 
Œ“
[
i
].
Ëngth
();

98 
	gj
 = 0; j < 
	gËn
/2; j++)

99 
	gcombš©iÚs
[
j
] = 
combš©iÚs
[2*j]*
Œ“
[
i
][2*j+1] + combinations[2*j+1]*tree[i][2*j];

100 ià(
	gËn
 & 1)

101 
	gcombš©iÚs
[(
Ën
-1)/2] = 
combš©iÚs
[len-1];

104 
	gf
 = 
combš©iÚs
[0];

	@lzz_pX_CRT/src/lzz_pX_Multipoint_Geometric.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"vec_lzz_p_exŒa.h
"

5 
	~"lzz_pX_middË_´oduù.h
"

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


21 
	$çn_š
(
zz_pX
& 
f
, cÚ¡ 
zz_p
& 
a
, 
n
){

22 ià(
n
 <= 0){

23 
û¼
 << "too few…oints :‚ <= 0 in fanIn.\n";

24 
	`ex™
(-1);

26 
j
, 
i
 = 1;

28 
i
 <ğ
n
/2)

29 
i
<<=1;

30 
i
>>=1;

32 
	`S‘X
(
f
);

33 
	`S‘CÛff
(
f
, 0, 
	`to_zz_p
(-1));

35 
zz_pX
 
tmp
;

36 
zz_p
 
b
, 
c
, 
d
;

37 
b
 = 
a
;

38 
c
 = 
a
;

41 
i
 >= 1){

42 
tmp
.
»p
.
	`S‘L’gth
(
	`deg
(
f
)+1);

43 
d
 = 
c
;

44 
k
 = 0; k < 
tmp
.
»p
.
	`Ëngth
(); k++){

45 
	`mul
(
tmp
.
»p
[
k
], 
f
.»p[k], 
d
);

46 
	`div
(
d
, d, 
b
);

48 
	`mul
(
f
, f, 
tmp
);

49 
	`mul
(
b
, b, b);

50 
	`mul
(
c
, c, c);

51 
	`mul
(
c
, c, c);

54 
j
 = 
n
&
i
;

55 ià(
j
 != 0){

56 
de
 = 
f
.
»p
.
	`Ëngth
();

57 
f
.
»p
.
	`S‘L’gth
(
de
+1);

58 
f
.
»p
[
de
] = f.rep[de-1];

59 
k
 = 
de
-1; k > 0; k--){

60 
	`mul
(
f
.
»p
[
k
], f.»p[k], 
b
);

61 
	`sub
(
f
.
»p
[
k
], f.rep[k-1], f.rep[k]);

63 
	`mul
(
f
.
»p
[0], f.»p[0], -
b
);

64 
	`mul
(
c
, c, 
b
);

65 
	`mul
(
c
, c, 
b
);

66 
	`mul
(
c
, c, 
a
);

67 
	`mul
(
b
, b, 
a
);

69 
i
 >>= 1;

71 
	}
}

78 
	$d”iv©ive_çn_š
(
vec_zz_p
& 
d”
, cÚ¡ 
zz_p
& 
a
, 
n
){

79 
vec_zz_p
 
P
, 
Q
, 
powA
;

80 
zz_p
 
tmp
;

82 
P
.
	`S‘L’gth
(
n
);

83 
Q
.
	`S‘L’gth
(
n
);

84 
powA
.
	`S‘L’gth
(
n
);

85 
d”
.
	`S‘L’gth
(
n
);

88 
powA
[0] = 
	`to_zz_p
(1);

89 
i
 = 1; i < 
n
; i++)

90 
	`mul
(
powA
[
i
],…owA[i-1], 
a
);

93 
P
[0] = 
	`to_zz_p
(1);

94 
i
 = 1; i < 
n
; i++){

95 
	`mul
(
P
[
i
], P[i-1], 
powA
[i-1]);

96 
	`sub
(
tmp
, 
powA
[
i
], 
	`to_zz_p
(1));

97 
	`mul
(
P
[
i
], P[i], 
tmp
);

100 
Q
[
n
-1] = 
	`to_zz_p
(1);

101 
i
 = 
n
-2; i >= 0; i--){

102 
	`sub
(
tmp
, 
powA
[
i
],…owA[
n
-1]);

103 
	`mul
(
Q
[
i
], Q[i+1], 
tmp
);

104 
	`div
(
Q
[
i
], Q[i], 
powA
[
n
-2-i]);

107 
i
 = 0; i < 
n
; i++)

108 
	`mul
(
d”
[
i
], 
P
[i], 
Q
[i]);

109 
	}
}

115 
	gzz_pX_MuÉošt_Geom‘ric
::
	$zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
q
, 
ev®_n
, 
š‹½_n
, 
i0
){

117 
zz_p
 
rho
 = 
q
*q;

118 
this
->
q
 = 
rho
;

119 
this
->
i0
 = i0;

124 
this
->
ev®_n
 =ƒval_n;

125 
this
->
ev®_šv”£_pow”s_squ¬e_q
.
	`S‘L’gth
(
ev®_n
);

126 
this
->
ev®_šv”£_pow”s_squ¬e_q_shiáed
.
	`S‘L’gth
(
ev®_n
);

130 
this
->
ev®_S
.
»p
.
	`S‘L’gth
(2*
ev®_n
-1);

131 
zz_p
 
pow”_q
 = 
	`to_zz_p
(1);

132 
ev®_S
.
»p
[0] = 
	`to_zz_p
(1);

133 
this
->
ev®_šv”£_pow”s_squ¬e_q
[0] = 
	`to_zz_p
(1);

134 
i
 = 1; i < 2*
ev®_n
-1; i++){

135 
zz_p
 
tmp
;

136 
tmp
 = 
ev®_S
.
»p
[
i
-1]*
pow”_q
;

137 
pow”_q
 = 
q
*power_q;

138 
ev®_S
.
»p
[
i
] = 
tmp
*
pow”_q
;

139 ià(
i
 < 
ev®_n
)

140 
this
->
ev®_šv”£_pow”s_squ¬e_q
[
i
] = 
ev®_S
.
»p
[i];

142 
this
->
ev®_S
.
	`nÜm®ize
();

143 
	`šv
(
this
->
ev®_šv”£_pow”s_squ¬e_q
);

146 
zz_p
 
shiá
 = 
	`pow”
(
rho
, 
i0
);

147 
zz_p
 
tmp_shiá
 = 
	`to_zz_p
(1);

148 
i
 = 0; i < 
ev®_n
; i++){

149 
this
->
ev®_šv”£_pow”s_squ¬e_q_shiáed
[
i
] =his->
ev®_šv”£_pow”s_squ¬e_q
[i]*
tmp_shiá
;

150 
tmp_shiá
 =mp_shiá*
shiá
;

154 
k
 = 
	`NextPow”OfTwo
(2*
ev®_n
-1);

155 
	`TofáR•
(
this
->
ev®_S_FFT
,his->
ev®_S
, 
k
);

160 
this
->
n
 = 
š‹½_n
;

161 
this
->
šv”£_pow”s_squ¬e_q
.
	`S‘L’gth
(
š‹½_n
);

162 
this
->
šv”£_pow”s_squ¬e_q_shiáed
.
	`S‘L’gth
(
š‹½_n
);

163 
this
->
šv”£_d”iv©ive
.
	`S‘L’gth
(
š‹½_n
);

167 
	`çn_š
(
this
->
M
, 
rho
, 
š‹½_n
);

168 
	`»v”£
(
this
->
»vM
,his->
M
);

172 
this
->
S
.
»p
.
	`S‘L’gth
(2*
š‹½_n
-1);

173 
pow”_q
 = 
	`to_zz_p
(1);

174 
S
.
»p
[0] = 
	`to_zz_p
(1);

175 
this
->
šv”£_pow”s_squ¬e_q
[0] = 
	`to_zz_p
(1);

176 
i
 = 1; i < 2*
š‹½_n
-1; i++){

177 
zz_p
 
tmp
;

178 
tmp
 = 
S
.
»p
[
i
-1]*
pow”_q
;

179 
pow”_q
 = 
q
*power_q;

180 
S
.
»p
[
i
] = 
tmp
*
pow”_q
;

181 ià(
i
 < 
š‹½_n
)

182 
this
->
šv”£_pow”s_squ¬e_q
[
i
] = 
S
.
»p
[i];

184 
this
->
S
.
	`nÜm®ize
();

185 
	`šv
(
this
->
šv”£_pow”s_squ¬e_q
);

188 
	`d”iv©ive_çn_š
(
this
->
šv”£_d”iv©ive
, 
rho
, 
š‹½_n
);

189 
	`šv
(
this
->
šv”£_d”iv©ive
);

190 
shiá
 = 
	`pow”
(
rho
, 
i0
);

191 
zz_p
 
šv_shiá
 = 1/
shiá
;

192 
zz_p
 
tmp_šv_shiá
 = 
	`to_zz_p
(1);

193 
i
 = 0; i < 
š‹½_n
; i++){

194 
zz_p
 
tmp
;

195 
tmp
 = 
this
->
šv”£_d”iv©ive
[
i
]*this->
šv”£_pow”s_squ¬e_q
[i];

196 
this
->
šv”£_d”iv©ive
[
i
] = 
tmp
*
tmp_šv_shiá
;

197 
tmp_šv_shiá
 =mp_šv_shiá*
šv_shiá
;

201 
k
 = 
	`NextPow”OfTwo
(2*
š‹½_n
-1);

202 
	`TofáR•
(
this
->
S_FFT
, 
S
, 
k
);

203 
	`TofáR•
(
this
->
»vM_FFT
, 
»vM
, 
k
);

206 ià(
ev®_n
 < 200 && 
n
 > 2*eval_n){

207 
M©
<
zz_p
> 
m©1
, 
m©2
;

208 
m©1
.
	`S‘Dims
(
ev®_n
,ƒval_n);

209 
m©2
.
	`S‘Dims
(
ev®_n
,ƒval_n);

210 
zz_p
 
tmp1
, 
tmp2
;

211 
tmp1
 = 
	`pow”
(
rho
, 
i0
);

212 
tmp2
 = 
	`pow”
(
rho
, 
i0
+
ev®_n
);

214 
i
 = 0; i < 
ev®_n
; i++){

215 
zz_p
 
ump1
 = 
	`to_zz_p
(1), 
ump2
 =o_zz_p(1);

216 
j
 = 0; j < 
ev®_n
; j++){

217 
m©1
[
i
][
j
] = 
ump1
;

218 
ump1
 *ğ
tmp1
;

219 
m©2
[
i
][
j
] = 
ump2
;

220 
ump2
 *ğ
tmp2
;

222 
tmp1
 *ğ
rho
;

223 
tmp2
 *ğ
rho
;

225 
	`šv
(
m©1
, mat1);

226 
	`mul
(
shiá_m©rix
, 
m©2
, 
m©1
);

229 
this
->
c
 = 
	`to_zz_p
(1);

230 
±s
.
	`S‘L’gth
(
š‹½_n
);

231 
±s
[0] = 
shiá
;

232 
i
 = 1; i < 
š‹½_n
; i++)

233 
±s
[
i
] = 
rho
*pts[i-1];

235 
	}
}

240 
	gzz_pX_MuÉošt_Geom‘ric
::
	$zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
q
, 
n
, 
i0
è: 
	$zz_pX_MuÉošt_Geom‘ric
(
q
, 
n
,‚, 
i0
) {

241 
	}
}

246 
	gzz_pX_MuÉošt_Geom‘ric
::
	$zz_pX_MuÉošt_Geom‘ric
(cÚ¡ 
zz_p
& 
q
, 
n
, cÚ¡ zz_p& 
c
è: 
	$zz_pX_MuÉošt_Geom‘ric
(
q
, 
n
,‚, 0) {

247 ià(
c
 !ğ
	`to_zz_p
(1)){

248 
this
->
c
 = c;

249 
pow”s_c
.
	`S‘L’gth
(
n
);

250 
šv_pow”s_c
.
	`S‘L’gth
(
n
);

251 
pow”s_c
[0] = 
	`to_zz_p
(1);

252 
i
 = 1; i < 
n
; i++)

253 
pow”s_c
[
i
] = 
c
*powers_c[i-1];

254 
	`šv
(
šv_pow”s_c
, 
pow”s_c
);

256 
i
 = 0; i < 
n
; i++)

257 
±s
[
i
] *ğ
c
;

259 
	}
}

264 
	gzz_pX_MuÉošt_Geom‘ric
::
ev®u©e_Úe
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f
) const{

265 
	gv®
.
S‘L’gth
(
ev®_n
);

267 
zz_pX
 
	gT
;

268 
	gT
.
	g»p
.
S‘L’gth
(
ev®_n
);

270 
	gi
 = 0; i < 
	gev®_n
; i++)

271 
	gT
.
	g»p
[
i
] = 
cÛff
(
f
, 
ev®_n
-1-iè* 
	gev®_šv”£_pow”s_squ¬e_q_shiáed
[eval_n-1-i];

273 
	gT
.
nÜm®ize
();

275 ià(
	gev®_n
 > 
	gNTL_zz_pX_MUL_CROSSOVER
){

276 
	gk
 = 
NextPow”OfTwo
(2*
ev®_n
-1);

277 
fáR•
 
T_FFT
(
INIT_SIZE
, 
k
);

278 
TofáR•
(
T_FFT
, 
T
, 
k
);

279 
mul
(
T_FFT
, T_FFT, 
ev®_S_FFT
);

280 
FromfáR•
(
T
, 
T_FFT
, 
ev®_n
-1, 2*eval_n-2);

283 
	gT
 = 
middË_´oduù
(
ev®_S
, 
T
, 
ev®_n
);

286 
	gi
 = 0; i < 
	gev®_n
; i++)

287 
	gv®
[
i
] = 
cÛff
(
T
, iè* 
	gev®_šv”£_pow”s_squ¬e_q
[i];

293 
	gzz_pX_MuÉošt_Geom‘ric
::
ev®u©e
(
Vec
<
zz_p
>& 
v®
, cÚ¡ 
zz_pX
& 
f_š™
) const {

294 
zz_pX
 
	gf
 = 
f_š™
;

296 ià(
	gc
 !ğ
to_zz_p
(1))

297 
i
 = 0; 
	gi
 <ğ
deg
(
f
); i++)

298 
	gf
.
	g»p
[
i
] *ğ
pow”s_c
[i];

300 ià(
	gn
 == 1){

301 
v®
.
S‘L’gth
(1);

302 
	gv®
[0] = 
cÛff
(
f
, 0);

306 
zz_p
 
	gqpow
 = 
pow”
(
q
, 
ev®_n
);

307 
	gv®
.
S‘L’gth
(0);

308 
	gv®
.
Ëngth
(è< 
	gn
){

309 
	gVec
<
	gzz_p
> 
	gtmp
;

310 
ev®u©e_Úe
(
tmp
, 
f
);

311 
	gv®
.
­³nd
(
tmp
);

312 
zz_p
 
	gshiá
 = 
to_zz_p
(1);

313 
	gi
 = 0; i <ğ
deg
(
f
); i++){

314 
	gf
.
	g»p
[
i
] *ğ
shiá
;

315 
	gshiá
 *ğ
qpow
;

319 
	gv®
.
S‘L’gth
(
n
);

325 
	gzz_pX_MuÉošt_Geom‘ric
::
ev®u©e
(
Vec
<Vec<
zz_p
>>& 
v®
, cÚ¡ Vec<
zz_pX
>& 
f_š™
) const{

327 
	gû¼
 << "geomƒval: ";

328 
	gt
 = 
G‘Time
();

330 ià(
	gshiá_m©rix
.
NumRows
() == 0){

331 
v®
.
S‘L’gth
(
f_š™
.
Ëngth
());

332 
	gi
 = 0; i < 
	gf_š™
.
Ëngth
(); i++)

333 
ev®u©e
(
v®
[
i
], 
f_š™
[i]);

334 
	gû¼
 << 
G‘Time
()-
	gt
 << " usšg shiá " << 
	g’dl
;

338 
	gd
 = 
f_š™
.
Ëngth
();

339 
	gM©
<
	gzz_p
> 
	gcÛff_f
;

340 
	gcÛff_f
.
S‘Dims
(
ev®_n
, 
d
);

341 
	gv®
.
S‘L’gth
(
d
);

343 
	gVec
<
	gzz_p
> 
	gtmp
;

344 
	gtmp
.
S‘L’gth
(
ev®_n
);

345 
	gj
 = 0; j < 
	gd
; j++){

346 
	gv®
[
j
].
S‘L’gth
(
n
);

347 
ev®u©e_Úe
(
tmp
, 
f_š™
[
j
]);

348 
	gi
 = 0; i < 
	gev®_n
; i++){

349 
	gv®
[
j
][
i
] = 
tmp
[i];

350 
	gcÛff_f
[
i
][
j
] = 
tmp
[i];;

354 
	gidx
 = 
ev®_n
;

355 
	gidx
 < 
	gn
){

356 
mul
(
cÛff_f
, 
shiá_m©rix
, coeff_f);

357 
	gi
 = 0; i < 
	gev®_n
; i++)

358 ià(
	gi
+
	gidx
 < 
	gn
)

359 
	gj
 = 0; j < 
	gd
; j++)

360 
	gv®
[
j
][
i
+
idx
] = 
cÛff_f
[i][j];

361 
	gidx
 +ğ
ev®_n
;

364 
	gû¼
 << 
G‘Time
()-
	gt
 << " usšg m©rix " << 
	g’dl
;

371 
	gzz_pX_MuÉošt_Geom‘ric
::
	$š‹½Ş©e
(
zz_pX
& 
f
, cÚ¡ 
vec_zz_p
& 
v®
) const {

373 ià(
n
 == 1){

374 
f
.
»p
.
	`S‘L’gth
(1);

375 
f
.
»p
[0] = 
v®
[0];

376 
f
.
	`nÜm®ize
();

380 
zz_pX
 
PV
;

381 
PV
.
»p
.
	`S‘L’gth
(
n
);

382 
i
 = 0; i < 
n
; i++)

383 
PV
.
»p
[
i
] = 
v®
[i];

384 
PV
.
	`nÜm®ize
();

386 ià(
n
 > 
NTL_zz_pX_MUL_CROSSOVER
){

387 
k
 = 
	`NextPow”OfTwo
(2*
n
-1);

388 
fáR•
 
	`PV_FFT
(
INIT_SIZE
, 
k
);

389 
	`TofáR•
(
PV_FFT
, 
PV
, 
k
);

390 
	`mul
(
PV_FFT
, PV_FFT, 
»vM_FFT
);

391 
	`FromfáR•
(
PV
, 
PV_FFT
, 0, 
n
-1);

394 
	`MulTrunc
(
PV
, PV, 
»vM
, 
n
);

397 
zz_pX
 
R
;

398 
R
.
»p
.
	`S‘L’gth
(
n
);

399 
i
 = 0; i < 
n
; i++)

400 
R
.
»p
[
i
] = 
	`cÛff
(
PV
, iè* 
šv”£_pow”s_squ¬e_q
[
n
-1-i];

401 
R
.
	`nÜm®ize
();

403 ià(
n
 > 
NTL_zz_pX_MUL_CROSSOVER
){

404 
k
 = 
	`NextPow”OfTwo
(2*
n
-1);

405 
fáR•
 
	`R_FFT
(
INIT_SIZE
, 
k
);

406 
	`TofáR•
(
R_FFT
, 
R
, 
k
);

407 
	`mul
(
R_FFT
, R_FFT, 
S_FFT
);

408 
	`FromfáR•
(
R
, 
R_FFT
, 
n
-1, 2*n-2);

411 
R
 = 
	`middË_´oduù
(
S
, R, 
n
);

414 
f
.
»p
.
	`S‘L’gth
(
n
);

415 
i
 = 0; i < 
n
; i++)

416 
f
.
»p
[
i
] = 
	`cÛff
(
R
, iè* 
šv”£_d”iv©ive
[i];

417 ià(
c
 !ğ
	`to_zz_p
(1))

418 
i
 = 0; i < 
n
; i++)

419 
f
.
»p
[
i
] *ğ
šv_pow”s_c
[i];

421 
f
.
	`nÜm®ize
();

422 
	}
}

428 
to_d’£
(
M©
<
zz_p
>& 
M
, cÚ¡ 
zz_pX_MuÉošt_Geom‘ric
& 
X
){

429 
	gn
 = 
X
.
n
;

430 
zz_pX
 
	gf
;

431 
£t
(
f
);

432 
	gVec
<
	gzz_p
> 
	gv
;

433 
	gv
.
S‘L’gth
(
n
);

434 
	gM
.
S‘Dims
(
n
,‚);

436 
	gi
 = 0; i < 
	gn
; i++){

437 
	gX
.
ev®u©e
(
v
, 
f
);

438 
	gj
 = 0; j < 
	gn
; j++)

439 
	gM
[
j
][
i
] = 
v
[j];

440 
	gf
 <<= 1;

	@lzz_pX_CRT/test/test_CRT.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
j
 = 1; j < 20; j++){

18 
Vec
<
zz_pX
> 
v®
, 
q
, 
mmod
;

19 
q
.
	`S‘L’gth
(
j
);

20 
v®
.
	`S‘L’gth
(
j
);

21 
i
 = 0; i < 
j
; i++){

22 
q
[
i
] = 
	`¿ndom_zz_pX
(i*3+5);

23 
v®
[
i
] = 
	`¿ndom_zz_pX
(i*3+5è% 
q
[i];

25 
zz_pX_CRT
 
üt
 = 
	`zz_pX_CRT
(
q
);

26 
zz_pX
 
f
;

27 
üt
.
	`combše
(
f
, 
v®
);

28 
üt
.
	`muÉimod
(
mmod
, 
f
);

29 
i
 = 0; i < 
j
; i++){

30 
cout
 << 
v®
[
i
]-(
f
 % 
q
[i]) << ",";

31 
cout
 << 
mmod
[
i
] - (
f
 % 
q
[i]) << " ";

33 
cout
 << 
’dl
;

35 
	}
}

37 
	$maš
(
¬gc
, ** 
¬gv
){

38 
İt
 = 0;

39 ià(
¬gc
 > 1)

40 
İt
 = 
	`©oi
(
¬gv
[1]);

41 
	`check
(
İt
);

43 
	}
}

	@lzz_pX_CRT/test/test_FFT_evaluate_interpolate.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
zz_p
::
	`FFTIn™
(1);

15 
j
 = 98; j < 200; j+=10){

16 
n
 = 1L << (
	`NextPow”OfTwo
(
j
));

18 
Vec
<
zz_p
> 
v®
, 
±s
;

19 
zz_pX
 
f
, 
X
;

21 
zz_pX_MuÉošt
 * 
ev
;

22 
zz_pX_MuÉošt_FFT
 
	`evQ
(
n
);

23 
ev
 = &
evQ
;

25 
X
 = 0;

26 
	`S‘CÛff
(
X
, 1, 1);

27 
ev
->
	`ev®u©e
(
±s
, 
X
);

29 
f
 = 
	`¿ndom_zz_pX
(
j
);

30 
ev
->
	`ev®u©e
(
v®
, 
f
);

32 
i
 = 0; i < 
n
; i++)

33 ià(
v®
[
i
] !ğ
	`ev®
(
f
, 
±s
[i]))

34 
cout
 << 
j
 << " " << 
i
 << 
’dl
;

36 
zz_pX
 
g
;

37 
ev
->
	`š‹½Ş©e
(
g
, 
v®
);

38 
cout
 << 
f
-
g
 << 
’dl
;

40 
	}
}

42 
	$maš
(
¬gc
, ** 
¬gv
){

43 
İt
 = 0;

44 ià(
¬gc
 > 1)

45 
İt
 = 
	`©oi
(
¬gv
[1]);

46 
	`check
(
İt
);

48 
	}
}

	@lzz_pX_CRT/test/test_evaluate.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


11 
	$check
(
İt
){

13 
p
 = 1125899906842679;

14 
zz_p
::
	`š™
(
p
);

16 ià(
İt
 == 1){

17 
j
 = 1; j < 10; j++){

18 
Vec
<
zz_p
> 
q
;

19 
q
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
j
; i++){

21 
q
[
i
] = 
	`¿ndom_zz_p
();

25 
zz_pX_MuÉošt
 * 
ev
;

26 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

27 
ev
 = &
evQ
;

28 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(2*
j
);

29 
Vec
<
zz_p
> 
v®
;

30 
v®
.
	`S‘L’gth
(
j
);

31 
ev
->
	`ev®u©e
(
v®
, 
f
);

32 
i
 = 0; i < 
j
; i++)

33 
cout
 << 
v®
[
i
]-
	`ev®
(
f
, 
q
[i]) << " ";

34 
cout
 << 
’dl
;

37 
zz_pX_MuÉošt_G’”®
 
	`ev
(
q
);

38 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(2*
j
);

39 
Vec
<
zz_p
> 
v®
;

40 
v®
.
	`S‘L’gth
(
j
);

41 
ev
.
	`ev®u©e
(
v®
, 
f
);

42 
i
 = 0; i < 
j
; i++)

43 
cout
 << 
v®
[
i
]-
	`ev®
(
f
, 
q
[i]) << " ";

44 
cout
 << 
’dl
;

49 
t
;

51 
j
 = 100;

52 
Vec
<
zz_p
> 
q
;

53 
q
.
	`S‘L’gth
(
j
);

54 
i
 = 0; i < 
j
; i++){

55 
q
[
i
] = 
	`¿ndom_zz_p
();

58 
zz_pX_MuÉošt
 * 
ev
;

59 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

60 
ev
 = &
evQ
;

61 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(2*
j
);

62 
Vec
<
zz_p
> 
v®
;

63 
v®
.
	`S‘L’gth
(
j
);

64 
t
 = 
	`G‘Time
();

65 
ev
->
	`ev®u©e
(
v®
, 
f
);

66 
cout
 << 
	`G‘Time
(è- 
t
 << 
’dl
;

69 
zz_pX_MuÉošt_G’”®
 
	`ev
(
q
);

70 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(2*
j
);

71 
Vec
<
zz_p
> 
v®
;

72 
v®
.
	`S‘L’gth
(
j
);

73 
t
 = 
	`G‘Time
();

74 
ev
.
	`ev®u©e
(
v®
, 
f
);

75 
cout
 << 
	`G‘Time
(è- 
t
 << 
’dl
;

78 
	}
}

80 
	$maš
(
¬gc
, ** 
¬gv
){

81 
İt
 = 0;

82 ià(
¬gc
 > 1)

83 
İt
 = 
	`©oi
(
¬gv
[1]);

84 
	`check
(
İt
);

86 
	}
}

	@lzz_pX_CRT/test/test_geometric_evaluate.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/m©_lzz_p.h
>

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
j
 = 10; j < 1100; j++){

20 
Vec
<
zz_p
> 
q
;

21 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

22 
i0
 = 246;

23 
q
.
	`S‘L’gth
(
j
);

24 
i
 = 0; i < 
j
; i++){

25 
q
[
i
] = 
	`pow”
(
a
,2*(i+
i0
));

28 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
j
);

29 
Vec
<
zz_p
> 
v®Q
, 
v®G
;

31 
t
;

33 
zz_pX_MuÉošt
 * 
ev
;

34 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

35 
ev
 = &
evQ
;

37 
cout
 << 
j
 << " ";

39 
t
 = 
	`G‘Time
();

40 
i
 = 0; i < 1000; i++)

41 
ev
->
	`ev®u©e
(
v®Q
, 
f
);

42 
cout
 << 
	`G‘Time
()-
t
 << " ";

44 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
i0
);

45 
ev
 = &
evG
;

46 
t
 = 
	`G‘Time
();

47 
i
 = 0; i < 1000; i++)

48 
ev
->
	`ev®u©e
(
v®G
, 
f
);

49 
cout
 << 
	`G‘Time
()-
t
 << 
’dl
;

50 ià(
v®G
 !ğ
v®Q
)

51 
cout
 << 
j
 << 
’dl
;

58 
	}
}

60 
	$maš
(
¬gc
, ** 
¬gv
){

61 
İt
 = 0;

62 ià(
¬gc
 > 1)

63 
İt
 = 
	`©oi
(
¬gv
[1]);

64 
	`check
(
İt
);

66 
	}
}

	@lzz_pX_CRT/test/test_geometric_evaluate_matrix.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/m©_lzz_p.h
>

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
j
 = 30; j < 100; j++){

20 
nb
 = 
j
*j;

21 
Vec
<
zz_p
> 
q
;

22 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

23 
i0
 = 246;

24 
q
.
	`S‘L’gth
(
nb
);

25 
i
 = 0; i < 
nb
; i++){

26 
q
[
i
] = 
	`pow”
(
a
,2*(i+
i0
));

29 
Vec
<
zz_pX
> 
f
;

30 
f
.
	`S‘L’gth
(
j
);

31 
k
 = 0; k < 
j
; k++)

32 
f
[
k
] = 
	`¿ndom_zz_pX
(
j
);

33 
Vec
<Vec<
zz_p
>> 
v®Q
, 
v®G
;

35 
t
;

37 
zz_pX_MuÉošt
 * 
ev
;

38 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

39 
ev
 = &
evQ
;

41 
cout
 << 
j
 << " ";

43 
t
 = 
	`G‘Time
();

44 
i
 = 0; i < 1; i++)

45 
ev
->
	`ev®u©e
(
v®Q
, 
f
);

46 
cout
 << 
	`G‘Time
()-
t
 << " ";

48 
t
 = 
	`G‘Time
();

49 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
nb
, 
i0
);

50 
cout
 << 
	`G‘Time
()-
t
 << " ";

51 
ev
 = &
evG
;

53 
t
 = 
	`G‘Time
();

54 
i
 = 0; i < 1; i++)

55 
ev
->
	`ev®u©e
(
v®G
, 
f
);

56 
cout
 << 
	`G‘Time
()-
t
 << " ";

57 ià(
v®G
 !ğ
v®Q
)

58 
cout
 << 
j
 << 
’dl
;

60 
cout
 << 
’dl
;

64 
	}
}

66 
	$maš
(
¬gc
, ** 
¬gv
){

67 
İt
 = 0;

68 ià(
¬gc
 > 1)

69 
İt
 = 
	`©oi
(
¬gv
[1]);

70 
	`check
(
İt
);

72 
	}
}

	@lzz_pX_CRT/test/test_geometric_evaluate_shifted.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/m©_lzz_p.h
>

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
j
 = 10; j < 1100; j++){

20 
Vec
<
zz_p
> 
q
;

21 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

22 
zz_p
 
c
 = 
	`¿ndom_zz_p
();

24 
q
.
	`S‘L’gth
(
j
);

25 
i
 = 0; i < 
j
; i++){

26 
q
[
i
] = 
c
*
	`pow”
(
a
,2*i);

29 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
j
);

30 
Vec
<
zz_p
> 
v®Q
, 
v®G
;

32 
t
;

34 
zz_pX_MuÉošt
 * 
ev
;

35 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

36 
ev
 = &
evQ
;

38 
cout
 << 
j
 << " ";

40 
t
 = 
	`G‘Time
();

41 
i
 = 0; i < 1000; i++)

42 
ev
->
	`ev®u©e
(
v®Q
, 
f
);

43 
cout
 << 
	`G‘Time
()-
t
 << " ";

45 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
c
);

46 
ev
 = &
evG
;

47 
t
 = 
	`G‘Time
();

48 
i
 = 0; i < 1000; i++)

49 
ev
->
	`ev®u©e
(
v®G
, 
f
);

50 
cout
 << 
	`G‘Time
()-
t
 << 
’dl
;

51 ià(
v®G
 !ğ
v®Q
)

52 
cout
 << 
j
 << 
’dl
;

54 
	}
}

56 
	$maš
(
¬gc
, ** 
¬gv
){

57 
İt
 = 0;

58 ià(
¬gc
 > 1)

59 
İt
 = 
	`©oi
(
¬gv
[1]);

60 
	`check
(
İt
);

62 
	}
}

	@lzz_pX_CRT/test/test_geometric_evaluate_small_degree.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/m©_lzz_p.h
>

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
j
 = 100; j < 110; j++){

20 
nb
 = 
j
*j;

21 
Vec
<
zz_p
> 
q
;

22 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

23 
i0
 = 246;

24 
q
.
	`S‘L’gth
(
nb
);

25 
i
 = 0; i < 
nb
; i++){

26 
q
[
i
] = 
	`pow”
(
a
,2*(i+
i0
));

29 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
j
);

30 
Vec
<
zz_p
> 
v®Q
, 
v®G
;

32 
t
;

34 
zz_pX_MuÉošt
 * 
ev
;

35 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

36 
ev
 = &
evQ
;

38 
cout
 << 
j
 << " ";

40 
t
 = 
	`G‘Time
();

41 
i
 = 0; i < 10; i++)

42 
ev
->
	`ev®u©e
(
v®Q
, 
f
);

43 
cout
 << 
	`G‘Time
()-
t
 << " ";

45 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
nb
, 
i0
);

46 
ev
 = &
evG
;

47 
t
 = 
	`G‘Time
();

48 
i
 = 0; i < 10; i++)

49 
ev
->
	`ev®u©e
(
v®G
, 
f
);

50 
cout
 << 
	`G‘Time
()-
t
 << " ";

51 ià(
v®G
 !ğ
v®Q
)

52 
cout
 << 
j
 << 
’dl
;

54 
M©
<
zz_p
> 
m©a
, 
m©b
, 
m©c
;

55 
m©a
.
	`S‘Dims
(
j
/2, j/2);

56 
m©b
.
	`S‘Dims
(
j
/2, j);

57 
i
 = 0; i < 
j
/2; i++)

58 
k
 = 0; k < 
j
/2; k++)

59 
m©a
[
i
][
k
] = 
	`¿ndom_zz_p
();

60 
i
 = 0; i < 
j
/2; i++)

61 
k
 = 0; k < 
j
; k++)

62 
m©b
[
i
][
k
] = 
	`¿ndom_zz_p
();

64 
t
 = 
	`G‘Time
();

65 
i
 = 0; i < 10; i++){

66 
k
 = 0; k < 
j
; k++){

67 
	`mul
(
m©c
, 
m©a
, 
m©b
);

68 
	`mul
(
m©c
, 
m©a
, 
m©b
);

71 
t
 = (
	`G‘Time
()-t)/
j
;

72 
cout
 << 
t
 << " ";

75 
cout
 << 
’dl
;

79 
	}
}

81 
	$maš
(
¬gc
, ** 
¬gv
){

82 
İt
 = 0;

83 ià(
¬gc
 > 1)

84 
İt
 = 
	`©oi
(
¬gv
[1]);

85 
	`check
(
İt
);

87 
	}
}

	@lzz_pX_CRT/test/test_geometric_interpolate.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
j
 = 10; j < 110; j++){

18 
Vec
<
zz_p
> 
q
;

19 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

20 
i0
 = 246;

21 
q
.
	`S‘L’gth
(
j
);

22 
i
 = 0; i < 
j
; i++){

23 
q
[
i
] = 
	`pow”
(
a
,2*(i+
i0
));

26 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
j
);

27 
Vec
<
zz_p
> 
v®Q
, 
v®G
;

29 
t
;

31 
zz_pX_MuÉošt
 * 
ev
;

32 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

33 
ev
 = &
evQ
;

35 
cout
 << 
j
 << " ";

37 
t
 = 
	`G‘Time
();

38 
i
 = 0; i < 1000; i++)

39 
ev
->
	`ev®u©e
(
v®Q
, 
f
);

40 
cout
 << 
	`G‘Time
()-
t
 << " ";

42 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
i0
);

43 
ev
 = &
evG
;

44 
t
 = 
	`G‘Time
();

45 
i
 = 0; i < 1000; i++)

46 
ev
->
	`ev®u©e
(
v®G
, 
f
);

47 
cout
 << 
	`G‘Time
()-
t
 << 
’dl
;

48 ià(
v®G
 !ğ
v®Q
)

49 
cout
 << 
j
 << 
’dl
;

51 
zz_pX
 
g
;

52 
ev
->
	`š‹½Ş©e
(
g
, 
v®G
);

53 ià(
g
 !ğ
f
)

54 
cout
 << 
j
 << 
’dl
;

57 
	}
}

59 
	$maš
(
¬gc
, ** 
¬gv
){

60 
İt
 = 0;

61 ià(
¬gc
 > 1)

62 
İt
 = 
	`©oi
(
¬gv
[1]);

63 
	`check
(
İt
);

65 
	}
}

	@lzz_pX_CRT/test/test_geometric_interpolate_shifted.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
j
 = 10; j < 110; j++){

18 
Vec
<
zz_p
> 
q
;

19 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

20 
zz_p
 
c
 = 
	`¿ndom_zz_p
();

21 
q
.
	`S‘L’gth
(
j
);

22 
i
 = 0; i < 
j
; i++){

23 
q
[
i
] = 
c
*
	`pow”
(
a
,2*i);

26 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(
j
);

27 
Vec
<
zz_p
> 
v®Q
, 
v®G
;

29 
t
;

31 
zz_pX_MuÉošt
 * 
ev
;

32 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

33 
ev
 = &
evQ
;

35 
cout
 << 
j
 << " ";

37 
t
 = 
	`G‘Time
();

38 
i
 = 0; i < 1000; i++)

39 
ev
->
	`ev®u©e
(
v®Q
, 
f
);

40 
cout
 << 
	`G‘Time
()-
t
 << " ";

42 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
c
);

43 
ev
 = &
evG
;

44 
t
 = 
	`G‘Time
();

45 
i
 = 0; i < 1000; i++)

46 
ev
->
	`ev®u©e
(
v®G
, 
f
);

47 
cout
 << 
	`G‘Time
()-
t
 << 
’dl
;

48 ià(
v®G
 !ğ
v®Q
)

49 
cout
 << 
j
 << 
’dl
;

51 
zz_pX
 
g
;

52 
ev
->
	`š‹½Ş©e
(
g
, 
v®G
);

53 ià(
g
 !ğ
f
)

54 
cout
 << 
j
 << 
’dl
;

57 
	}
}

59 
	$maš
(
¬gc
, ** 
¬gv
){

60 
İt
 = 0;

61 ià(
¬gc
 > 1)

62 
İt
 = 
	`©oi
(
¬gv
[1]);

63 
	`check
(
İt
);

65 
	}
}

	@lzz_pX_CRT/test/test_geometric_to_dense.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

3 
	~<NTL/m©rix.h
>

4 
	~<NTL/m©_lzz_p.h
>

6 
	~"lzz_pX_CRT.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
p
 = 1125899906842679;

17 
zz_p
::
	`š™
(
p
);

19 
j
 = 30; j < 100; j++){

20 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

21 
i0
 = 246;

22 
zz_pX_MuÉošt_Geom‘ric
 
	`evG
(
a
, 
j
, 
i0
);

23 
M©
<
zz_p
> 
M
;

24 
	`to_d’£
(
M
, 
evG
);

25 
cout
 << 
M
 << 
’dl
;

27 
	}
}

29 
	$maš
(
¬gc
, ** 
¬gv
){

30 
İt
 = 0;

31 ià(
¬gc
 > 1)

32 
İt
 = 
	`©oi
(
¬gv
[1]);

33 
	`check
(
İt
);

35 
	}
}

	@lzz_pX_CRT/test/test_interpolate.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
j
 = 1; j < 10; j++){

18 
Vec
<
zz_p
> 
q
, 
v®
;

19 
q
.
	`S‘L’gth
(
j
);

20 
v®
.
	`S‘L’gth
(
j
);

21 
i
 = 0; i < 
j
; i++){

22 
q
[
i
] = 
	`¿ndom_zz_p
();

23 
v®
[
i
] = 
	`¿ndom_zz_p
();

25 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

26 
zz_pX_MuÉošt
 * 
ev
 = &
evQ
;

28 
zz_pX
 
f
;

29 
ev
->
	`š‹½Ş©e
(
f
, 
v®
);

30 
i
 = 0; i < 
j
; i++)

31 
cout
 << 
v®
[
i
]-
	`ev®
(
f
, 
q
[i]) << " ";

32 
cout
 << 
’dl
;

34 
	}
}

36 
	$maš
(
¬gc
, ** 
¬gv
){

37 
İt
 = 0;

38 ià(
¬gc
 > 1)

39 
İt
 = 
	`©oi
(
¬gv
[1]);

40 
	`check
(
İt
);

42 
	}
}

	@lzz_pX_CRT/test/test_points.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


11 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

16 
j
 = 1; j < 10; j++){

17 
Vec
<
zz_p
> 
q
;

18 
q
.
	`S‘L’gth
(
j
);

19 
i
 = 0; i < 
j
; i++)

20 
q
[
i
] = 
	`¿ndom_zz_p
();

22 
zz_pX_MuÉošt_G’”®
 
	`ev
(
q
);

23 
i
 = 0; i < 
j
; i++){

24 
zz_p
 
±
;

25 
ev
.
	`pošt
(
±
, 
i
);

26 
cout
 << 
±
-
q
[
i
] << " ";

28 
cout
 << 
’dl
;

31 
j
 = 1; j < 10; j++){

32 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

33 
zz_pX_MuÉošt_Geom‘ric
 
	`ev
(
a
, 
j
, 22);

34 
i
 = 0; i < 
j
; i++){

35 
zz_p
 
±
;

36 
ev
.
	`pošt
(
±
, 
i
);

37 
cout
 << 
±
-
	`pow”
(
a
, 2*(
i
+22)) << " ";

39 
cout
 << 
’dl
;

42 
j
 = 1; j < 10; j++){

43 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

44 
zz_p
 
b
 = 
	`¿ndom_zz_p
();

45 
zz_pX_MuÉošt_Geom‘ric
 
	`ev
(
a
, 
j
, 
b
);

46 
i
 = 0; i < 
j
; i++){

47 
zz_p
 
±
;

48 
ev
.
	`pošt
(
±
, 
i
);

49 
cout
 << 
±
 - 
b
*
	`pow”
(
a
, 2*
i
) << " ";

51 
cout
 << 
’dl
;

54 
j
 = 1; j < 20; j=2*j){

55 
zz_pX_MuÉošt_FFT
 
	`ev
(
j
);

56 
Vec
<
zz_p
> 
±s
;

57 
zz_pX
 
X
;

58 
X
 = 0;

59 
	`S‘CÛff
(
X
, 1, 1);

60 
ev
.
	`ev®u©e
(
±s
, 
X
);

61 
i
 = 0; i < 
j
; i++){

62 
zz_p
 
±
;

63 
ev
.
	`pošt
(
±
, 
i
);

64 
cout
 << 
±
 - 
±s
[
i
] << " ";

66 
cout
 << 
’dl
;

69 
	}
}

71 
	$maš
(
¬gc
, ** 
¬gv
){

72 
İt
 = 0;

73 ià(
¬gc
 > 1)

74 
İt
 = 
	`©oi
(
¬gv
[1]);

75 
	`check
(
İt
);

77 
	}
}

	@lzz_pX_CRT/test/test_zz_pX_Multipoint.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
j
 = 1; j < 10; j++){

18 
Vec
<
zz_p
> 
q
;

19 
q
.
	`S‘L’gth
(
j
);

20 
i
 = 0; i < 
j
; i++){

21 
q
[
i
] = 
	`¿ndom_zz_p
();

23 
zz_pX_MuÉošt
 * 
ev
;

25 
zz_pX_MuÉošt_G’”®
 
	`evQ
(
q
);

26 
ev
 = &
evQ
;

27 
cout
 << 
ev
->
	`Ëngth
(è<< 
’dl
;

30 
	}
}

32 
	$maš
(
¬gc
, ** 
¬gv
){

33 
İt
 = 0;

34 ià(
¬gc
 > 1)

35 
İt
 = 
	`©oi
(
¬gv
[1]);

36 
	`check
(
İt
);

38 
	}
}

	@lzz_pX_middle_product/lzz_pX_middle_product.h

1 #iâdeà
__LZZ_PX_MIDDLE_PRODUCT__H


2 
	#__LZZ_PX_MIDDLE_PRODUCT__H


	)

4 
	#KARX
 (32)

	)

6 
	~<NTL/lzz_pX.h
>

8 
NTL_CLIENT


13 
tPÏšMul
(
zz_p
 *
xp
, cÚ¡ zz_°*
­
, cÚ¡ zz_°*
bp
, 
N
);

18 
K¬_¡k_size
(
N
);

23 
tK¬Mul_aux
(
zz_p
 *
b
, cÚ¡ 
sb
, cÚ¡ zz_°*
a
, cÚ¡ 
§
, cÚ¡ zz_°*
c
, cÚ¡ 
sc
, zz_°*
¡k
);

29 
middË_FFT
(
zz_pX
& 
x
, cÚ¡ zz_pX& 
a
, cÚ¡ zz_pX& 
b
, 
N
);

38 
zz_pX
 
middË_´oduù
(cÚ¡ zz_pX& 
c
, cÚ¡ zz_pX& 
a
, 
N
);

	@lzz_pX_middle_product/src/lzz_pX_middle_product.cpp

1 
	~<NTL/lzz_pX.h
>

3 
	~"lzz_pX_middË_´oduù.h
"

5 
NTL_CLIENT


17 
zz_pX
 
	$»v
(cÚ¡ 
zz_pX
& 
a
, 
d
){

18 
zz_pX
 
rA
;

19 ià(
	`deg
(
a
è>ğ
d
)

20 
	`E¼Ü
("degreeoo†argeo„everse");

21 
rA
.
»p
.
	`S‘L’gth
(
d
);

22 
i
 = 0; i < 
d
; i++)

23 
rA
.
»p
[
i
] = 
	`cÛff
(
a
, 
d
-1-i);

24 
rA
.
	`nÜm®ize
();

25  
rA
;

26 
	}
}

31 
	$tPÏšMul2
(
zz_p
 *
b
, 
sb
, cÚ¡ zz_°*
a
, 
§
, cÚ¡ zz_°*
c
, 
sc
){

32 
p
 = 
zz_p
::
	`modulus
();

33 
mulmod_t
 
pšv
 = 
	`P»pMulMod
(
p
);

35 
i
 = 0; i < 
sb
; i++)

36 
b
[
i
].
	`LoİHŞe
() = 0;

38 
i
 = 0; i < 
§
; i++) {

39 
ai
 = 
	`»p
(
a
[
i
]);

40 
mulmod_´ecÚ_t
 
­šv
 = 
	`P»pMulModP»cÚ
(
ai
, 
p
, 
pšv
);

41 
j
 = 0; j < 
sb
; j++)

42 
b
[
j
].
	`LoİHŞe
(èğ
	`AddMod
(
	`MulModP»cÚ
(
	`»p
(
c
[
i
+j]), 
ai
, 
p
, 
­šv
),„ep(b[j]),…);

44 
	}
}

49 
	$K¬_¡k_size
(
N
){

50 
n
, 
hn
, 
¥
;

51 
n
 = 
N
;

52 
¥
 = 0;

54 
hn
 = (
n
+1) >> 1;

55 
¥
 +ğ(
hn
 << 2) - 1;

56 
n
 = 
hn
;

57 } 
n
 >ğ
KARX
);

58  
¥
;

59 
	}
}

64 
šlše
 
	$K¬Sub
(
zz_p
 *
T
, cÚ¡ zz_°*
b
, cÚ¡ 
sb
){

65 
p
 = 
zz_p
::
	`modulus
();

67 
i
 = 0; i < 
sb
; i++)

68 
T
[
i
].
	`LoİHŞe
(èğ
	`SubMod
(
	`»p
(T[i]),„•(
b
[i]), 
p
);

69 
	}
}

74 
šlše
 
	$K¬FŞdSub
(
zz_p
 *
T
, cÚ¡ zz_°*
b
, cÚ¡ 
sb
, cÚ¡ 
h§
){

75 
p
 = 
zz_p
::
	`modulus
();

76 
m
 = 
sb
 - 
h§
;

77 
i
;

79 
i
 = 0; i < 
m
; i++)

80 
T
[
i
].
	`LoİHŞe
(èğ
	`SubMod
(
	`»p
(
b
[
h§
+i]),„•(b[i]), 
p
);

81 
i
 = 
m
; i < 
h§
; i++)

82 
T
[
i
].
	`LoİHŞe
(èğ
	`SubMod
(0, 
	`»p
(
b
[i]), 
p
);

83 
	}
}

88 
šlše
 
	$K¬Add2
(
zz_p
 *
T
, cÚ¡ zz_°*
a
, cÚ¡ zz_°*
b
, cÚ¡ 
s
){

89 
p
 = 
zz_p
::
	`modulus
();

90 
i
 = 0; i < 
s
; i++)

91 
T
[
i
].
	`LoİHŞe
(èğ
	`AddMod
(
	`»p
(
a
[i]),„•(
b
[i]), 
p
);

92 
	}
}

97 
šlše
 
	$K¬Add
(
zz_p
 *
T
, cÚ¡ zz_°*
b
, cÚ¡ 
sb
){

98 
p
 = 
zz_p
::
	`modulus
();

99 
i
 = 0; i < 
sb
; i++)

100 
T
[
i
].
	`LoİHŞe
(èğ
	`AddMod
(
	`»p
(T[i]),„•(
b
[i]), 
p
);

101 
	}
}

106 
	$tK¬Mul_aux
(
zz_p
 *
b
, cÚ¡ 
sb
, cÚ¡ zz_°*
a
, cÚ¡ 
§
, cÚ¡ zz_°*
c
, cÚ¡ 
sc
, zz_°*
¡k
){

108 ià(
§
 < 
KARX
 || 
sb
 < KARX){

109 
	`tPÏšMul2
(
b
, 
sb
, 
a
, 
§
, 
c
, 
sc
);

113 
h§
 = (
§
 + 1) >> 1;

114 
hsb
 = (
sb
 + 1) >> 1;

117 ià(
§
 >ğ
sb
 && sb <ğ
h§
) {

118 
zz_p
 *
T
 = 
¡k
;

119 
¡k
 +ğ
sb
;

120 
	`tK¬Mul_aux
(
b
, 
sb
, 
a
+
h§
, 
§
-h§, 
c
+h§, 
sc
-h§, 
¡k
);

121 
	`tK¬Mul_aux
(
T
, 
sb
, 
a
, 
h§
, 
c
, 
	`mš
(sb+h§-1,
sc
), 
¡k
);

122 
	`K¬Add
(
b
, 
T
, 
sb
);

127 ià(
§
 < 
sb
 && s¨<ğ
hsb
) {

128 
	`tK¬Mul_aux
(
b
, 
hsb
, 
a
, 
§
, 
c
, 
	`mš
(§+hsb-1,
sc
), 
¡k
);

129 
	`tK¬Mul_aux
(
b
+
hsb
, 
sb
 - hsb, 
a
, 
§
, 
c
+hsb, 
sc
-hsb, 
¡k
);

133 
hs
;

134 ià(
§
 < 
sb
)

135 
hs
 = 
hsb
;

137 
hs
 = 
h§
;

138 
hs2
 = 
hs
 << 1;

139 
hs3
 = 
hs2
 + 
hs
;

141 
zz_p
 *
T
 = 
¡k
;

142 
¡k
 +ğ
hs3
;

143 
zz_p
 *
T1
 = 
T
+
hs
;

144 
zz_p
 *
T2
 = 
T1
+
hs
;

146 
	`K¬FŞdSub
(
T
, 
a
, 
§
, 
hs
);

147 
	`tK¬Mul_aux
(
b
, 
hs
, 
T
, hs, 
c
+hs, 
	`mš
(
hs2
-1,
sc
-hs), 
¡k
);

149 
i
 = 
sc
 - 
hs
;

150 
	`K¬Add2
(
T
, 
c
 + 
hs
, c, 
i
);

151 ; 
i
 < 
	`mš
(
sc
, 
§
+
sb
-1-
hs
); ++i)

152 
T
[
i
] = 
c
[i];

153 ; 
i
 < 
§
+
sb
-1-
hs
; ++i)

154 
T
[
i
] = 0;

155 
	`tK¬Mul_aux
(
b
+
hs
, 
sb
 - hs, 
a
+hs, 
§
-hs, 
T1
, sa+sb-1-
hs2
, 
¡k
);

157 
	`K¬Sub
(
b
+
hs
, b, 
sb
-hs);

158 
	`tK¬Mul_aux
(
T2
, 
hs
, 
a
, hs, 
T
, 
hs2
-1, 
¡k
);

159 
	`K¬Add
(
b
, 
T2
, 
hs
);

160 
	}
}

168 
	$middË_FFT
(
zz_pX
& 
x
, cÚ¡ zz_pX& 
a
, cÚ¡ zz_pX& 
b
, 
N
){

169 
k
 = 
	`NextPow”OfTwo
(2*
N
-1);

170 
fáR•
 
	`R1
(
INIT_SIZE
, 
k
), 
	`R2
(INIT_SIZE, k);

171 
	`TofáR•
(
R1
, 
a
, 
k
);

172 
	`TofáR•
(
R2
, 
b
, 
k
);

173 
	`mul
(
R1
, R1, 
R2
);

174 
	`FromfáR•
(
x
, 
R1
, 
N
-1, 2*N-2);

175 
	}
}

186 
zz_pX
 
	$middË_´oduù
(cÚ¡ 
zz_pX
& 
c
, cÚ¡ zz_pX& 
a
, 
N
){

188 
zz_pX
 
b
;

190 ià(
c
 =ğ0 || 
a
 == 0){

191 
	`ş—r
(
b
);

192  
b
;

195 ià(
	`deg
(
c
è>ğ2*
N
-1 || deg(
a
) >= N)

196 
	`E¼Ü
("degree mismatch for middle…roduct");

198 ià(
N
 > 
NTL_zz_pX_MUL_CROSSOVER
){

199 
	`middË_FFT
(
b
, 
a
, 
c
, 
N
);

200  
b
;

203 
zz_p
 *
­
 = 
Ãw
 zz_p[
N
];

204 cÚ¡ 
šd_a
 = 
N
-(
	`deg
(
a
)+1);

205 cÚ¡ 
zz_p
 *
cf_a
 = 
a
.
»p
.
	`–ts
();

206 
i
 = 0; i < 
šd_a
; i++)

207 
­
[
i
] = 0;

208 
i
 = 
šd_a
; i < 
N
; i++)

209 
­
[
i
] = 
cf_a
[
N
-1-i];

211 
zz_p
 *
bp
 = 
Ãw
 zz_p[
N
];

213 
zz_p
 *
ı
 = 
Ãw
 zz_p[2*
N
-1];

214 cÚ¡ 
šd_c
 = 
	`deg
(
c
)+1;

215 cÚ¡ 
zz_p
 *
cf_c
 = 
c
.
»p
.
	`–ts
();

216 
i
 = 0; i < 
šd_c
; i++)

217 
ı
[
i
] = 
cf_c
[i];

218 
i
 = 
šd_c
; i < 2*
N
-1; i++)

219 
ı
[
i
] = 0;

221 ià(
N
 < 
KARX
){

222 
	`tPÏšMul2
(
bp
, 
N
, 
­
, N, 
ı
, 2*N-1);

225 
¥
 = 
	`K¬_¡k_size
(
N
);

226 
zz_p
 *
¡k
 = 
Ãw
 zz_p[
¥
];

227 
	`tK¬Mul_aux
(
bp
, 
N
, 
­
, N, 
ı
, 2*N-1, 
¡k
);

228 
d–‘e
[] 
¡k
;

231 
b
.
»p
.
	`S‘L’gth
(
N
);

232 
zz_p
 *
cf_b
 = 
b
.
»p
.
	`–ts
();

233 
i
 = 0; i < 
N
; i++)

234 
cf_b
[
i
] = 
bp
[i];

236 
b
.
	`nÜm®ize
();

238 
d–‘e
[] 
­
;

239 
d–‘e
[] 
bp
;

240 
d–‘e
[] 
ı
;

242  
b
;

243 
	}
}

	@lzz_pX_middle_product/test/test_middle_product_FFT.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<as£¹.h
>

4 
	~"lzz_pX_middË_´oduù.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i
 = 1; i < 10000; i += 1){

17 
zz_pX
 
a
, 
b
, 
c
;

18 
a
 = 
	`¿ndom_zz_pX
(2*
i
-1);

19 
b
 = 
	`¿ndom_zz_pX
(
i
);

21 ià(
İt
 == 1){

22 
c
 = 
	`middË_´oduù
(
a
, 
b
, 
i
);

23 
	`as£¹
 (
c
 =ğ
	`Œunc
(
	`RightShiá
(
a
*
b
, 
i
-1), i));

26 
cout
 << 
i
 << " ";

28 
t
;

30 
t
 = 
	`G‘Time
();

31 
j
 = 0; j < 1000; j++)

32 
c
 = 
	`middË_´oduù
(
a
, 
b
, 
i
);

33 
t
 = 
	`G‘Time
() -;

34 
cout
 << 
t
 << " ";

36 
t
 = 
	`G‘Time
();

37 
j
 = 0; j < 1000; j++)

38 
a
 = 
b
*
c
;

39 
t
 = 
	`G‘Time
() -;

40 
cout
 << 
t
 << " ";

42 
cout
 << 
’dl
;

45 
	}
}

52 
	$maš
(
¬gc
, ** 
¬gv
){

53 
İt
 = 0;

54 ià(
¬gc
 > 1)

55 
İt
 = 
	`©oi
(
¬gv
[1]);

56 
	`check
(
İt
);

59 
	}
}

	@lzz_pX_middle_product/test/test_middle_product_non_FFT.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<as£¹.h
>

4 
	~"lzz_pX_middË_´oduù.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`š™
(1125899906842624);

15 
i
 = 1; i < 10000; i += 1){

17 
zz_pX
 
a
, 
b
, 
c
;

18 
a
 = 
	`¿ndom_zz_pX
(2*
i
-1);

19 
b
 = 
	`¿ndom_zz_pX
(
i
);

21 ià(
İt
 == 1){

22 
c
 = 
	`middË_´oduù
(
a
, 
b
, 
i
);

23 
	`as£¹
 (
c
 =ğ
	`Œunc
(
	`RightShiá
(
a
*
b
, 
i
-1), i));

26 
cout
 << 
i
 << " ";

28 
t
;

30 
t
 = 
	`G‘Time
();

31 
j
 = 0; j < 100000; j++)

32 
c
 = 
	`middË_´oduù
(
a
, 
b
, 
i
);

33 
t
 = 
	`G‘Time
() -;

34 
cout
 << 
t
 << " ";

36 
t
 = 
	`G‘Time
();

37 
j
 = 0; j < 100000; j++)

38 
a
 = 
b
*
c
;

39 
t
 = 
	`G‘Time
() -;

40 
cout
 << 
t
 << " ";

42 
cout
 << 
’dl
;

45 
	}
}

52 
	$maš
(
¬gc
, ** 
¬gv
){

53 
İt
 = 0;

54 ià(
¬gc
 > 1)

55 
İt
 = 
	`©oi
(
¬gv
[1]);

56 
	`check
(
İt
);

59 
	}
}

	@lzz_p_extra/lzz_p_extra.h

1 #iâdeà
__LZZ_P_EXTRA__H


2 
	#__LZZ_P_EXTRA__H


	)

4 
NTL_CLIENT


10 
Üd”
(cÚ¡ 
zz_p
& 
a
);

16 
–em’t_of_Üd”
(
zz_p
& 
a
, 
Üd
);

	@lzz_p_extra/src/lzz_p_extra.cpp

1 
	~<NTL/lzz_p.h
>

3 
	~"lzz_p_exŒa.h
"

5 
NTL_CLIENT


12 
	$Üd”
(cÚ¡ 
zz_p
& 
a
){

13 ià(
a
 == 0)

15 
o
 = 1;

16 
zz_p
 
­
 = 
a
;

17 
­
 != 1){

18 
­
 *ğ
a
;

19 
o
++;

21  
o
;

22 
	}
}

28 
	$–em’t_of_Üd”
(
zz_p
& 
a
, 
Üd
){

30 
p
 = 
zz_p
::
	`modulus
();

31 ià((
p
-1è< 
Üd
)

32 
	`LogicE¼Ü
("orderoo†arge with„especto…\n");

35 
a
 = 
	`¿ndom_zz_p
();

36 
ok
 = 1;

37 
zz_p
 
­
 = 
a
;

38 
i
 = 1; i < 
Üd
; i++){

39 ià(
­
 == 1)

40 
ok
 = 0;

41 
­
 *ğ
a
;

43 ià(
ok
 == 1)

46 
	}
}

	@lzz_p_extra/test/test_element_of_order.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


11 
	$check
(
İt
){

13 
p
 = 101;

14 
zz_p
::
	`š™
(
p
);

15 
zz_p
 
a
;

17 
Üd
 = 100;

18 
	`–em’t_of_Üd”
(
a
, 
Üd
);

20 
i
 = 1; i <ğ
Üd
; i++)

21 
cout
 << (
	`pow”
(
a
, 
i
) == 1) << " ";

23 
cout
 << 
’dl
;

25 
	}
}

27 
	$maš
(
¬gc
, ** 
¬gv
){

28 
İt
 = 0;

29 ià(
¬gc
 > 1)

30 
İt
 = 
	`©oi
(
¬gv
[1]);

31 
	`check
(
İt
);

33 
	}
}

	@lzz_p_extra/test/test_order.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"lzz_pX_CRT.h
"

6 
NTL_CLIENT


11 
	$check
(
İt
){

13 
p
 = 1125899906842679;

14 
zz_p
::
	`š™
(
p
);

15 
zz_p
 
a
;

17 
a
 = 
	`to_zz_p
(-1);

18 
cout
 << 
	`Üd”
(
a
è<< 
’dl
;

20 
a
 = 
	`¿ndom_zz_p
();

21 
cout
 << 
	`Üd”
(
a
è<< 
’dl
;

22 
	}
}

24 
	$maš
(
¬gc
, ** 
¬gv
){

25 
İt
 = 0;

26 ià(
¬gc
 > 1)

27 
İt
 = 
	`©oi
(
¬gv
[1]);

28 
	`check
(
İt
);

30 
	}
}

	@magma_output/magma_output.h

1 #iâdeà
MAGMA_OUTPUT__H


2 
	#MAGMA_OUTPUT__H


	)

4 
	~<NTL/ZZX.h
>

5 
	~<NTL/lzz_pX.h
>

6 
	~<NTL/veùÜ.h
>

8 
NTL_CLIENT


20 
magma_ouut
(cÚ¡ 
Vec
<
ZZ
> & 
v
);

25 
magma_assign
(cÚ¡ 
Vec
<
ZZ
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

30 
magma_š™_ZZX
();

35 
magma_ouut
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

40 
magma_ouut
(cÚ¡ 
ZZX
 & 
v
);

45 
magma_assign
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

50 
magma_assign
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

55 
magma_ouut
(cÚ¡ 
Vec
<> & 
v
);

60 
magma_assign
(cÚ¡ 
Vec
<> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

65 
magma_š™
();

70 
magma_š™_X
();

75 
magma_ouut
(cÚ¡ 
Vec
<
zz_p
> & 
v
);

80 
magma_assign
(cÚ¡ 
Vec
<
zz_p
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

85 
magma_ouut
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

90 
magma_ouut
(cÚ¡ 
zz_pX
 & 
v
);

95 
magma_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

100 
magma_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

106 
magma_ouut
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

111 
magma_ouut
(cÚ¡ 
Vec
<
zz_pX
> & 
v
);

116 
magma_assign
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

121 
magma_assign
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

	@magma_output/src/magma_output.cpp

1 
	~<NTL/ZZX.h
>

2 
	~<NTL/lzz_pX.h
>

3 
	~<NTL/veùÜ.h
>

5 
NTL_CLIENT


10 
magma_ouut
(cÚ¡ 
Vec
<
ZZ
> & 
v
){

11 ià(
	gv
.
Ëngth
() == 0){

12 
cout
 << "[]";

15 
	gcout
 << "[";

16 
	gi
 = 0; i < 
	gv
.
Ëngth
()-1; i++)

17 
	gcout
 << 
	gv
[
i
] << ", ";

18 
	gcout
 << 
	gv
[
v
.
Ëngth
()-1] << "]";

24 
magma_assign
(cÚ¡ 
Vec
<
ZZ
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

25 
	gcout
 << 
	gÇme
 << " := ";

26 
magma_ouut
(
v
);

27 
	gcout
 << ";" << 
	g’dl
;

33 
	$magma_š™_ZZX
(){

34 
cout
 << "U<XX> := PolynomialRing(Integers());\n";

35 
	}
}

40 
	$magma_ouut
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
){

41 
cout
 << "(P¬’t(" << 
v¬
 << ")!(0)";

42 
i
 = 0; i <ğ
	`deg
(
v
); i++)

43 
cout
 << "+(" << 
	`cÛff
(
v
, 
i
è<< ")*" << 
v¬
 << "^" << i;

44 
cout
 << ")";

45 
	}
}

50 
	$magma_ouut
(cÚ¡ 
ZZX
 & 
v
){

51 
	`magma_ouut
(
v
, "XX");

52 
	}
}

57 
	$magma_assign
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
){

58 
cout
 << 
Çme
 << " := ";

59 
	`magma_ouut
(
v
, 
v¬
);

60 
cout
 << ";" << 
’dl
;

61 
	}
}

66 
	$magma_assign
(cÚ¡ 
ZZX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

67 
	`magma_assign
(
v
, "XX", 
Çme
);

68 
	}
}

74 
magma_ouut
(cÚ¡ 
Vec
<> & 
v
){

75 ià(
	gv
.
Ëngth
() == 0){

76 
cout
 << "[]";

79 
	gcout
 << "[";

80 
	gi
 = 0; i < 
	gv
.
Ëngth
()-1; i++)

81 
	gcout
 << 
	gv
[
i
] << ", ";

82 
	gcout
 << 
	gv
[
v
.
Ëngth
()-1] << "]";

88 
magma_assign
(cÚ¡ 
Vec
<> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

89 
	gcout
 << 
	gÇme
 << " := ";

90 
magma_ouut
(
v
);

91 
	gcout
 << ";" << 
	g’dl
;

97 
	$magma_š™
(){

98 
cout
 << "k :ğGF(" << 
zz_p
::
	`modulus
() << ");\n";

99 
	}
}

104 
	$magma_š™_X
(){

105 
cout
 << "U<x> := PolynomialRing(k);\n";

106 
	}
}

111 
magma_ouut
(cÚ¡ 
Vec
<
zz_p
> & 
v
){

112 ià(
	gv
.
Ëngth
() == 0){

113 
cout
 << "[]";

116 
	gcout
 << "[";

117 
	gi
 = 0; i < 
	gv
.
Ëngth
()-1; i++)

118 
	gcout
 << 
	gv
[
i
] << ", ";

119 
	gcout
 << 
	gv
[
v
.
Ëngth
()-1] << "]";

125 
magma_assign
(cÚ¡ 
Vec
<
zz_p
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

126 
	gcout
 << 
	gÇme
 << " := ";

127 
magma_ouut
(
v
);

128 
	gcout
 << ";" << 
	g’dl
;

134 
	$magma_ouut
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
){

135 
cout
 << "(P¬’t(" << 
v¬
 << ")!(0)";

136 
i
 = 0; i <ğ
	`deg
(
v
); i++)

137 
cout
 << "+(" << 
	`cÛff
(
v
, 
i
è<< ")*" << 
v¬
 << "^" << i;

138 
cout
 << ")";

139 
	}
}

144 
	$magma_ouut
(cÚ¡ 
zz_pX
 & 
v
){

145 
cout
 << "U!(";

146 
	`magma_ouut
(
v
.
»p
);

147 
cout
 << ")";

148 
	}
}

153 
	$magma_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
){

154 
cout
 << 
Çme
 << " := ";

155 
	`magma_ouut
(
v
, 
v¬
);

156 
cout
 << ";" << 
’dl
;

157 
	}
}

162 
	$magma_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

163 
	`magma_assign
(
v
, "x", 
Çme
);

164 
	}
}

169 
magma_ouut
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
v¬
){

170 
	gcout
 << "[";

171 
	gi
 = 0; i < 
	gv
.
Ëngth
(); i++){

172 
magma_ouut
(
v
[
i
]);

173 ià(
	gi
 < 
	gv
.
Ëngth
()-1)

174 
	gcout
 << ", ";

176 
	gcout
 << "]";

182 
magma_ouut
(cÚ¡ 
Vec
<
zz_pX
> & 
v
){

183 
magma_ouut
(
v
, "x");

189 
magma_assign
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
){

190 
	gcout
 << 
	gÇme
 << ":=";

191 
magma_ouut
(
v
, 
v¬
);

192 
	gcout
 << ";\n";

198 
magma_assign
(cÚ¡ 
Vec
<
zz_pX
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

199 
magma_assign
(
v
, "x", 
Çme
);

	@magma_output/test/test_magma_output.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"magma_ouut.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
	`magma_š™
();

18 
	`magma_š™_X
();

20 
Vec
<
zz_p
> 
v
;

21 
v
.
	`S‘L’gth
(10);

22 
i
 = 0; i < 
v
.
	`Ëngth
(); i++)

23 
v
[
i
] = 
	`¿ndom_zz_p
();

24 
	`magma_assign
(
v
, "v");

26 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(10);

27 
	`magma_assign
(
f
, "f");

28 
	`magma_ouut
(
f
, "x");

29 
cout
 << ";\n";

30 
	}
}

32 
	$maš
(
¬gc
, ** 
¬gv
){

33 
İt
 = 0;

34 ià(
¬gc
 > 1)

35 
İt
 = 
	`©oi
(
¬gv
[1]);

36 
	`check
(
İt
);

38 
	}
}

	@mat_lzz_pX_extra/mat_lzz_pX_extra.h

1 #iâdeà
MAT_LZZ_PX_EXTRA__H


2 
	#MAT_LZZ_PX_EXTRA__H


	)

4 
	~<NTL/m©rix.h
>

5 
	~<NTL/lzz_pX.h
>

7 
NTL_CLIENT


12 
magma_ouut
(cÚ¡ 
M©
<
zz_pX
>& 
a
, cÚ¡ 
¡ršg
 & 
v¬
);

17 
magma_assign
(cÚ¡ 
M©
<
zz_pX
>& 
a
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

22 
¿ndom_m©_zz_pX
(
M©
<
zz_pX
>& 
a
, 
n
, 
m
, 
d
);

27 
deg
(cÚ¡ 
M©
<
zz_pX
> & 
a
);

32 
muÉly_waksmª
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
);

33 
muÉly_Çive
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
);

34 
muÉly_ev®u©e
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
);

	@mat_lzz_pX_extra/src/mat_lzz_pX_extra.cpp

1 
	~<NTL/m©rix.h
>

2 
	~<NTL/m©_lzz_p.h
>

3 
	~<NTL/lzz_pX.h
>

5 
	~"magma_ouut.h
"

6 
	~"lzz_pX_CRT.h
"

7 
	~"lzz_p_exŒa.h
"

9 
NTL_CLIENT


14 
magma_ouut
(cÚ¡ 
M©
<
zz_pX
>& 
a
, cÚ¡ 
¡ršg
 & 
v¬
){

15 
	gcout
 << "Matrix([";

16 
	gi
 = 0; i < 
	ga
.
NumRows
(); i++){

17 
	gcout
 << "[";

18 
	gj
 = 0; j < 
	ga
.
NumCŞs
(); j++){

19 
magma_ouut
(
a
[
i
][
j
], 
v¬
);

20 ià(
	gj
 < 
	ga
.
NumCŞs
()-1)

21 
	gcout
 << ", ";

23 
	gcout
 << "]";

24 ià(
	gi
 < 
	ga
.
NumRows
()-1)

25 
	gcout
 << ", ";

27 
	gcout
 << "])";

33 
magma_assign
(cÚ¡ 
M©
<
zz_pX
>& 
a
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
){

34 
	gcout
 << 
	gÇme
 << ":=";

35 
magma_ouut
(
a
, 
v¬
);

36 
	gcout
 << ";\n";

42 
¿ndom_m©_zz_pX
(
M©
<
zz_pX
>& 
a
, 
n
, 
m
, 
d
){

43 
	ga
.
S‘Dims
(
n
, 
m
);

44 
	gi
 = 0; i < 
	gn
; i++)

45 
	gj
 = 0; j < 
	gm
; j++)

46 
	ga
[
i
][
j
] = 
¿ndom_zz_pX
(
d
);

52 
deg
(cÚ¡ 
M©
<
zz_pX
> & 
a
){

53 
	gd
 = -1;

54 
	gi
 = 0; i < 
	ga
.
NumRows
(); i++)

55 
	gj
 = 0; j < 
	ga
.
NumCŞs
(); j++)

56 
	gd
 = 
max
(
d
, 
deg
(
a
[
i
][
j
]));

58  
	gd
;

66 
muÉly_waksmª
(
M©
<
zz_pX
> &
C
, cÚ¡ M©<zz_pX> &
A
, cÚ¡ M©<zz_pX> &
B
){

67 
	gVec
<
	gzz_pX
> 
	gArow
, 
	gAcŞ
, 
	gD
, 
	gE
;

68 
zz_pX
 
	gv®0
, 
	gv®1
, 
	gv®2
, 
	güow
;

70 
	gm
 = 
A
.
NumRows
();

71 
	gn
 = 
A
.
NumCŞs
();

72 
	gp
 = 
B
.
NumCŞs
();

74 
	gC
.
S‘Dims
(
m
, 
p
);

76 
	gD
.
S‘L’gth
(
p
);

77 
	gE
.
S‘L’gth
(
m
);

79 
	gÅ
 = 
n
>>1;

81 
	gj
=1; j<=
Å
; j++){

82 cÚ¡ 
	gj2
=(
j
<<1)-1;

84 
	gk
=0; k<
	gp
; k++){

85 
	gC
[0][
k
] +ğ(
A
[0][
j2
-1]+
B
[j2][k]) * (A[0][j2]+B[j2-1][k]);

86 
	gD
[
k
] +ğ(
A
[0][
j2
-1]-
B
[j2][k]) * (A[0][j2]-B[j2-1][k]);

89 
	gl
=1;†<
	gm
;†++){

90 
	gC
[
l
][0] +ğ(
A
[l][
j2
-1]+
B
[j2][0]) * (A[l][j2]+B[j2-1][0]);

91 
	gE
[
l
] +ğ(
A
[l][
j2
-1]-
B
[j2][0]) * (A[l][j2]-B[j2-1][0]);

94 
	gk
=1; k<
	gp
; k++)

95 
	gl
=1;†<
	gm
;†++)

96 
	gC
[
l
][
k
] +ğ(
A
[l][
j2
-1]+
B
[j2][k]) * (A[l][j2]+B[j2-1][k]);

99 
	gl
=1;†<
	gm
;†++){

100 
	gE
[
l
] = (
E
[l]+
C
[l][0])/2;

101 
	gC
[
l
][0] -ğ
E
[l];

104 
	gv®0
 = (
D
[0]+
C
[0][0])/2;

105 
	gC
[0][0] -ğ
v®0
;

106 
	gk
=1; k<
	gp
; k++){

107 
	gv®1
 = (
D
[
k
]+
C
[0][k])/2;

108 
	gC
[0][
k
] -ğ
v®1
;

109 
	gv®1
 -ğ
v®0
;

110 
	gl
=1;†<
	gm
;†++)

111 
	gC
[
l
][
k
] -ğ
v®1
 + 
E
[l];

114 iàĞ(
	gn
&1) == 1){

115 
l
=0; 
	gl
<
	gm
;†++)

116 
	gk
=0; k<
	gp
; k++)

117 
	gC
[
l
][
k
] +ğ
A
[l][
n
-1]*
B
[n-1][k];

127 
muÉly_Çive
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
){

129 
	gu
 = 
a
.
NumRows
();

130 
	gv
 = 
a
.
NumCŞs
();

131 
	gw
 = 
b
.
NumCŞs
();

133 
	gc
.
S‘Dims
(
u
, 
w
);

135 
	gi
 = 0; i < 
	gu
; i++)

136 
	gj
 = 0; j < 
	gw
; j++){

137 
	gc
[
i
][
j
] = 0;

138 
	gk
 = 0; k < 
	gv
; k++)

139 
	gc
[
i
][
j
] +ğ
a
[i][
k
]*
b
[k][j];

146 
muÉly_ev®u©e
(
M©
<
zz_pX
> & 
c
, cÚ¡ M©<zz_pX> & 
a
, cÚ¡ M©<zz_pX> & 
b
){

148 
	gu
 = 
a
.
NumRows
();

149 
	gv
 = 
a
.
NumCŞs
();

150 
	gw
 = 
b
.
NumCŞs
();

152 
	gc
.
S‘Dims
(
u
, 
w
);

154 
	gdA
 = 
deg
(
a
);

155 
	gdB
 = 
deg
(
b
);

156 
	gdC
 = 
dA
+
dB
;

157 
	gsz
 = 
dC
+1;

159 
zz_pX_MuÉošt
 * 
	gev
;

160 
zz_pX_MuÉošt_Geom‘ric
 
	gev_geom
;

161 
zz_pX_MuÉošt_FFT
 
	gev_FFT
;

163 ià(
	gzz_pInfo
->
	gp_šfo
 =ğ
NULL
){

164 
zz_p
 
aq
;

165 
–em’t_of_Üd”
(
aq
, 2*
sz
);

166 
	gev_geom
 = 
zz_pX_MuÉošt_Geom‘ric
(
aq
*aq, 
sz
, 0);

167 
	gev
 = &
ev_geom
;

170 
	gk
 = 
NextPow”OfTwo
(
sz
);

171 
	gev_FFT
 = 
zz_pX_MuÉošt_FFT
(1L << 
k
);

172 
	gev
 = &
ev_FFT
;

175 
	gnb
 = 
ev
->
Ëngth
();

177 
	gVec
<
	gM©
<
	gzz_p
>> 
	gv®a
, 
	gv®b
, 
	gv®c
;

178 
	gv®a
.
S‘L’gth
(
nb
);

179 
	gv®b
.
S‘L’gth
(
nb
);

180 
	gv®c
.
S‘L’gth
(
nb
);

182 
	gi
 = 0; i < 
	gnb
; i++){

183 
	gv®a
[
i
].
S‘Dims
(
u
, 
v
);

184 
	gv®b
[
i
].
S‘Dims
(
v
, 
w
);

185 
	gv®c
[
i
].
S‘Dims
(
u
, 
w
);

188 
	gVec
<
	gzz_p
> 
	gtmp
;

189 
	gtmp
.
S‘L’gth
(
nb
);

192 
	gi
 = 0; i < 
	gu
; i++)

193 
	gj
 = 0; j < 
	gv
; j++){

194 
	gev
->
ev®u©e
(
tmp
, 
a
[
i
][
j
]);

195 
	g–l
 = 0;ƒÎ < 
	gnb
;ƒll++)

196 
	gv®a
[
–l
][
i
][
j
] = 
tmp
[ell];

200 
	gi
 = 0; i < 
	gv
; i++)

201 
	gj
 = 0; j < 
	gw
; j++){

202 
	gev
->
ev®u©e
(
tmp
, 
b
[
i
][
j
]);

203 
	g–l
 = 0;ƒÎ < 
	gnb
;ƒll++)

204 
	gv®b
[
–l
][
i
][
j
] = 
tmp
[ell];

208 
	g–l
 = 0;ƒÎ < 
	gnb
;ƒll++)

209 
mul
(
v®c
[
–l
], 
v®a
[–l], 
v®b
[ell]);

212 
	gi
 = 0; i < 
	gu
; i++)

213 
	gj
 = 0; j < 
	gw
; j++){

214 
	g–l
 = 0;ƒÎ < 
	gnb
;ƒll++)

215 
	gtmp
[
–l
] = 
v®c
[–l][
i
][
j
];

216 
	gev
->
š‹½Ş©e
(
c
[
i
][
j
], 
tmp
);

	@mat_lzz_pX_extra/test/test_magma_output.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/m©rix.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"magma_ouut.h
"

6 
	~"m©_lzz_pX_exŒa.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
zz_p
::
	`š™
(1125899906842679);

17 
M©
<
zz_pX
> 
a
;

18 
	`¿ndom_m©_zz_pX
(
a
, 3, 4, 2);

19 
	`magma_š™
();

20 
	`magma_š™_X
();

21 
	`magma_assign
(
a
, "x", "a");

23 
	}
}

25 
	$maš
(
¬gc
, ** 
¬gv
){

26 
İt
 = 0;

27 ià(
¬gc
 > 1)

28 
İt
 = 
	`©oi
(
¬gv
[1]);

29 
	`check
(
İt
);

31 
	}
}

	@mat_lzz_pX_extra/test/test_multiply.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/m©rix.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"magma_ouut.h
"

6 
	~"m©_lzz_pX_exŒa.h
"

8 
NTL_CLIENT


14 
	$check
(
İt
){

16 
i
 = 30;

17 
j
 = 500;

18 
M©
<
zz_pX
> 
a
, 
b
, 
c1
, 
c2
;

20 
cout
 << 
i
 << " " << 
j
 << " ";

22 
t
;

23 
zz_p
::
	`š™
(1125899906842679);

25 
	`¿ndom_m©_zz_pX
(
a
, 
i
, i+10, 
j
);

26 
	`¿ndom_m©_zz_pX
(
b
, 
i
+10, i-10, 
j
);

28 
t
 = 
	`G‘Time
();

29 
	`muÉly_Çive
(
c1
, 
a
, 
b
);

30 
cout
 << 
	`G‘Time
()-
t
 << " ";

32 
t
 = 
	`G‘Time
();

33 
	`muÉly_ev®u©e
(
c2
, 
a
, 
b
);

34 
cout
 << 
	`G‘Time
()-
t
 << " ";

36 ià(
c1
 !ğ
c2
)

37 
cout
 << "mismatch 1\n";

39 
zz_p
::
	`FFTIn™
(1);

41 
	`¿ndom_m©_zz_pX
(
a
, 
i
, i+10, 
j
);

42 
	`¿ndom_m©_zz_pX
(
b
, 
i
+10, i-10, 
j
);

44 
	`muÉly_Çive
(
c1
, 
a
, 
b
);

45 
t
 = 
	`G‘Time
();

46 
	`muÉly_ev®u©e
(
c2
, 
a
, 
b
);

47 
cout
 << 
	`G‘Time
()-
t
 << 
’dl
;

49 ià(
c1
 !ğ
c2
)

50 
cout
 << "mismatch 2\n";

51 
	}
}

53 
	$maš
(
¬gc
, ** 
¬gv
){

54 
İt
 = 0;

55 ià(
¬gc
 > 1)

56 
İt
 = 
	`©oi
(
¬gv
[1]);

57 
	`check
(
İt
);

59 
	}
}

	@mat_lzz_pX_extra/test/test_random.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/m©rix.h
>

3 
	~<NTL/veùÜ.h
>

5 
	~"m©_lzz_pX_exŒa.h
"

7 
NTL_CLIENT


13 
	$check
(
İt
){

15 
zz_p
::
	`š™
(1125899906842679);

16 
M©
<
zz_pX
> 
a
;

17 
	`¿ndom_m©_zz_pX
(
a
, 3, 4, 2);

18 
cout
 << 
a
 << 
’dl
;

20 
	}
}

22 
	$maš
(
¬gc
, ** 
¬gv
){

23 
İt
 = 0;

24 ià(
¬gc
 > 1)

25 
İt
 = 
	`©oi
(
¬gv
[1]);

26 
	`check
(
İt
);

28 
	}
}

	@mosaic_hankel/mosaic_hankel.h

1 #iâdeà
__MOSAIC_HANKEL_H


2 
	#__MOSAIC_HANKEL_H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/m©_lzz_p.h
>

7 
	~"lzz_pX_CRT.h
"

8 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

10 
NTL_CLIENT


22 şas 
	chªk–
{

25 
	mn
, 
	mm
;

26 
	mVec
<
	mzz_p
> 
	md©a
;

28 
	mpublic
:

30 
Vec
<
zz_p
> 
d©a_»v
;

31 
fáR•
 
	mfá_d©a
;

33 
	$hªk–
(){

34 
d©a
.
	`S‘L’gth
(0);

35 
n
 = 
m
 = 0;

41 
	`hªk–
(
Vec
<
zz_p
>& 
šput
, 
rows
, 
cŞs
){

42 
n
 = 
rows
;

43 
m
 = 
cŞs
;

44 
d©a
 = 
šput
;

45 
d©a_»v
.
	`S‘L’gth
(
n
+
m
-1);

46 
zz_pX
 
d©a_X
;

47 
d©a_X
.
»p
.
	`S‘L’gth
(
n
+
m
-1);

49 
i
 = 0;˜< 
n
+
m
-1; i++){

50 
d©a_»v
[
i
] = 
šput
[
n
+
m
-2-i];

51 
d©a_X
.
»p
[
i
] = 
d©a_»v
[i];

53 
d©a_X
.
	`nÜm®ize
();

55 
K
 = 
	`NextPow”OfTwo
(
n
+
m
-1);

56 
fá_d©a
 = 
	`fáR•
(
INIT_SIZE
, 
K
);

57 
	`TofáR•
(
fá_d©a
, 
d©a_X
, 
K
);

58 
	}
}

63 
	$NumCŞs
() const{

64  
m
;

65 
	}
}

66 
	$NumRows
() const{

67  
n
;

68 
	}
}

69 cÚ¡ 
	gzz_p
& 
	$İ”©Ü
 ()(
i
, 
j
) const{

70  
d©a
[
m
+
n
-2-
i
-
j
];

71 
	}
}

78 
to_d’£
(
M©
<
zz_p
>& 
Md’£
, cÚ¡ 
hªk–
& 
M
);

84 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

90 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

101 şas 
	cmo§ic_hªk–
{

102 
	mn
, 
	mm
;

103 
	mnb
, 
	mmb
;

105 
	mpublic
:

108 
Vec
< Vec<
hªk–
> > 
d©a
;

113 
	$mo§ic_hªk–
(){

114 
d©a
.
	`S‘L’gth
(0);

115 
n
 = 
m
 = 
nb
 = 
mb
 = 0;

121 
	`mo§ic_hªk–
(
Vec
< Vec<
hªk–
> > 
š™
){

122 
d©a
 = 
š™
;

123 
nb
 = 
š™
.
	`Ëngth
();

124 
mb
 = 
š™
[0].
	`Ëngth
();

126 
n
 = 0;

127 
m
 = 0;

129 
i
 = 0; i < 
nb
; i++)

130 
n
 +ğ
š™
[
i
][0].
	`NumRows
();

131 
j
 = 0; j < 
mb
; j++)

132 
m
 +ğ
š™
[0][
j
].
	`NumCŞs
();

133 
	}
}

138 
	$NumRows
() const{

139  
n
;

140 
	}
}

141 
	$NumCŞs
() const{

142  
m
;

143 
	}
}

144 
	$NumBlockRows
() const{

145  
nb
;

146 
	}
}

147 
	$NumBlockCŞs
() const{

148  
mb
;

149 
	}
}

150 
	$NumRows_of_block
(
i
) const{

151  
d©a
[
i
][0].
	`NumRows
();

152 
	}
}

153 
	$NumCŞs_of_block
(
i
) const{

154  
d©a
[0][
i
].
	`NumCŞs
();

155 
	}
}

157 cÚ¡ 
	gzz_p
& 
	$İ”©Ü
 ()(
i
, 
j
) const{

159 ià(
i
 >ğ
n
 || 
j
 >ğ
m
)

160 
	`E¼Ü
("matrix indices out of bounds\n");

161 
idx
, 
jdx
;

163 
idx
 = 0;

164 
i
 >ğ
d©a
[
idx
][0].
	`NumRows
()){

165 
i
 -ğ
d©a
[
idx
][0].
	`NumRows
();

166 
idx
++;

169 
jdx
 = 0;

170 
j
 >ğ
d©a
[0][
jdx
].
	`NumCŞs
()){

171 
j
 -ğ
d©a
[0][
jdx
].
	`NumCŞs
();

172 
jdx
++;

174  
d©a
[
idx
][
jdx
](
i
, 
j
);

175 
	}
}

182 
to_d’£
(
M©
<
zz_p
>& 
Md’£
, cÚ¡ 
mo§ic_hªk–
& 
M
);

187 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
mo§ic_hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

192 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
mo§ic_hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
);

197 
fœ¡_cŞumn_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

198 
Ï¡_cŞumn_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

199 
fœ¡_row_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

200 
Ï¡_row_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
);

205 
g’”©Üs
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, cÚ¡ 
mo§ic_hªk–
& 
M
);

215 
to_ÿuchy_g½
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
,

216 
zz_pX_MuÉošt_Geom‘ric
& 
X_št
, zz_pX_MuÉošt_Geom‘ric& 
Y_št
,

217 
Vec
<
zz_p
> &
e
, Vec<zz_p> &
f
,

218 cÚ¡ 
mo§ic_hªk–
& 
M
);

	@mosaic_hankel/src/hankel.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/m©_lzz_p.h
>

4 
	~"lzz_pX_middË_´oduù.h
"

5 
	~"mo§ic_hªk–.h
"

7 
NTL_CLIENT


23 
to_d’£
(
M©
<
zz_p
>& 
Md’£
, cÚ¡ 
hªk–
& 
M
){

24 
	gn
 = 
M
.
NumRows
();

25 
	gm
 = 
M
.
NumCŞs
();

26 
	gMd’£
.
S‘Dims
(
n
, 
m
);

28 
	gi
 = 0; i < 
	gn
; i++)

29 
	gj
 = 0; j < 
	gm
; j++)

30 
	gMd’£
[
i
][
j
] = 
M
(i,j);

36 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
){

38 
	gnM
 = 
M
.
NumRows
();

39 
	gmM
 = 
M
.
NumCŞs
();

40 
	g»s
.
S‘L’gth
(
nM
);

42 ià(
mš
(
nM
, 
mM
è<ğ
NTL_zz_pX_MUL_CROSSOVER
){

43 
¥
 = 
K¬_¡k_size
(
max
(
nM
, 
mM
));

44 
zz_p
 *
	g¡k
 = 
Ãw
 zz_p[
¥
];

45 
tK¬Mul_aux
(
»s
.
_vec__»p
.
»p
, 
nM
, 
šput
._vec__»p.»p, 
mM
, 
M
.
d©a_»v
._vec__»p.»p,‚M+mM-1, 
¡k
);

46 
	gd–‘e
[] 
	g¡k
;

49 
	gK
 = 
NextPow”OfTwo
(
nM
+
mM
-1);

50 
fáR•
 
	gfá_šput
 = fáR•(
INIT_SIZE
, 
K
);

52 
zz_pX
 
	gšput_X
, 
	gouut_X
;

53 
	gšput_X
.
	g»p
.
S‘L’gth
(
mM
);

54 
zz_p
 *
	gcf
 = 
šput_X
.
»p
.
–ts
();

55 
	gi
 = 0; i < 
	gmM
; i++)

56 
	gcf
[
i
] = 
šput
[
mM
-1-i];

57 
	gšput_X
.
nÜm®ize
();

60 
TofáR•
(
fá_šput
, 
šput_X
, 
K
);

61 
mul
(
fá_šput
, fá_šput, 
M
.
fá_d©a
);

62 
FromfáR•
(
»s
.
_vec__»p
.
»p
, 
fá_šput
, 
mM
-1, 
nM
+mM-2);

69 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
){

71 
	gnM
 = 
M
.
NumRows
();

72 
	gmM
 = 
M
.
NumCŞs
();

74 
	g»s
.
S‘L’gth
(
mM
);

75 ià(
mš
(
nM
, 
mM
è<ğ
NTL_zz_pX_MUL_CROSSOVER
){

76 
¥
 = 
K¬_¡k_size
(
max
(
nM
, 
mM
));

77 
zz_p
 *
	g¡k
 = 
Ãw
 zz_p[
¥
];

78 
tK¬Mul_aux
(
»s
.
_vec__»p
.
»p
, 
mM
, 
šput
._vec__»p.»p, 
nM
, 
M
.
d©a_»v
._vec__»p.»p,‚M+mM-1, 
¡k
);

79 
	gd–‘e
[] 
	g¡k
;

82 
	gK
 = 
NextPow”OfTwo
(
nM
+
mM
-1);

83 
fáR•
 
	gfá_šput
 = fáR•(
INIT_SIZE
, 
K
);

85 
zz_pX
 
	gšput_X
, 
	gouut_X
;

86 
	gšput_X
.
	g»p
.
S‘L’gth
(
nM
);

87 
zz_p
 *
	gcf
 = 
šput_X
.
»p
.
–ts
();

88 
	gi
 = 0; i < 
	gnM
; i++)

89 
	gcf
[
i
] = 
šput
[
nM
-1-i];

90 
	gšput_X
.
nÜm®ize
();

92 
TofáR•
(
fá_šput
, 
šput_X
, 
K
);

93 
mul
(
fá_šput
, fá_šput, 
M
.
fá_d©a
);

94 
FromfáR•
(
»s
.
_vec__»p
.
»p
, 
fá_šput
, 
nM
-1,‚M+
mM
-2);

	@mosaic_hankel/src/mosaic_hankel.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/m©_lzz_p.h
>

4 
	~"lzz_p_exŒa.h
"

5 
	~"lzz_pX_CRT.h
"

6 
	~"ZZ_pX_CRT.h
"

7 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

8 
	~"mo§ic_hªk–.h
"

10 
NTL_CLIENT


22 
to_d’£
(
M©
<
zz_p
>& 
Md’£
, cÚ¡ 
mo§ic_hªk–
& 
M
){

23 
	gn
 = 
M
.
NumRows
();

24 
	gm
 = 
M
.
NumCŞs
();

25 
	gMd’£
.
S‘Dims
(
n
, 
m
);

27 
	gi
 = 0; i < 
	gn
; i++)

28 
	gj
 = 0; j < 
	gm
; j++)

29 
	gMd’£
[
i
][
j
] = 
M
(i,j);

35 
mul_right
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
mo§ic_hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
){

36 
	gn
 = 
M
.
NumRows
();

37 
	g»s
.
S‘L’gth
(
n
);

38 
	gi
 = 0; i < 
	gn
; i++)

39 
	g»s
[
i
] = 0;

41 
	gnb
 = 
M
.
NumBlockRows
();

42 
	gmb
 = 
M
.
NumBlockCŞs
();

44 
	gmaxn
 = 0;

45 
	gi
 = 0; i < 
	gnb
; i++)

46 
	gmaxn
 = 
max
(
maxn
, 
M
.
d©a
[
i
][0].
NumRows
());

48 
	gmaxm
 = 0;

49 
	gi
 = 0; i < 
	gmb
; i++)

50 
	gmaxm
 = 
max
(
maxm
, 
M
.
d©a
[0][
i
].
NumCŞs
());

52 
	gVec
<
	gzz_p
> 
	gtmp_š
, 
	gtmp_out
;

53 
	gtmp_š
.
S‘L’gth
(
maxm
);

54 
	gtmp_out
.
S‘L’gth
(
maxn
);

56 
	gjdx
 = 0;

57 
	gj
 = 0; j < 
	gmb
; j++){

58 
	g–l
 = 0;ƒÎ < 
	gM
.
	gd©a
[0][
j
].
NumCŞs
();ƒll++)

59 
	gtmp_š
[
–l
] = 
šput
[
jdx
 +ƒll];

61 
	gidx
 = 0;

62 
	gi
 = 0; i < 
	gnb
; i++){

63 
mul_right
(
tmp_out
, 
M
.
d©a
[
i
][
j
], 
tmp_š
);

64 
	g–l
 = 0;ƒÎ < 
	gM
.
	gd©a
[
i
][0].
NumRows
();ƒll++)

65 
	g»s
[
idx
 + 
–l
] +ğ
tmp_out
[ell];

66 
	gidx
 +ğ
M
.
d©a
[
i
][0].
NumRows
();

68 
	gjdx
 +ğ
M
.
d©a
[0][
j
].
NumCŞs
();

75 
mul_Ëá
(
Vec
<
zz_p
>& 
»s
, cÚ¡ 
mo§ic_hªk–
& 
M
, cÚ¡ Vec<zz_p>& 
šput
){

76 
	gm
 = 
M
.
NumCŞs
();

77 
	g»s
.
S‘L’gth
(
m
);

78 
	gi
 = 0; i < 
	gm
; i++)

79 
	g»s
[
i
] = 0;

81 
	gnb
 = 
M
.
NumBlockRows
();

82 
	gmb
 = 
M
.
NumBlockCŞs
();

84 
	gmaxn
 = 0;

85 
	gi
 = 0; i < 
	gnb
; i++)

86 
	gmaxn
 = 
max
(
maxn
, 
M
.
d©a
[
i
][0].
NumRows
());

88 
	gmaxm
 = 0;

89 
	gi
 = 0; i < 
	gmb
; i++)

90 
	gmaxm
 = 
max
(
maxm
, 
M
.
d©a
[0][
i
].
NumCŞs
());

92 
	gVec
<
	gzz_p
> 
	gtmp_š
, 
	gtmp_out
;

93 
	gtmp_š
.
S‘L’gth
(
maxn
);

94 
	gtmp_out
.
S‘L’gth
(
maxm
);

96 
	gidx
 = 0;

97 
	gi
 = 0; i < 
	gnb
; i++){

98 
	g–l
 = 0;ƒÎ < 
	gM
.
	gd©a
[
i
][0].
NumRows
();ƒll++)

99 
	gtmp_š
[
–l
] = 
šput
[
idx
 +ƒll];

101 
	gjdx
 = 0;

102 
	gj
 = 0; j < 
	gmb
; j++){

103 
mul_Ëá
(
tmp_out
, 
M
.
d©a
[
i
][
j
], 
tmp_š
);

104 
	g–l
 = 0;ƒÎ < 
	gM
.
	gd©a
[0][
j
].
NumCŞs
();ƒll++)

105 
	g»s
[
jdx
 + 
–l
] +ğ
tmp_out
[ell];

106 
	gjdx
 +ğ
M
.
d©a
[0][
j
].
NumCŞs
();

108 
	gidx
 +ğ
M
.
d©a
[
i
][0].
NumRows
();

116 
fœ¡_cŞumn_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
){

117 
	gn
 = 
M
.
NumRows
();

118 
	gnb
 = 
M
.
NumBlockRows
();

120 
	g»s
.
S‘L’gth
(
n
);

122 
	gšd
 = 0;

123 
	gr
 = 0;„ < 
	gnb
;„++){

124 cÚ¡ 
zz_p
* 
	gd©
 = 
M
.
d©a
[
r
][
i
].
d©a_»v
.
–ts
();

125 
	gj
 = 0; j < 
	gM
.
NumRows_of_block
(
r
); j++)

126 
	g»s
[
šd
++] = 
d©
[
j
];

133 
Ï¡_cŞumn_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
){

134 
	gn
 = 
M
.
NumRows
();

135 
	gnb
 = 
M
.
NumBlockRows
();

137 
	g»s
.
S‘L’gth
(
n
);

139 
	gšd
 = 0;

140 
	gr
 = 0;„ < 
	gnb
;„++){

141 cÚ¡ 
zz_p
* 
	gd©
 = 
M
.
d©a
[
r
][
i
].
d©a_»v
.
–ts
();

142 
	gshiá
 = 
M
.
NumCŞs_of_block
(
i
)-1;

143 
	gj
 = 0; j < 
	gM
.
NumRows_of_block
(
r
); j++)

144 
	g»s
[
šd
++] = 
d©
[
j
 + 
shiá
];

151 
fœ¡_row_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
){

152 
	gm
 = 
M
.
NumCŞs
();

153 
	gmb
 = 
M
.
NumBlockCŞs
();

155 
	g»s
.
S‘L’gth
(
m
);

157 
	gšd
 = 0;

158 
	gr
 = 0;„ < 
	gmb
;„++){

159 cÚ¡ 
zz_p
* 
	gd©
 = 
M
.
d©a
[
i
][
r
].
d©a_»v
.
–ts
();

160 
	gj
 = 0; j < 
	gM
.
NumCŞs_of_block
(
r
); j++)

161 
	g»s
[
šd
++] = 
d©
[
j
];

168 
Ï¡_row_of_block
(
Vec
<
zz_p
>& 
»s
, 
i
, cÚ¡ 
mo§ic_hªk–
& 
M
){

169 
	gm
 = 
M
.
NumCŞs
();

170 
	gmb
 = 
M
.
NumBlockCŞs
();

172 
	g»s
.
S‘L’gth
(
m
);

174 
	gšd
 = 0;

175 
	gr
 = 0;„ < 
	gmb
;„++){

176 cÚ¡ 
zz_p
* 
	gd©
 = 
M
.
d©a
[
i
][
r
].
d©a_»v
.
–ts
();

177 
	gshiá
 = 
M
.
NumRows_of_block
(
i
)-1;

178 
	gj
 = 0; j < 
	gM
.
NumCŞs_of_block
(
r
); j++)

179 
	g»s
[
šd
++] = 
d©
[
j
+
shiá
];

186 
g’”©Üs
(
M©
<
zz_p
>& 
G
, M©<zz_p>& 
H
, cÚ¡ 
mo§ic_hªk–
& 
M
){

187 
	gn
 = 
M
.
NumRows
();

188 
	gm
 = 
M
.
NumCŞs
();

189 
	g®pha_r
 = 
M
.
NumBlockRows
();

190 
	g®pha_c
 = 
M
.
NumBlockCŞs
();

191 
	g®pha
 = 
®pha_r
 + 
®pha_c
;

193 
	gG
.
S‘Dims
(
n
, 
®pha
);

194 
	gH
.
S‘Dims
(
m
, 
®pha
);

196 
	gVec
<
	gzz_p
> 
	gtmp_row
, 
	gtmp_cŞ
;

197 
	gtmp_row
.
S‘L’gth
(
m
);

198 
	gtmp_cŞ
.
S‘L’gth
(
n
);

200 
	gidx
;

202 
	gidx
 = 0;

203 
	gi
 = 0; i < 
	g®pha_c
; i++){

204 
fœ¡_cŞumn_of_block
(
tmp_cŞ
, 
i
, 
M
);

205 
	gG
[0][
i
] = 
tmp_cŞ
[
n
-1];

206 
	gj
 = 1; j < 
	gn
; j++)

207 
	gG
[
j
][
i
] = 
tmp_cŞ
[j-1];

209 ià(
	gi
 > 0){

210 
Ï¡_cŞumn_of_block
(
tmp_cŞ
, 
i
-1, 
M
);

211 
	gj
 = 0; j < 
	gn
; j++)

212 
	gG
[
j
][
i
] = 
G
[j][i] - 
tmp_cŞ
[j];

215 
	gi
 = 0; i < 
	g®pha_r
; i++){

216 
	gj
 = 0; j < 
	gn
; j++)

217 
	gG
[
j
][
i
+
®pha_c
] = 0;

218 
	gG
[
idx
][
i
+
®pha_c
] = 1;

219 
	gidx
 +ğ
M
.
NumRows_of_block
(
i
);

223 
	gidx
 = 0;

224 
	gi
 = 0; i < 
	g®pha_c
; i++){

225 
	gj
 = 0; j < 
	gm
; j++)

226 
	gH
[
j
][
i
] = 0;

227 
	gH
[
idx
][
i
] = 1;

228 
	gidx
 +ğ
M
.
NumCŞs_of_block
(
i
);

230 
	gi
 = 0; i < 
	g®pha_r
; i++){

231 ià(
	gi
 == 0)

232 
Ï¡_row_of_block
(
tmp_row
, 
®pha_r
-1, 
M
);

234 
Ï¡_row_of_block
(
tmp_row
, 
i
-1, 
M
);

235 
	gj
 = 1; j < 
	gm
; j++)

236 
	gH
[
j
][
i
+
®pha_c
] = 
tmp_row
[j];

237 
fœ¡_row_of_block
(
tmp_row
, 
i
, 
M
);

238 
	gj
 = 1; j < 
	gm
; j++)

239 
	gH
[
j
][
i
+
®pha_c
] = 
H
[j][i+®pha_c] - 
tmp_row
[j-1];

240 
	gjdx
 = 0;

241 
	gj
 = 0; j < 
	g®pha_c
; j++){

242 
	gH
[
jdx
][
i
+
®pha_c
] = 0;

243 
	gjdx
 +ğ
M
.
NumCŞs_of_block
(
j
);

254 
	$fšd_c
(
zz_p
& 
c
, cÚ¡ zz_p& 
a
, 
n
, 
m
){

255 
Vec
<
zz_p
> 
pow_a
, 
pow_šva
;

256 
pow_a
.
	`S‘L’gth
(
n
);

257 
pow_šva
.
	`S‘L’gth
(
m
);

259 
pow_a
[0] = 
	`to_zz_p
(1);

260 
pow_šva
[0] = 
	`to_zz_p
(1);

262 
zz_p
 
šva
 = 1/
a
;

263 
i
 = 1; i < 
n
; i++)

264 
pow_a
[
i
] = 
a
*pow_a[i-1];

265 
i
 = 1; i < 
m
; i++)

266 
pow_šva
[
i
] = 
šva
*pow_inva[i-1];

268 
boŞ
 
dÚe
;

270 
c
 = 
	`¿ndom_zz_p
();

271 
dÚe
 = 
Œue
;

272 ià(
c
 == 0)

273 
dÚe
 = 
çl£
;

274 
i
 = 0; i < 
n
; i++)

275 ià(
c
 =ğ
pow_a
[
i
])

276 
dÚe
 = 
çl£
;

277 
i
 = 0; i < 
m
; i++)

278 ià(
c
 =ğ
pow_šva
[
i
])

279 
dÚe
 = 
çl£
;

280 } 
dÚe
 !ğ
Œue
);

281 
	}
}

295 
to_ÿuchy_g½
(
ÿuchy_like_geom‘ric_¥ecŸl
& 
CL
,

296 
zz_pX_MuÉošt_Geom‘ric
& 
X_št
, zz_pX_MuÉošt_Geom‘ric& 
Y_št
,

297 
Vec
<
zz_p
> &
e
, Vec<zz_p> &
f
,

298 cÚ¡ 
mo§ic_hªk–
& 
M
){

301 
	gM©
<
	gzz_p
> 
	gX
, 
	gY
;

302 
	gM©
<
	gzz_p
> 
	gG
, 
	gH
;

303 
g’”©Üs
(
G
, 
H
, 
M
);

304 
ÿuchy_geom‘ric_¥ecŸl
 
	gC
;

305 
zz_p
 
	ga
, 
	gb
, 
	gc
;

306 
	gn
 = 
M
.
NumRows
();

307 
	gm
 = 
M
.
NumCŞs
();

309 ià(
max
(
m
, 
n
è> 
	gzz_p
::
modulus
())

310 
LogicE¼Ü
("Fieldoo small for…reconditioning.");

312 
zz_pInfoT
 *
	gšfo
 = 
zz_pInfo
;

313 ià(
	gšfo
->
	gp_šfo
 !ğ
NULL
){

314 
k
 = 
NextPow”OfTwo
(
max
(
m
, 
n
));

315 
	gÜd”
 = 1L << 
k
;

316 
	gw
 = 
fšd_roÙ_of_un™y
(
zz_p
::
modulus
(), 2*
Üd”
);

317 
	ga
 = 
to_zz_p
(
w
);

320 
–em’t_of_Üd”
(
a
, 
max
(
m
, 
n
));

322 
	gb
 = 
a
*a;

323 
fšd_c
(
c
, 
b
, 
n
, 
m
);

324 
	gX_št
 = 
zz_pX_MuÉošt_Geom‘ric
(
a
, 
n
, 0);

325 
	gY_št
 = 
zz_pX_MuÉošt_Geom‘ric
(
a
, 
m
, 
c
);

326 
	gC
 = 
ÿuchy_geom‘ric_¥ecŸl
(
to_zz_p
(1), 
c
, 
b
, 
n
, 
m
);

328 
	g®pha
 = 
G
.
NumCŞs
();

329 
	gX
.
S‘Dims
(
n
, 
®pha
+2);

330 
	gY
.
S‘Dims
(
m
, 
®pha
+2);

332 
	ge
.
S‘L’gth
(
n
);

333 
	gi
 = 0; i < 
	gn
; i++)

334 
	ge
[
i
] = 
¿ndom_zz_p
();

336 
	gf
.
S‘L’gth
(
m
);

337 
	gi
 = 0; i < 
	gm
; i++)

338 
	gf
[
i
] = 
¿ndom_zz_p
();

340 
vec_zz_p
 
	gtmp_v
;

341 
	gj
 = 0; j < 
	g®pha
; j++){

342 
zz_pX
 
	gtmp_p
;

343 
	gtmp_p
.
	g»p
.
S‘L’gth
(
n
);

344 
zz_p
* 
	gcÛf_p
 = 
tmp_p
.
»p
.
–ts
();

345 
	gi
 = 0; i < 
	gn
; i++)

346 
	gcÛf_p
[
i
] = 
G
[i][
j
];

347 
	gtmp_p
.
nÜm®ize
();

348 
	gX_št
.
ev®u©e
(
tmp_v
, 
tmp_p
);

349 
	gi
 = 0; i < 
	gn
; i++)

350 
	gX
[
i
][
j
] = 
tmp_v
[i] * 
e
[i];

353 
zz_p
 
	gtmp_z
 = 
to_zz_p
(1);

354 
	gi
 = 0; i < 
	gn
; i++){

355 
	gX
[
i
][
®pha
] = 
e
[i]*(
pow”
(
tmp_z
, 
n
)-1);

356 
	gtmp_z
 = 
tmp_z
 * 
b
;

359 
Ï¡_cŞumn_of_block
(
tmp_v
, 
M
.
NumBlockCŞs
()-1, M);

360 
zz_pX
 
	gtmp_p
;

361 
	gtmp_p
.
	g»p
.
S‘L’gth
(
n
);

362 
zz_p
* 
	gcÛf_p
 = 
tmp_p
.
»p
.
–ts
();

363 
	gi
 = 0; i < 
	gn
; i++)

364 
	gcÛf_p
[
i
] = 
tmp_v
[i];

365 
	gtmp_p
.
nÜm®ize
();

366 
	gX_št
.
ev®u©e
(
tmp_v
, 
tmp_p
);

367 
	gi
 = 0; i < 
	gn
; i++)

368 
	gX
[
i
][
®pha
+1] = 
tmp_v
[i] * 
e
[i];

370 
vec_zz_p
 
	gtmp_w
;

371 
	gj
 = 0; j < 
	g®pha
; j++){

372 
zz_pX
 
	gtmp_q
;

373 
	gtmp_q
.
	g»p
.
S‘L’gth
(
m
);

374 
zz_p
* 
	gcÛf_q
 = 
tmp_q
.
»p
.
–ts
();

375 
	gi
 = 0; i < 
	gm
; i++)

376 
	gcÛf_q
[
i
] = 
H
[i][
j
];

377 
	gtmp_q
.
nÜm®ize
();

378 
	gY_št
.
ev®u©e
(
tmp_w
, 
tmp_q
);

379 
	gi
 = 0; i < 
	gm
; i++)

380 
	gY
[
i
][
j
] = 
tmp_w
[i] * 
f
[i];

383 
Ï¡_row_of_block
(
tmp_w
, 
M
.
NumBlockRows
()-1, M);

384 
zz_pX
 
	gtmp_q
;

385 
	gtmp_q
.
	g»p
.
S‘L’gth
(
m
);

386 
zz_p
* 
	gcÛf_q
 = 
tmp_q
.
»p
.
–ts
();

387 
	gi
 = 0; i < 
	gm
; i++)

388 
	gcÛf_q
[
i
] = 
tmp_w
[i];

389 
	gtmp_q
.
nÜm®ize
();

390 
	gY_št
.
ev®u©e
(
tmp_w
, 
tmp_q
);

391 
	gi
 = 0; i < 
	gm
; i++)

392 
	gY
[
i
][
®pha
] = 
tmp_w
[i] * 
f
[i];

394 
	gtmp_z
 = 
c
;

395 
	gi
 = 0; i < 
	gm
; i++){

396 
	gY
[
i
][
®pha
+1] = -
f
[i]*
pow”
(
tmp_z
, 
m
);

397 
	gtmp_z
 = 
tmp_z
 * 
b
;

400 
	gCL
 = 
ÿuchy_like_geom‘ric_¥ecŸl
(
X
, 
Y
, 
C
);

	@mosaic_hankel/test/test_first_column_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

52 
	`fœ¡_cŞumn_of_block
(
cŞ
, 0, 
MH
);

53 
j
 = 0; j < 2; j++)

54 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 0));

55 
j
 = 0; j < 
i
-1; j++)

56 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h10
(j, 0));

58 
	`fœ¡_cŞumn_of_block
(
cŞ
, 1, 
MH
);

59 
j
 = 0; j < 2; j++)

60 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h01
(j, 0));

61 
j
 = 0; j < 
i
-1; j++)

62 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h11
(j, 0));

64 
	`fœ¡_cŞumn_of_block
(
cŞ
, 2, 
MH
);

65 
j
 = 0; j < 2; j++)

66 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h02
(j, 0));

67 
j
 = 0; j < 
i
-1; j++)

68 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h12
(j, 0));

70 
cout
 << 
i
 << 
’dl
;

73 
cout
 << 
i
 << " ";

75 
t
;

77 
t
 = 
	`G‘Time
();

78 
j
 = 0; j < 10000; j++)

80 
t
 = 
	`G‘Time
() -;

81 
cout
 << 
t
 << " ";

83 
cout
 << 
’dl
;

86 
	}
}

93 
	$maš
(
¬gc
, ** 
¬gv
){

94 
İt
 = 0;

95 ià(
¬gc
 > 1)

96 
İt
 = 
	`©oi
(
¬gv
[1]);

97 
	`check
(
İt
);

100 
	}
}

	@mosaic_hankel/test/test_first_row_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

53 
	`fœ¡_row_of_block
(
cŞ
, 0, 
MH
);

54 
j
 = 0; j < 
i
; j++)

55 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 0));

56 
j
 = 0; j < 2; j++)

57 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h01
(j, 0));

58 
j
 = 0; j < 
i
; j++)

59 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h02
(j, 0));

61 
	`fœ¡_row_of_block
(
cŞ
, 1, 
MH
);

62 
j
 = 0; j < 
i
; j++)

63 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h10
(j, 0));

64 
j
 = 0; j < 2; j++)

65 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h11
(j, 0));

66 
j
 = 0; j < 
i
; j++)

67 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h12
(j, 0));

69 
cout
 << 
i
 << 
’dl
;

72 
cout
 << 
i
 << " ";

74 
t
;

76 
t
 = 
	`G‘Time
();

77 
j
 = 0; j < 10000; j++)

79 
t
 = 
	`G‘Time
() -;

80 
cout
 << 
t
 << " ";

82 
cout
 << 
’dl
;

85 
	}
}

92 
	$maš
(
¬gc
, ** 
¬gv
){

93 
İt
 = 0;

94 ià(
¬gc
 > 1)

95 
İt
 = 
	`©oi
(
¬gv
[1]);

96 
	`check
(
İt
);

99 
	}
}

	@mosaic_hankel/test/test_hankel_init.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i
 = 2; i < 10; i += 1){

17 
zz_p
 
a
 = 
	`¿ndom_zz_p
();

19 ià(
İt
 == 1){

20 
Vec
<
zz_p
> 
d©
;

21 
d©
.
	`S‘L’gth
(2*
i
-1);

22 
j
 = 0; j < 2*
i
-1; j++)

23 
d©
[
j
] = j;

25 
hªk–
 
	`h
(
d©
, 
i
, i);

27 
cout
 << 
	`h
(0,0è<< " " << h(0,1è<< 
’dl
 << h(1,0) << " " << h(1,1) <<ƒndl;

28 
cout
 << 
’dl
;

31 
cout
 << 
i
 << " ";

33 
t
;

35 
t
 = 
	`G‘Time
();

36 
j
 = 0; j < 10000; j++)

38 
t
 = 
	`G‘Time
() -;

39 
cout
 << 
t
 << " ";

41 
cout
 << 
’dl
;

44 
	}
}

51 
	$maš
(
¬gc
, ** 
¬gv
){

52 
İt
 = 0;

53 ià(
¬gc
 > 1)

54 
İt
 = 
	`©oi
(
¬gv
[1]);

55 
	`check
(
İt
);

58 
	}
}

	@mosaic_hankel/test/test_hankel_mul_left.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i1
 = 1; i1 < 200; i1 += 1)

16 
i2
 = 1; i2 < 200; i2 += 1){

18 ià(
İt
 == 1){

19 
Vec
<
zz_p
> 
d©
;

20 
d©
.
	`S‘L’gth
(
i1
+
i2
-1);

21 
j
 = 0; j < 
i1
+
i2
-1; j++)

22 
d©
[
j
] = j;

24 
hªk–
 
	`h
(
d©
, 
i1
, 
i2
);

26 
Vec
<
zz_p
> 
šput
, 
ouut
;

27 
šput
.
	`S‘L’gth
(
i1
);

28 
j
 = 0; j < 
i1
; j++)

29 
šput
[
j
] = 
	`¿ndom_zz_p
();

30 
ouut
.
	`S‘L’gth
(
i2
);

32 
	`mul_Ëá
(
ouut
, 
h
, 
šput
);

34 
M©
<
zz_p
> 
M
;

35 
	`to_d’£
(
M
, 
h
);

36 
Vec
<
zz_p
> 
ouut2
 = 
šput
*
M
;

38 
	`as£¹
 (
ouut
 =ğ
ouut2
);

39 
cout
 << 
i1
 << " " << 
i2
 << 
’dl
;

42 
cout
 << 
i1
 << " ";

44 
t
;

46 
t
 = 
	`G‘Time
();

47 
j
 = 0; j < 10000; j++)

49 
t
 = 
	`G‘Time
() -;

50 
cout
 << 
t
 << " ";

52 
cout
 << 
’dl
;

55 
	}
}

62 
	$maš
(
¬gc
, ** 
¬gv
){

63 
İt
 = 0;

64 ià(
¬gc
 > 1)

65 
İt
 = 
	`©oi
(
¬gv
[1]);

66 
	`check
(
İt
);

69 
	}
}

	@mosaic_hankel/test/test_hankel_mul_right.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i1
 = 1; i1 < 200; i1 += 1)

16 
i2
 = 1; i2 < 200; i2 += 1){

18 ià(
İt
 == 1){

19 
Vec
<
zz_p
> 
d©
;

20 
d©
.
	`S‘L’gth
(
i1
+
i2
-1);

21 
j
 = 0; j < 
i1
+
i2
-1; j++)

22 
d©
[
j
] = j;

24 
hªk–
 
	`h
(
d©
, 
i1
, 
i2
);

26 
Vec
<
zz_p
> 
šput
, 
ouut
;

27 
šput
.
	`S‘L’gth
(
i2
);

28 
j
 = 0; j < 
i2
; j++)

29 
šput
[
j
] = 
	`¿ndom_zz_p
();

30 
ouut
.
	`S‘L’gth
(
i1
);

32 
	`mul_right
(
ouut
, 
h
, 
šput
);

34 
M©
<
zz_p
> 
M
;

35 
	`to_d’£
(
M
, 
h
);

36 
Vec
<
zz_p
> 
ouut2
 = 
M
*
šput
;

38 
	`as£¹
 (
ouut
 =ğ
ouut2
);

39 
cout
 << 
i1
 << " " << 
i2
 << 
’dl
;

42 
cout
 << 
i1
 << " ";

44 
t
;

46 
t
 = 
	`G‘Time
();

47 
j
 = 0; j < 10000; j++)

49 
t
 = 
	`G‘Time
() -;

50 
cout
 << 
t
 << " ";

52 
cout
 << 
’dl
;

55 
	}
}

62 
	$maš
(
¬gc
, ** 
¬gv
){

63 
İt
 = 0;

64 ià(
¬gc
 > 1)

65 
İt
 = 
	`©oi
(
¬gv
[1]);

66 
	`check
(
İt
);

69 
	}
}

	@mosaic_hankel/test/test_hankel_to_dense.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i
 = 2; i < 10; i += 1){

18 ià(
İt
 == 1){

19 
Vec
<
zz_p
> 
d©
;

20 
d©
.
	`S‘L’gth
(2*
i
-1);

21 
j
 = 0; j < 2*
i
-1; j++)

22 
d©
[
j
] = j;

24 
hªk–
 
	`h
(
d©
, 
i
, i);

25 
M©
<
zz_p
> 
M
;

27 
	`to_d’£
(
M
, 
h
);

29 
cout
 << 
M
 << 
’dl
;

30 
cout
 << 
’dl
;

33 
cout
 << 
i
 << " ";

35 
t
;

37 
t
 = 
	`G‘Time
();

38 
j
 = 0; j < 10000; j++)

40 
t
 = 
	`G‘Time
() -;

41 
cout
 << 
t
 << " ";

43 
cout
 << 
’dl
;

46 
	}
}

53 
	$maš
(
¬gc
, ** 
¬gv
){

54 
İt
 = 0;

55 ià(
¬gc
 > 1)

56 
İt
 = 
	`©oi
(
¬gv
[1]);

57 
	`check
(
İt
);

60 
	}
}

	@mosaic_hankel/test/test_last_column_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

52 
	`Ï¡_cŞumn_of_block
(
cŞ
, 0, 
MH
);

53 
j
 = 0; j < 2; j++)

54 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 
i
-1));

55 
j
 = 0; j < 
i
-1; j++)

56 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h10
(j, 
i
-1));

58 
	`Ï¡_cŞumn_of_block
(
cŞ
, 1, 
MH
);

59 
j
 = 0; j < 2; j++)

60 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h01
(j, 2-1));

61 
j
 = 0; j < 
i
-1; j++)

62 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h11
(j, 2-1));

64 
	`Ï¡_cŞumn_of_block
(
cŞ
, 2, 
MH
);

65 
j
 = 0; j < 2; j++)

66 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h02
(j, 
i
-1));

67 
j
 = 0; j < 
i
-1; j++)

68 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h12
(j, 
i
-1));

70 
cout
 << 
i
 << 
’dl
;

73 
cout
 << 
i
 << " ";

75 
t
;

77 
t
 = 
	`G‘Time
();

78 
j
 = 0; j < 10000; j++)

80 
t
 = 
	`G‘Time
() -;

81 
cout
 << 
t
 << " ";

83 
cout
 << 
’dl
;

86 
	}
}

93 
	$maš
(
¬gc
, ** 
¬gv
){

94 
İt
 = 0;

95 ià(
¬gc
 > 1)

96 
İt
 = 
	`©oi
(
¬gv
[1]);

97 
	`check
(
İt
);

100 
	}
}

	@mosaic_hankel/test/test_last_row_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

53 
	`Ï¡_row_of_block
(
cŞ
, 0, 
MH
);

54 
j
 = 0; j < 
i
; j++)

55 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 1));

56 
j
 = 0; j < 2; j++)

57 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h01
(j, 1));

58 
j
 = 0; j < 
i
; j++)

59 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h02
(j, 1));

61 
	`Ï¡_row_of_block
(
cŞ
, 1, 
MH
);

62 
j
 = 0; j < 
i
; j++)

63 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h10
(j, 
i
-2));

64 
j
 = 0; j < 2; j++)

65 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h11
(j, i-2));

66 
j
 = 0; j < 
i
; j++)

67 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h12
(j, i-2));

69 
cout
 << 
i
 << 
’dl
;

72 
cout
 << 
i
 << " ";

74 
t
;

76 
t
 = 
	`G‘Time
();

77 
j
 = 0; j < 10000; j++)

79 
t
 = 
	`G‘Time
() -;

80 
cout
 << 
t
 << " ";

82 
cout
 << 
’dl
;

85 
	}
}

92 
	$maš
(
¬gc
, ** 
¬gv
){

93 
İt
 = 0;

94 ià(
¬gc
 > 1)

95 
İt
 = 
	`©oi
(
¬gv
[1]);

96 
	`check
(
İt
);

99 
	}
}

	@mosaic_hankel/test/test_mosaic_first_column_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

52 
	`fœ¡_cŞumn_of_block
(
cŞ
, 0, 
MH
);

53 
j
 = 0; j < 2; j++)

54 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 0));

55 
j
 = 0; j < 
i
-1; j++)

56 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h10
(j, 0));

58 
	`fœ¡_cŞumn_of_block
(
cŞ
, 1, 
MH
);

59 
j
 = 0; j < 2; j++)

60 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h01
(j, 0));

61 
j
 = 0; j < 
i
-1; j++)

62 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h11
(j, 0));

64 
	`fœ¡_cŞumn_of_block
(
cŞ
, 2, 
MH
);

65 
j
 = 0; j < 2; j++)

66 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h02
(j, 0));

67 
j
 = 0; j < 
i
-1; j++)

68 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h12
(j, 0));

70 
cout
 << 
i
 << 
’dl
;

73 
cout
 << 
i
 << " ";

75 
t
;

77 
t
 = 
	`G‘Time
();

78 
j
 = 0; j < 10000; j++)

80 
t
 = 
	`G‘Time
() -;

81 
cout
 << 
t
 << " ";

83 
cout
 << 
’dl
;

86 
	}
}

93 
	$maš
(
¬gc
, ** 
¬gv
){

94 
İt
 = 0;

95 ià(
¬gc
 > 1)

96 
İt
 = 
	`©oi
(
¬gv
[1]);

97 
	`check
(
İt
);

100 
	}
}

	@mosaic_hankel/test/test_mosaic_first_row_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

53 
	`fœ¡_row_of_block
(
cŞ
, 0, 
MH
);

54 
j
 = 0; j < 
i
; j++)

55 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 0));

56 
j
 = 0; j < 2; j++)

57 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h01
(j, 0));

58 
j
 = 0; j < 
i
; j++)

59 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h02
(j, 0));

61 
	`fœ¡_row_of_block
(
cŞ
, 1, 
MH
);

62 
j
 = 0; j < 
i
; j++)

63 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h10
(j, 0));

64 
j
 = 0; j < 2; j++)

65 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h11
(j, 0));

66 
j
 = 0; j < 
i
; j++)

67 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h12
(j, 0));

69 
cout
 << 
i
 << 
’dl
;

72 
cout
 << 
i
 << " ";

74 
t
;

76 
t
 = 
	`G‘Time
();

77 
j
 = 0; j < 10000; j++)

79 
t
 = 
	`G‘Time
() -;

80 
cout
 << 
t
 << " ";

82 
cout
 << 
’dl
;

85 
	}
}

92 
	$maš
(
¬gc
, ** 
¬gv
){

93 
İt
 = 0;

94 ià(
¬gc
 > 1)

95 
İt
 = 
	`©oi
(
¬gv
[1]);

96 
	`check
(
İt
);

99 
	}
}

	@mosaic_hankel/test/test_mosaic_generators.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<NTL/m©_lzz_p.h
>

3 
	~<as£¹.h
>

5 
	~"mo§ic_hªk–.h
"

7 
NTL_CLIENT


9 
do_Z
(
M©
<
zz_p
>& 
M
, 
n
, cÚ¡ zz_p& 
c
){

10 
	gM
.
S‘Dims
(
n
,‚);

11 
	gi
 = 0; i < 
	gn
; i++)

12 
	gj
 = 0; j < 
	gn
; j++)

13 
	gM
[
i
][
j
] = 0;

14 
	gi
 = 0; i < 
	gn
-1; i++)

15 
	gM
[
i
+1][i] = 1;

16 
	gM
[0][
n
-1] = 
c
;

19 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

20 
	gv
.
S‘L’gth
(
n
+
m
-1);

21 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

22 
	gv
[
i
] = 
¿ndom_zz_p
();

29 
	$check
(
İt
){

30 
zz_p
::
	`FFTIn™
(0);

31 
i
 = 2; i < 110; i += 1){

33 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

35 
	`¿ndom
(
d©00
, 2, 
i
);

36 
	`¿ndom
(
d©01
, 2, 2);

37 
	`¿ndom
(
d©02
, 2, 
i
);

38 
	`¿ndom
(
d©10
, 
i
-1, i);

39 
	`¿ndom
(
d©11
, 
i
-1, 2);

40 
	`¿ndom
(
d©12
, 
i
-1, i);

42 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

44 
Vec
<
hªk–
> 
row0
, 
row1
;

46 
row0
.
	`S‘L’gth
(3);

47 
row0
[0] = 
h00
;

48 
row0
[1] = 
h01
;

49 
row0
[2] = 
h02
;

50 
row1
.
	`S‘L’gth
(3);

51 
row1
[0] = 
h10
;

52 
row1
[1] = 
h11
;

53 
row1
[2] = 
h12
;

54 
Vec
< Vec<
hªk–
> > 
H
;

55 
H
.
	`S‘L’gth
(2);

56 
H
[0] = 
row0
;

57 
H
[1] = 
row1
;

59 
mo§ic_hªk–
 
	`MH
(
H
);

61 ià(
İt
 == 1){

63 
M©
<
zz_p
> 
G
, 
H
;

64 
	`g’”©Üs
(
G
, 
H
, 
MH
);

66 
M©
<
zz_p
> 
Z1
, 
Z0
, 
M_d’£
;

67 
	`do_Z
(
Z1
, 
MH
.
	`NumRows
(), 
	`to_zz_p
(1));

68 
	`do_Z
(
Z0
, 
MH
.
	`NumCŞs
(), 
	`to_zz_p
(0));

69 
	`to_d’£
(
M_d’£
, 
MH
);

71 
M©
<
zz_p
> 
»s
 = 
Z1
*
M_d’£
-M_d’£*
	`Œª¥o£
(
Z0
);

72 
	`as£¹
 (
»s
 =ğ
G
*
	`Œª¥o£
(
H
));

73 
cout
 << 
i
 << " ";

74 
cout
 << 
’dl
;

77 
cout
 << 
i
 << " ";

79 
t
;

81 
t
 = 
	`G‘Time
();

82 
j
 = 0; j < 10000; j++)

84 
t
 = 
	`G‘Time
() -;

85 
cout
 << 
t
 << " ";

87 
cout
 << 
’dl
;

90 
	}
}

97 
	$maš
(
¬gc
, ** 
¬gv
){

98 
İt
 = 0;

99 ià(
¬gc
 > 1)

100 
İt
 = 
	`©oi
(
¬gv
[1]);

101 
	`check
(
İt
);

104 
	}
}

	@mosaic_hankel/test/test_mosaic_init.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

22 
i
 = 2; i < 10; i += 1){

24 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

26 
	`¿ndom
(
d©00
, 2, 
i
);

27 
	`¿ndom
(
d©01
, 2, 2);

28 
	`¿ndom
(
d©02
, 2, 
i
);

29 
	`¿ndom
(
d©10
, 
i
-1, i);

30 
	`¿ndom
(
d©11
, 
i
-1, 2);

31 
	`¿ndom
(
d©12
, 
i
-1, i);

33 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

34 
Vec
<
hªk–
> 
row0
, 
row1
;

36 
row0
.
	`S‘L’gth
(3);

37 
row0
[0] = 
h00
;

38 
row0
[1] = 
h01
;

39 
row0
[2] = 
h02
;

40 
row1
.
	`S‘L’gth
(3);

41 
row1
[0] = 
h10
;

42 
row1
[1] = 
h11
;

43 
row1
[2] = 
h12
;

44 
Vec
< Vec<
hªk–
> > 
H
;

45 
H
.
	`S‘L’gth
(2);

46 
H
[0] = 
row0
;

47 
H
[1] = 
row1
;

49 
mo§ic_hªk–
 
	`MH
(
H
);

51 ià(
İt
 == 1){

52 
cout
 << 
i
 << " " << 
MH
.
	`NumRows
(è<< " " << MH.
	`NumCŞs
();

53 
cout
 << 
’dl
;

56 
cout
 << 
i
 << " ";

58 
t
;

60 
t
 = 
	`G‘Time
();

61 
j
 = 0; j < 10000; j++)

63 
t
 = 
	`G‘Time
() -;

64 
cout
 << 
t
 << " ";

66 
cout
 << 
’dl
;

69 
	}
}

76 
	$maš
(
¬gc
, ** 
¬gv
){

77 
İt
 = 0;

78 ià(
¬gc
 > 1)

79 
İt
 = 
	`©oi
(
¬gv
[1]);

80 
	`check
(
İt
);

83 
	}
}

	@mosaic_hankel/test/test_mosaic_last_column_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

52 
	`Ï¡_cŞumn_of_block
(
cŞ
, 0, 
MH
);

53 
j
 = 0; j < 2; j++)

54 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 
i
-1));

55 
j
 = 0; j < 
i
-1; j++)

56 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h10
(j, 
i
-1));

58 
	`Ï¡_cŞumn_of_block
(
cŞ
, 1, 
MH
);

59 
j
 = 0; j < 2; j++)

60 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h01
(j, 2-1));

61 
j
 = 0; j < 
i
-1; j++)

62 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h11
(j, 2-1));

64 
	`Ï¡_cŞumn_of_block
(
cŞ
, 2, 
MH
);

65 
j
 = 0; j < 2; j++)

66 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h02
(j, 
i
-1));

67 
j
 = 0; j < 
i
-1; j++)

68 
	`as£¹
 (
cŞ
[
j
+2] =ğ
	`h12
(j, 
i
-1));

70 
cout
 << 
i
 << 
’dl
;

73 
cout
 << 
i
 << " ";

75 
t
;

77 
t
 = 
	`G‘Time
();

78 
j
 = 0; j < 10000; j++)

80 
t
 = 
	`G‘Time
() -;

81 
cout
 << 
t
 << " ";

83 
cout
 << 
’dl
;

86 
	}
}

93 
	$maš
(
¬gc
, ** 
¬gv
){

94 
İt
 = 0;

95 ià(
¬gc
 > 1)

96 
İt
 = 
	`©oi
(
¬gv
[1]);

97 
	`check
(
İt
);

100 
	}
}

	@mosaic_hankel/test/test_mosaic_last_row_of_block.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 100; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
Vec
<
zz_p
> 
cŞ
;

53 
	`Ï¡_row_of_block
(
cŞ
, 0, 
MH
);

54 
j
 = 0; j < 
i
; j++)

55 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h00
(j, 1));

56 
j
 = 0; j < 2; j++)

57 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h01
(j, 1));

58 
j
 = 0; j < 
i
; j++)

59 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h02
(j, 1));

61 
	`Ï¡_row_of_block
(
cŞ
, 1, 
MH
);

62 
j
 = 0; j < 
i
; j++)

63 
	`as£¹
 (
cŞ
[
j
] =ğ
	`h10
(j, 
i
-2));

64 
j
 = 0; j < 2; j++)

65 
	`as£¹
 (
cŞ
[
j
+
i
] =ğ
	`h11
(j, i-2));

66 
j
 = 0; j < 
i
; j++)

67 
	`as£¹
 (
cŞ
[
j
+
i
+2] =ğ
	`h12
(j, i-2));

69 
cout
 << 
i
 << 
’dl
;

72 
cout
 << 
i
 << " ";

74 
t
;

76 
t
 = 
	`G‘Time
();

77 
j
 = 0; j < 10000; j++)

79 
t
 = 
	`G‘Time
() -;

80 
cout
 << 
t
 << " ";

82 
cout
 << 
’dl
;

85 
	}
}

92 
	$maš
(
¬gc
, ** 
¬gv
){

93 
İt
 = 0;

94 ià(
¬gc
 > 1)

95 
İt
 = 
	`©oi
(
¬gv
[1]);

96 
	`check
(
İt
);

99 
	}
}

	@mosaic_hankel/test/test_mosaic_mul_left.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 1000; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

52 
Vec
<
zz_p
> 
šput
, 
ouut
;

53 
šput
.
	`S‘L’gth
(
MH
.
	`NumRows
());

54 
a
 = 0;‡ < 
MH
.
	`NumRows
();‡++)

55 
šput
[
a
] = 
	`¿ndom_zz_p
();

56 
ouut
.
	`S‘L’gth
(
MH
.
	`NumCŞs
());

57 
a
 = 0;‡ < 
MH
.
	`NumCŞs
();‡++)

58 
ouut
[
a
] = 
	`¿ndom_zz_p
();

60 
	`mul_Ëá
(
ouut
, 
MH
, 
šput
);

62 
Vec
<
zz_p
> 
ouut2
;

63 
M©
<
zz_p
> 
Md’£
;

64 
	`to_d’£
(
Md’£
, 
MH
);

65 
ouut2
 = 
šput
*
Md’£
;

67 
	`as£¹
(
ouut2
 =ğ
ouut
);

68 
cout
 << 
i
 << 
’dl
;

71 
cout
 << 
i
 << " ";

73 
t
;

75 
t
 = 
	`G‘Time
();

76 
j
 = 0; j < 10000; j++)

78 
t
 = 
	`G‘Time
() -;

79 
cout
 << 
t
 << " ";

81 
cout
 << 
’dl
;

84 
	}
}

91 
	$maš
(
¬gc
, ** 
¬gv
){

92 
İt
 = 0;

93 ià(
¬gc
 > 1)

94 
İt
 = 
	`©oi
(
¬gv
[1]);

95 
	`check
(
İt
);

98 
	}
}

	@mosaic_hankel/test/test_mosaic_mul_right.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 1000; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

52 
Vec
<
zz_p
> 
šput
, 
ouut
;

53 
šput
.
	`S‘L’gth
(
MH
.
	`NumCŞs
());

54 
a
 = 0;‡ < 
MH
.
	`NumCŞs
();‡++)

55 
šput
[
a
] = 
	`¿ndom_zz_p
();

56 
ouut
.
	`S‘L’gth
(
MH
.
	`NumRows
());

57 
a
 = 0;‡ < 
MH
.
	`NumRows
();‡++)

58 
ouut
[
a
] = 
	`¿ndom_zz_p
();

60 
	`mul_right
(
ouut
, 
MH
, 
šput
);

62 
Vec
<
zz_p
> 
ouut2
;

63 
M©
<
zz_p
> 
Md’£
;

64 
	`to_d’£
(
Md’£
, 
MH
);

65 
ouut2
 = 
Md’£
*
šput
;

67 
	`as£¹
(
ouut2
 =ğ
ouut
);

68 
cout
 << 
i
 << 
’dl
;

71 
cout
 << 
i
 << " ";

73 
t
;

75 
t
 = 
	`G‘Time
();

76 
j
 = 0; j < 10000; j++)

78 
t
 = 
	`G‘Time
() -;

79 
cout
 << 
t
 << " ";

81 
cout
 << 
’dl
;

84 
	}
}

91 
	$maš
(
¬gc
, ** 
¬gv
){

92 
İt
 = 0;

93 ià(
¬gc
 > 1)

94 
İt
 = 
	`©oi
(
¬gv
[1]);

95 
	`check
(
İt
);

98 
	}
}

	@mosaic_hankel/test/test_mosaic_to_dense.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 10; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

51 
M©
<
zz_p
> 
Md’£
;

52 
	`to_d’£
(
Md’£
, 
MH
);

53 
cout
 << 
i
 << 
’dl
 << 
Md’£
;

54 
cout
 << 
’dl
;

57 
cout
 << 
i
 << " ";

59 
t
;

61 
t
 = 
	`G‘Time
();

62 
j
 = 0; j < 10000; j++)

64 
t
 = 
	`G‘Time
() -;

65 
cout
 << 
t
 << " ";

67 
cout
 << 
’dl
;

70 
	}
}

77 
	$maš
(
¬gc
, ** 
¬gv
){

78 
İt
 = 0;

79 ià(
¬gc
 > 1)

80 
İt
 = 
	`©oi
(
¬gv
[1]);

81 
	`check
(
İt
);

84 
	}
}

	@mosaic_hankel/test/test_mul_left.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i1
 = 1; i1 < 50; i1 += 1)

16 
i2
 = 1; i2 < 50; i2 += 1){

18 ià(
İt
 == 1){

19 
Vec
<
zz_p
> 
d©
;

20 
d©
.
	`S‘L’gth
(
i1
+
i2
-1);

21 
j
 = 0; j < 
i1
+
i2
-1; j++)

22 
d©
[
j
] = j;

24 
hªk–
 
	`h
(
d©
, 
i1
, 
i2
);

26 
Vec
<
zz_p
> 
šput
, 
ouut
;

27 
šput
.
	`S‘L’gth
(
i1
);

28 
j
 = 0; j < 
i1
; j++)

29 
šput
[
j
] = 
	`¿ndom_zz_p
();

30 
ouut
.
	`S‘L’gth
(
i2
);

32 
Vec
<> 
šput_lÚg
, 
ouut_lÚg
;

33 
	`cÚv
(
šput_lÚg
, 
šput
);

34 
ouut_lÚg
.
	`S‘L’gth
(
i2
);

36 
	`mul_Ëá
(
ouut_lÚg
.
_vec__»p
.
»p
, 
h
, 
šput_lÚg
._vec__rep.rep);

38 
	`cÚv
(
ouut
, 
ouut_lÚg
);

40 
M©
<
zz_p
> 
M
;

41 
	`to_d’£
(
M
, 
h
);

42 
Vec
<
zz_p
> 
ouut2
 = 
šput
*
M
;

44 
	`as£¹
 (
ouut
 =ğ
ouut2
);

45 
cout
 << 
i1
 << " " << 
i2
 << 
’dl
;

48 
cout
 << 
i1
 << " ";

50 
t
;

52 
t
 = 
	`G‘Time
();

53 
j
 = 0; j < 10000; j++)

55 
t
 = 
	`G‘Time
() -;

56 
cout
 << 
t
 << " ";

58 
cout
 << 
’dl
;

61 
	}
}

68 
	$maš
(
¬gc
, ** 
¬gv
){

69 
İt
 = 0;

70 ià(
¬gc
 > 1)

71 
İt
 = 
	`©oi
(
¬gv
[1]);

72 
	`check
(
İt
);

75 
	}
}

	@mosaic_hankel/test/test_mul_left_mosaic.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 1000; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

52 
Vec
<
zz_p
> 
šput
, 
ouut
;

53 
šput
.
	`S‘L’gth
(
MH
.
	`NumRows
());

54 
a
 = 0;‡ < 
MH
.
	`NumRows
();‡++)

55 
šput
[
a
] = 
	`¿ndom_zz_p
();

56 
ouut
.
	`S‘L’gth
(
MH
.
	`NumCŞs
());

57 
a
 = 0;‡ < 
MH
.
	`NumCŞs
();‡++)

58 
ouut
[
a
] = 
	`¿ndom_zz_p
();

60 
	`mul_Ëá
(
ouut
, 
MH
, 
šput
);

62 
Vec
<
zz_p
> 
ouut2
;

63 
M©
<
zz_p
> 
Md’£
;

64 
	`to_d’£
(
Md’£
, 
MH
);

65 
ouut2
 = 
šput
*
Md’£
;

67 
	`as£¹
(
ouut2
 =ğ
ouut
);

68 
cout
 << 
i
 << 
’dl
;

71 
cout
 << 
i
 << " ";

73 
t
;

75 
t
 = 
	`G‘Time
();

76 
j
 = 0; j < 10000; j++)

78 
t
 = 
	`G‘Time
() -;

79 
cout
 << 
t
 << " ";

81 
cout
 << 
’dl
;

84 
	}
}

91 
	$maš
(
¬gc
, ** 
¬gv
){

92 
İt
 = 0;

93 ià(
¬gc
 > 1)

94 
İt
 = 
	`©oi
(
¬gv
[1]);

95 
	`check
(
İt
);

98 
	}
}

	@mosaic_hankel/test/test_mul_right.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i1
 = 1; i1 < 50; i1 += 1)

16 
i2
 = 1; i2 < 50; i2 += 1){

18 ià(
İt
 == 1){

19 
Vec
<
zz_p
> 
d©
;

20 
d©
.
	`S‘L’gth
(
i1
+
i2
-1);

21 
j
 = 0; j < 
i1
+
i2
-1; j++)

22 
d©
[
j
] = j;

24 
hªk–
 
	`h
(
d©
, 
i1
, 
i2
);

26 
Vec
<
zz_p
> 
šput
, 
ouut
;

27 
šput
.
	`S‘L’gth
(
i2
);

28 
j
 = 0; j < 
i2
; j++)

29 
šput
[
j
] = 
	`¿ndom_zz_p
();

30 
ouut
.
	`S‘L’gth
(
i1
);

32 
Vec
<> 
šput_lÚg
, 
ouut_lÚg
;

33 
	`cÚv
(
šput_lÚg
, 
šput
);

34 
ouut_lÚg
.
	`S‘L’gth
(
i1
);

36 
	`mul_right
(
ouut_lÚg
.
_vec__»p
.
»p
, 
h
, 
šput_lÚg
._vec__rep.rep);

38 
	`cÚv
(
ouut
, 
ouut_lÚg
);

40 
M©
<
zz_p
> 
M
;

41 
	`to_d’£
(
M
, 
h
);

42 
Vec
<
zz_p
> 
ouut2
 = 
M
*
šput
;

44 
	`as£¹
 (
ouut
 =ğ
ouut2
);

45 
cout
 << 
i1
 << " " << 
i2
 << 
’dl
;

48 
cout
 << 
i1
 << " ";

50 
t
;

52 
t
 = 
	`G‘Time
();

53 
j
 = 0; j < 10000; j++)

55 
t
 = 
	`G‘Time
() -;

56 
cout
 << 
t
 << " ";

58 
cout
 << 
’dl
;

61 
	}
}

68 
	$maš
(
¬gc
, ** 
¬gv
){

69 
İt
 = 0;

70 ià(
¬gc
 > 1)

71 
İt
 = 
	`©oi
(
¬gv
[1]);

72 
	`check
(
İt
);

75 
	}
}

	@mosaic_hankel/test/test_mul_right_mosaic.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"mo§ic_hªk–.h
"

6 
NTL_CLIENT


8 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

9 
	gv
.
S‘L’gth
(
n
+
m
-1);

10 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

11 
	gv
[
i
] = 
¿ndom_zz_p
();

18 
	$check
(
İt
){

19 
zz_p
::
	`FFTIn™
(0);

20 
i
 = 2; i < 1000; i += 1){

22 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

24 
	`¿ndom
(
d©00
, 2, 
i
);

25 
	`¿ndom
(
d©01
, 2, 2);

26 
	`¿ndom
(
d©02
, 2, 
i
);

27 
	`¿ndom
(
d©10
, 
i
-1, i);

28 
	`¿ndom
(
d©11
, 
i
-1, 2);

29 
	`¿ndom
(
d©12
, 
i
-1, i);

31 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

33 
Vec
<
hªk–
> 
row0
, 
row1
;

35 
row0
.
	`S‘L’gth
(3);

36 
row0
[0] = 
h00
;

37 
row0
[1] = 
h01
;

38 
row0
[2] = 
h02
;

39 
row1
.
	`S‘L’gth
(3);

40 
row1
[0] = 
h10
;

41 
row1
[1] = 
h11
;

42 
row1
[2] = 
h12
;

43 
Vec
< Vec<
hªk–
> > 
H
;

44 
H
.
	`S‘L’gth
(2);

45 
H
[0] = 
row0
;

46 
H
[1] = 
row1
;

48 
mo§ic_hªk–
 
	`MH
(
H
);

50 ià(
İt
 == 1){

52 
Vec
<
zz_p
> 
šput
, 
ouut
;

53 
šput
.
	`S‘L’gth
(
MH
.
	`NumCŞs
());

54 
a
 = 0;‡ < 
MH
.
	`NumCŞs
();‡++)

55 
šput
[
a
] = 
	`¿ndom_zz_p
();

56 
ouut
.
	`S‘L’gth
(
MH
.
	`NumRows
());

57 
a
 = 0;‡ < 
MH
.
	`NumRows
();‡++)

58 
ouut
[
a
] = 
	`¿ndom_zz_p
();

60 
	`mul_right
(
ouut
, 
MH
, 
šput
);

62 
Vec
<
zz_p
> 
ouut2
;

63 
M©
<
zz_p
> 
Md’£
;

64 
	`to_d’£
(
Md’£
, 
MH
);

65 
ouut2
 = 
Md’£
*
šput
;

67 
	`as£¹
(
ouut2
 =ğ
ouut
);

68 
cout
 << 
i
 << 
’dl
;

71 
cout
 << 
i
 << " ";

73 
t
;

75 
t
 = 
	`G‘Time
();

76 
j
 = 0; j < 10000; j++)

78 
t
 = 
	`G‘Time
() -;

79 
cout
 << 
t
 << " ";

81 
cout
 << 
’dl
;

84 
	}
}

91 
	$maš
(
¬gc
, ** 
¬gv
){

92 
İt
 = 0;

93 ià(
¬gc
 > 1)

94 
İt
 = 
	`©oi
(
¬gv
[1]);

95 
	`check
(
İt
);

98 
	}
}

	@mosaic_hankel/test/test_to_cauchy_grp.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<NTL/m©_lzz_p.h
>

3 
	~<as£¹.h
>

5 
	~"mo§ic_hªk–.h
"

6 
	~"lzz_pX_CRT.h
"

7 
	~"ÿuchy_geom‘ric_¥ecŸl.h
"

9 
NTL_CLIENT


11 
to_d’£
(
M©
<
zz_p
>& 
M
, cÚ¡ 
Vec
<zz_p>& 
e
){

12 
	gn
 = 
e
.
Ëngth
();

13 
	gM
.
S‘Dims
(
n
,‚);

14 
	gi
 = 0; i < 
	gn
; i++)

15 
	gj
 = 0; j < 
	gn
; j++)

16 
	gM
[
i
][
j
] = 0;

17 
	gi
 = 0; i < 
	gn
; i++)

18 
	gM
[
i
][i] = 
e
[i];

21 
do_Z
(
M©
<
zz_p
>& 
M
, 
n
, cÚ¡ zz_p& 
c
){

22 
	gM
.
S‘Dims
(
n
,‚);

23 
	gi
 = 0; i < 
	gn
; i++)

24 
	gj
 = 0; j < 
	gn
; j++)

25 
	gM
[
i
][
j
] = 0;

26 
	gi
 = 0; i < 
	gn
-1; i++)

27 
	gM
[
i
+1][i] = 1;

28 
	gM
[0][
n
-1] = 
c
;

31 
¿ndom
(
Vec
<
zz_p
>& 
v
, 
n
, 
m
){

32 
	gv
.
S‘L’gth
(
n
+
m
-1);

33 
	gi
 = 0; i < 
	gn
+
	gm
-1; i++)

34 
	gv
[
i
] = 
¿ndom_zz_p
();

41 
	$check
(
İt
){

42 
zz_p
::
	`FFTIn™
(0);

45 
i
 = 2; i < 110; i += 1){

47 
Vec
<
zz_p
> 
d©00
, 
d©01
, 
d©02
, 
d©10
, 
d©11
, 
d©12
;

49 
	`¿ndom
(
d©00
, 2, 
i
);

50 
	`¿ndom
(
d©01
, 2, 2);

51 
	`¿ndom
(
d©02
, 2, 
i
);

52 
	`¿ndom
(
d©10
, 
i
-1, i);

53 
	`¿ndom
(
d©11
, 
i
-1, 2);

54 
	`¿ndom
(
d©12
, 
i
-1, i);

56 
hªk–
 
	`h00
(
d©00
, 2, 
i
), 
	`h01
(
d©01
, 2, 2), 
	`h02
(
d©02
, 2, i), 
	`h10
(
d©10
, i-1, i), 
	`h11
(
d©11
, i-1, 2), 
	`h12
(
d©12
, i-1, i);

58 
Vec
<
hªk–
> 
row0
, 
row1
;

60 
row0
.
	`S‘L’gth
(3);

61 
row0
[0] = 
h00
;

62 
row0
[1] = 
h01
;

63 
row0
[2] = 
h02
;

64 
row1
.
	`S‘L’gth
(3);

65 
row1
[0] = 
h10
;

66 
row1
[1] = 
h11
;

67 
row1
[2] = 
h12
;

68 
Vec
< Vec<
hªk–
> > 
H
;

69 
H
.
	`S‘L’gth
(2);

70 
H
[0] = 
row0
;

71 
H
[1] = 
row1
;

73 
mo§ic_hªk–
 
	`MH
(
H
);

75 ià(
İt
 == 1){

77 
ÿuchy_like_geom‘ric_¥ecŸl
 
CL
;

78 
M©
<
zz_p
> 
X
, 
Y
;

79 
Vec
<
zz_p
> 
e
, 
f
;

80 
zz_pX_MuÉošt_Geom‘ric
 
X_št
, 
Y_št
;

82 
	`to_ÿuchy_g½
(
CL
, 
X_št
, 
Y_št
, 
e
, 
f
, 
MH
);

84 
M©
<
zz_p
> 
MM
, 
MC
, 
MX_i
, 
MY_i
, 
Me
, 
Mf
;

85 
	`to_d’£
(
MM
, 
MH
);

86 
	`to_d’£
(
MC
, 
CL
);

87 
	`to_d’£
(
MX_i
, 
X_št
);

88 
	`to_d’£
(
MY_i
, 
Y_št
);

89 
	`to_d’£
(
Me
, 
e
);

90 
	`to_d’£
(
Mf
, 
f
);

92 
M©
<
zz_p
> 
T
 = 
Me
*
MX_i
*
MM
*
	`Œª¥o£
(
Mf
*
MY_i
);

93 
	`as£¹
 (
T
 =ğ
MC
);

95 
cout
 << 
i
 << " ";

96 
cout
 << 
’dl
;

99 
cout
 << 
i
 << " ";

101 
t
;

103 
t
 = 
	`G‘Time
();

104 
j
 = 0; j < 10000; j++)

106 
t
 = 
	`G‘Time
() -;

107 
cout
 << 
t
 << " ";

109 
cout
 << 
’dl
;

112 
	}
}

119 
	$maš
(
¬gc
, ** 
¬gv
){

120 
İt
 = 0;

121 ià(
¬gc
 > 1)

122 
İt
 = 
	`©oi
(
¬gv
[1]);

123 
	`check
(
İt
);

126 
	}
}

	@sage_output/sage_output.h

1 #iâdeà
SAGE_OUTPUT__H


2 
	#SAGE_OUTPUT__H


	)

4 
	~<NTL/lzz_pX.h
>

5 
	~<NTL/veùÜ.h
>

7 
NTL_CLIENT


20 
§ge_š™
();

25 
§ge_š™_X
();

30 
§ge_ouut
(cÚ¡ 
Vec
<
zz_p
> & 
v
);

35 
§ge_assign
(cÚ¡ 
Vec
<
zz_p
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

40 
§ge_ouut
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
);

45 
§ge_ouut
(cÚ¡ 
zz_pX
 & 
v
);

50 
§ge_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
);

55 
§ge_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
);

	@sage_output/src/sage_output.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
NTL_CLIENT


9 
	$§ge_š™
(){

10 
cout
 << "k = GF(" << 
zz_p
::
	`modulus
() << ")\n";

11 
	}
}

16 
	$§ge_š™_X
(){

17 
cout
 << "U.<x> = PolynomialRing(k)\n";

18 
	}
}

23 
§ge_ouut
(cÚ¡ 
Vec
<
zz_p
> & 
v
){

24 ià(
	gv
.
Ëngth
() == 0){

25 
cout
 << "[]";

28 
	gcout
 << "[";

29 
	gi
 = 0; i < 
	gv
.
Ëngth
()-1; i++)

30 
	gcout
 << 
	gv
[
i
] << ", ";

31 
	gcout
 << 
	gv
[
v
.
Ëngth
()-1] << "]";

37 
§ge_assign
(cÚ¡ 
Vec
<
zz_p
> & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

38 
	gcout
 << 
	gÇme
 << " = ";

39 
§ge_ouut
(
v
);

40 
	gcout
 << 
	g’dl
;

46 
	$§ge_ouut
(cÚ¡ 
zz_pX
 & 
v
){

47 
cout
 << "U(";

48 
	`§ge_ouut
(
v
.
»p
);

49 
cout
 << ")";

50 
	}
}

55 
	$§ge_ouut
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
){

56 
cout
 << "(" << 
v¬
 << ".parent()(0)";

57 
i
 = 0; i <ğ
	`deg
(
v
); i++)

58 
cout
 << "+(" << 
	`cÛff
(
v
, 
i
è<< ")*" << 
v¬
 << "^" << i;

59 
cout
 << ")";

60 
	}
}

65 
	$§ge_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
v¬
, cÚ¡ sŒšg & 
Çme
){

66 
cout
 << 
Çme
 << " = ";

67 
	`§ge_ouut
(
v
, 
v¬
);

68 
cout
 << 
’dl
;

69 
	}
}

74 
	$§ge_assign
(cÚ¡ 
zz_pX
 & 
v
, cÚ¡ 
¡ršg
 & 
Çme
){

75 
	`§ge_assign
(
v
, "x", 
Çme
);

76 
	}
}

	@sage_output/test/test_sage_output.cpp

1 
	~<NTL/lzz_pX.h
>

2 
	~<NTL/veùÜ.h
>

4 
	~"§ge_ouut.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

14 
p
 = 1125899906842679;

15 
zz_p
::
	`š™
(
p
);

17 
	`§ge_š™
();

18 
	`§ge_š™_X
();

20 
Vec
<
zz_p
> 
v
;

21 
v
.
	`S‘L’gth
(10);

22 
i
 = 0; i < 
v
.
	`Ëngth
(); i++)

23 
v
[
i
] = 
	`¿ndom_zz_p
();

24 
	`§ge_assign
(
v
, "v");

26 
zz_pX
 
f
 = 
	`¿ndom_zz_pX
(10);

27 
	`§ge_assign
(
f
, "f");

28 
	`§ge_ouut
(
f
, "x");

30 
	}
}

32 
	$maš
(
¬gc
, ** 
¬gv
){

33 
İt
 = 0;

34 ià(
¬gc
 > 1)

35 
İt
 = 
	`©oi
(
¬gv
[1]);

36 
	`check
(
İt
);

38 
	}
}

	@vec_lzz_p_extra/src/vec_lzz_p_extra.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<NTL/m©_lzz_p.h
>

4 
NTL_CLIENT


17 
	$¿ndom
(
vec_zz_p
& 
A
, 
d
){

18 
A
.
	`S‘L’gth
(
d
);

19 
i
 = 0; i < 
A
.
	`Ëngth
(); i++)

20 
A
[
i
] = 
	`¿ndom_zz_p
();

21 
	}
}

26 
	$¿ndom
(
m©_zz_p
& 
A
, 
d
, 
e
){

27 
A
.
	`S‘Dims
(
d
, 
e
);

28 
i
 = 0; i < 
d
; i++)

29 
j
 = 0; j < 
e
; j++)

30 
A
[
i
][
j
] = 
	`¿ndom_zz_p
();

31 
	}
}

36 
	$šv_Çive
(
vec_zz_p
& 
švA
, cÚ¡ vec_zz_p& 
A
){

37 
n
 = 
A
.
	`Ëngth
();

38 
švA
.
	`S‘L’gth
(
n
);

40 
i
 = 0; i < 
n
; i++)

41 
švA
[
i
] = 1/
A
[i];

42 
	}
}

47 
	$šv
(
vec_zz_p
& 
švA
, cÚ¡ vec_zz_p& 
A
){

48 
n
 = 
A
.
	`Ëngth
();

49 
vec_zz_p
 
tmp
;

50 
tmp
.
	`S‘L’gth
(
n
);

51 
švA
.
	`S‘L’gth
(
n
);

53 ià(
n
 == 0)

56 
tmp
[0] = 
A
[0];

57 
i
 = 1; i < 
n
; i++)

58 
tmp
[
i
] =mp[i-1]*
A
[i];

59 
zz_p
 
aux
 = 1/
tmp
[
n
-1];

60 
i
 = 
n
-1; i >= 1; i--){

61 
švA
[
i
] = 
aux
*
tmp
[i-1];

62 
aux
 *ğ
A
[
i
];

64 
švA
[0] = 
aux
;

65 
	}
}

70 
	$šv
(
vec_zz_p
& 
A
){

71 
vec_zz_p
 
tmp
 = 
A
;

72 
	`šv
(
A
, 
tmp
);

73 
	}
}

81 #ifdeà
NTL_HAVE_LL_TYPE


83 
	#NTL_CAST_ULL
(
x
è((
NTL_ULL_TYPE
è(x))

	)

84 
	#NTL_MUL_ULL
(
x
,
y
è(
	`NTL_CAST_ULL
(x)*NTL_CAST_ULL(y))

	)

86 
	$IÂ”Prod_LL
(cÚ¡ *
­
, cÚ¡ *
bp
, 
n
){

87 cÚ¡ 
BLKSIZE
 = (1L << 
	`mš
(20, 2*(
NTL_BITS_PER_LONG
-
NTL_SP_NBITS
)));

89 
acc0
 = 0;

90 
NTL_ULL_TYPE
 
acc21
 = 0;

92 
i
;

93 
i
 = 0; i <ğ
n
-
BLKSIZE
; i +ğBLKSIZE, 
­
 +ğBLKSIZE, 
bp
 += BLKSIZE) {

94 
NTL_ULL_TYPE
 
sum
 = 0;

95 
j
 = 0; j < 
BLKSIZE
; j += 4) {

96 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+0], 
bp
[j+0]);

97 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+1], 
bp
[j+1]);

98 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+2], 
bp
[j+2]);

99 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+3], 
bp
[j+3]);

101 
sum
 +ğ
acc0
;

102 
acc0
 = 
sum
;

103 
acc21
 +ğ(è(
sum
 >> 
NTL_BITS_PER_LONG
);

105 ià(
i
 < 
n
) {

106 
NTL_ULL_TYPE
 
sum
 = 0;

107 
j
 = 0;

108 ; 
j
 <ğ
n
-
i
-4; j += 4) {

109 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+0], 
bp
[j+0]);

110 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+1], 
bp
[j+1]);

111 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+2], 
bp
[j+2]);

112 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
+3], 
bp
[j+3]);

114 ; 
j
 < 
n
-
i
; j++)

115 
sum
 +ğ
	`NTL_MUL_ULL
(
­
[
j
], 
bp
[j]);

116 
sum
 +ğ
acc0
;

117 
acc0
 = 
sum
;

118 
acc21
 +ğ(è(
sum
 >> 
NTL_BITS_PER_LONG
);

121 
¥_Î_»duû_¡ruù
 
dšv
 = 
zz_p
::
	`Î_»d_¡ruù
();

122 ià(
dšv
.
nb™s
 =ğ
NTL_SP_NBITS
)

123  
	`¥_Î_»d_31_nÜm®ized
(
acc21
 >> 
NTL_BITS_PER_LONG
,‡cc21, 
acc0
, 
zz_p
::
	`modulus
(), 
dšv
);

125  
	`¥_Î_»d_31
(
acc21
 >> 
NTL_BITS_PER_LONG
,‡cc21, 
acc0
, 
zz_p
::
	`modulus
(), 
dšv
);

126 
	}
}

129 
	$IÂ”Prod_L
(cÚ¡ *
­
, cÚ¡ *
bp
, 
n
){

130 
sum
 = 0;

131 
j
 = 0;

133 ; 
j
 <ğ
n
-4; j += 4) {

134 
sum
 +ğ(
­
[
j
+0]è* (
bp
[j+0]);

135 
sum
 +ğ(
­
[
j
+1]è* (
bp
[j+1]);

136 
sum
 +ğ(
­
[
j
+2]è* (
bp
[j+2]);

137 
sum
 +ğ(
­
[
j
+3]è* (
bp
[j+3]);

140 ; 
j
 < 
n
; j++)

141 
sum
 +ğ(
­
[
j
]è* (
bp
[j]);

143  
	`»m
(
sum
, 
zz_p
::
	`modulus
(), zz_p::
	`»d_¡ruù
());

144 
	}
}

	@vec_lzz_p_extra/test/test_inv.cpp

1 
	~<NTL/vec_lzz_p.h
>

2 
	~<as£¹.h
>

4 
	~"vec_lzz_p_exŒa.h
"

6 
NTL_CLIENT


12 
	$check
(
İt
){

13 
zz_p
::
	`FFTIn™
(0);

15 
i
 = 0; i < 10000; i += 1){

16 
vec_zz_p
 
A
, 
švA1
, 
švA2
;

17 
	`¿ndom
(
A
, 
i
);

19 ià(
İt
 == 1){

20 
	`šv
(
švA1
, 
A
);

21 
	`šv_Çive
(
švA2
, 
A
);

22 
j
 = 0; j < 
i
; j++){

23 
	`as£¹
 (
švA1
[
j
] =ğ
švA2
[j]);

24 
	`as£¹
 (
švA1
[
j
] =ğ1/
A
[j]);

28 
cout
 << 
i
 << " ";

30 
t
;

32 
t
 = 
	`G‘Time
();

33 
j
 = 0; j < 10000; j++)

34 
	`šv
(
švA1
, 
A
);

35 
t
 = 
	`G‘Time
() -;

36 
cout
 << 
t
 << " ";

38 
t
 = 
	`G‘Time
();

39 
j
 = 0; j < 10000; j++)

40 
	`šv_Çive
(
švA2
, 
A
);

41 
t
 = 
	`G‘Time
() -;

42 
cout
 << 
t
 << " ";

44 
cout
 << 
’dl
;

47 
	}
}

54 
	$maš
(
¬gc
, ** 
¬gv
){

55 
İt
 = 0;

56 ià(
¬gc
 > 1)

57 
İt
 = 
	`©oi
(
¬gv
[1]);

58 
	`check
(
İt
);

61 
	}
}

	@vec_lzz_p_extra/vec_lzz_p_extra.h

1 #iâdeà
__VEC_LZZ_P_EXTRA_H


2 
	#__VEC_LZZ_P_EXTRA_H


	)

4 
	~<NTL/m©_lzz_p.h
>

5 
	~<NTL/vec_lzz_p.h
>

7 
NTL_CLIENT


12 
¿ndom
(
vec_zz_p
& 
A
, 
d
);

17 
¿ndom
(
m©_zz_p
& 
A
, 
d
, 
e
);

22 
šv_Çive
(
vec_zz_p
& 
švA
, cÚ¡ vec_zz_p& 
A
);

27 
šv
(
vec_zz_p
& 
švA
, cÚ¡ vec_zz_p& 
A
);

32 
šv
(
vec_zz_p
& 
A
);

34 #ifdeà
NTL_HAVE_LL_TYPE


38 
IÂ”Prod_LL
(cÚ¡ *
­
, cÚ¡ *
bp
, 
n
);

39 
IÂ”Prod_L
(cÚ¡ *
­
, cÚ¡ *
bp
, 
n
);

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (#ex´, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


119 #undeà
¡©ic_as£¹


120 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

35 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


54 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

65 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

69 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

74 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 #ifdeà
__OPTIMIZE__


78 
__ex‹º_®ways_šlše
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


81  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

84 
__ex‹º_®ways_šlše
 const *

85 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


87  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifdeà
__USE_GNU


100 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

106 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

117 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

128 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

129 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

133 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

137 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

141 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

150 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

151 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
 
	`__nÚnuÎ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifdeà
__USE_XOPEN2K8


159 
	~<xloÿË.h
>

162 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

163 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

165 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

166 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

169 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


171 *
	$¡rdup
 (cÚ¡ *
__s
)

172 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_XOPEN2K8


179 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

180 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


185 
	#¡rdu·
(
s
) \

186 (
__ex‹nsiÚ__
 \

188 cÚ¡ *
__Şd
 = (
s
); \

189 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

190 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

191 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

192 
	}
}))

	)

195 
	#¡ºdu·
(
s
, 
n
) \

196 (
__ex‹nsiÚ__
 \

198 cÚ¡ *
__Şd
 = (
s
); \

199 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

200 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

201 
__Ãw
[
__Ën
] = '\0'; \

202 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

203 }))

	)

206 
	g__BEGIN_NAMESPACE_STD


208 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


211 *
¡rchr
 (*
__s
, 
__c
)

212 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

213 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

214 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

216 #ifdeà
__OPTIMIZE__


217 
__ex‹º_®ways_šlše
 *

218 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

223 
__ex‹º_®ways_šlše
 const *

224 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


226  
__butš_¡rchr
 (
__s
, 
__c
);

231 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

232 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

235 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


238 *
	`¡¼chr
 (*
__s
, 
__c
)

239 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

243 #ifdeà
__OPTIMIZE__


244 
__ex‹º_®ways_šlše
 *

245 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
__ex‹º_®ways_šlše
 const *

251 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


253  
	`__butš_¡¼chr
 (
__s
, 
__c
);

256 
	}
}

258 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

259 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

261 
__END_NAMESPACE_STD


263 #ifdeà
__USE_GNU


266 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


267 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

268 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

269 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 
__BEGIN_NAMESPACE_STD


280 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

281 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


290 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

291 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

293 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

295 #ifdeà
__OPTIMIZE__


296 
__ex‹º_®ways_šlše
 *

297 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


299  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

302 
__ex‹º_®ways_šlše
 const *

303 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


305  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

308 
	}
}

310 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

311 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


317 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

318 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

320 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

322 #ifdeà
__OPTIMIZE__


323 
__ex‹º_®ways_šlše
 *

324 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


326  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

329 
__ex‹º_®ways_šlše
 const *

330 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


332  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

335 
	}
}

337 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

338 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

343 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

344 
__THROW
 
	`__nÚnuÎ
 ((2));

345 
__END_NAMESPACE_STD


349 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

350 cÚ¡ *
__»¡riù
 
__d–im
,

351 **
__»¡riù
 
__§ve_±r
)

352 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

353 #ifdeà
__USE_POSIX


354 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

355 **
__»¡riù
 
__§ve_±r
)

356 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

359 #ifdeà
__USE_GNU


361 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


362 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

363 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

365 cÚ¡ *
__ÃedË
)

366 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

368 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

369 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 #ifdeà
__USE_GNU


377 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

378 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

379 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

383 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

384 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

385 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

387 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

388 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

392 
__BEGIN_NAMESPACE_STD


394 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

395 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 
__END_NAMESPACE_STD


398 #ifdef 
__USE_XOPEN2K8


401 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

402 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

406 
__BEGIN_NAMESPACE_STD


408 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

409 
__END_NAMESPACE_STD


410 #ifdeà
__USE_XOPEN2K


418 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


421 #ifdeà
__REDIRECT_NTH


422 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

423 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

424 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

426 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

427 
__THROW
 
	`__nÚnuÎ
 ((2));

428 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

433 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

434 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

438 #ifdeà
__USE_XOPEN2K8


440 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

446 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

448 #ifdeà
__USE_MISC


450 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

451 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

457 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

458 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

461 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


464 *
	`šdex
 (*
__s
, 
__c
)

465 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

466 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

467 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

469 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


470 
__ex‹º_®ways_šlše
 *

471 
	`šdex
 (*
__s
, 
__c
è
__THROW


473  
	`__butš_šdex
 (
__s
, 
__c
);

476 
__ex‹º_®ways_šlše
 const *

477 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


479  
	`__butš_šdex
 (
__s
, 
__c
);

482 
	}
}

484 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

485 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

489 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


492 *
	`ršdex
 (*
__s
, 
__c
)

493 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

495 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

497 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


498 
__ex‹º_®ways_šlše
 *

499 
	`ršdex
 (*
__s
, 
__c
è
__THROW


501  
	`__butš_ršdex
 (
__s
, 
__c
);

504 
__ex‹º_®ways_šlše
 const *

505 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


507  
	`__butš_ršdex
 (
__s
, 
__c
);

510 
	}
}

512 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

513 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

518 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

522 #ifdef 
__USE_GNU


523 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

524 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

525 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

530 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

533 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

534 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

537 #ifdef 
__USE_GNU


540 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

541 
__loÿË_t
 
__loc
)

542 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

544 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

545 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

546 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

549 #ifdef 
__USE_MISC


552 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

553 cÚ¡ *
__»¡riù
 
__d–im
)

554 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdef 
__USE_XOPEN2K8


559 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

562 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

563 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

564 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

565 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

570 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

571 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

572 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

573 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 #ifdef 
__USE_GNU


579 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

580 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

583 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

586 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

588 #iâdeà
ba£Çme


593 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


594 "C++" *
	$ba£Çme
 (*
__f’ame
)

595 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

596 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

597 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

599 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

605 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

606 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

607 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


627 
	~<b™s/¡ršg.h
>

630 
	~<b™s/¡ršg2.h
>

633 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


635 
	~<b™s/¡ršg3.h
>

639 #ià
defšed
 
__USE_GNU
 && defšed 
__OPTIMIZE__
 \

640 && 
defšed
 
__ex‹º_®ways_šlše
 && 
	$__GNUC_PREREQ
 (3,2)

641 #ià!
defšed
 
_FORCE_INLINES
 && !defšed 
_HAVE_STRING_ARCH_mempıy


643 #undeà
mempıy


644 #undeà
__mempıy


645 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy_šlše
 (de¡, src,‚)

	)

646 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy_šlše
 (de¡, src,‚)

	)

648 
__ex‹º_®ways_šlše
 *

649 
	$__mempıy_šlše
 (*
__»¡riù
 
__de¡
,

650 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

652  (*è
	`memıy
 (
__de¡
, 
__¤c
, 
__n
) + __n;

653 
	}
}

658 
	g__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ifdeà
__USE_POSIX


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_MISC


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ifdeà
__USE_POSIX


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ifdeà
__USE_POSIX


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_MISC


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


152 #undeà
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifdeà
_GNU_SOURCE


158 #undeà
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #undeà
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #undeà
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #undeà
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #undeà
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #undeà
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #undeà
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #undeà
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #undeà
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #undeà
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #ià(
defšed
 
_DEFAULT_SOURCE
 \

183 || (!
defšed
 
	g__STRICT_ANSI__
 \

184 && !
defšed
 
	g_ISOC99_SOURCE
 \

185 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

186 && !
defšed
 
	g_XOPEN_SOURCE
))

187 #undeà
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC11_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

205 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

214 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifdeà
_DEFAULT_SOURCE


222 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #undeà
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #undeà
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #ià((!
defšed
 
__STRICT_ANSI__
 \

231 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #ià(
defšed
 
_POSIX_SOURCE
 \

247 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defšed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #undeà
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #undeà
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #undeà
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #ià(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #undeà
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #ià(
_XOPEN_SOURCE
 - 0) >= 600

286 #ià(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #undeà
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #undeà
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifdeà
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifdeà
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifdeà
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #ià
defšed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<¡dc-´edef.h
>

353 #undeà
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

362 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

365 #iâdeà
__ASSEMBLER__


366 #iâdeà
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

381 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

382 && 
defšed
 
	g__ex‹º_šlše


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/¡ubs.h
>

	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@
1
.
1
/usr/include
158
6187
ZZ_CRT/ZZ_CRT.h
ZZ_CRT/ratrecon.h
ZZ_CRT/src/ZZ_CRT.cpp
ZZ_CRT/test/test_CRT_basic.cpp
ZZ_CRT/test/test_CRT_fast.cpp
ZZ_CRT/test/test_CRT_tbl.cpp
ZZ_CRT/test/test_ZZ_CRT.cpp
ZZ_CRT/test/test_multimod_ZZX.cpp
ZZ_CRT/test/test_multimod_basic.cpp
ZZ_CRT/test/test_multimod_fast.cpp
ZZ_CRT/test/test_multimod_medium.cpp
ZZ_CRT/test/test_multimod_tbl.cpp
ZZ_CRT/test/test_ratrecon.cpp
ZZ_pX_CRT/ZZ_pX_CRT.h
ZZ_pX_CRT/src/ZZ_pX_CRT.cpp
ZZ_pX_CRT/test/test_ZZ_pX_CRT_FFT_evaluate.cpp
ZZ_pX_CRT/test/test_ZZ_pX_CRT_FFT_evaluate_shifted.cpp
ZZ_pX_CRT/test/test_find_root_of_unity.cpp
ZZ_pX_CRT/test/test_lift_root_of_unity.cpp
bivariate/ZZXY.h
bivariate/lzz_pEX_augmented.h
bivariate/lzz_pXY.h
bivariate/src/ZZXY.cpp
bivariate/src/lzz_pEX_augmented.cpp
bivariate/src/lzz_pXY.cpp
bivariate/test/test_ZZXY_iostream.cpp
bivariate/test/test_ZZXY_solve.cpp
bivariate/test/test_pair_zz_pEX_augmented_combine.cpp
bivariate/test/test_pair_zz_pEX_augmented_mod.cpp
bivariate/test/test_pair_zz_pEX_augmented_multimod.cpp
bivariate/test/test_random_pair_zz_pEX_augmented.cpp
bivariate/test/test_random_zz_pEX_augmented.cpp
bivariate/test/test_random_zz_pXY.cpp
bivariate/test/test_reduce.cpp
bivariate/test/test_regular_gcd.cpp
bivariate/test/test_resultant.cpp
bivariate/test/test_split.cpp
bivariate/test/test_split_for_regularize.cpp
bivariate/test/test_zz_pEX_augmented.cpp
bivariate/test/test_zz_pEX_augmented_combine.cpp
bivariate/test/test_zz_pEX_augmented_make_monic.cpp
bivariate/test/test_zz_pEX_augmented_mod.cpp
bivariate/test/test_zz_pEX_augmented_multimod.cpp
bivariate/test/test_zz_pXY.cpp
bivariate/test/test_zz_pXY_diffY.cpp
bivariate/test/test_zz_pXY_magma_output.cpp
bivariate/test/test_zz_pXY_solve.cpp
bivariatemodularcomp/bivariatemodularcomp.h
bivariatemodularcomp/mat_ZZX.h
bivariatemodularcomp/mat_ZZ_pX.h
bivariatemodularcomp/src/bivariatemodularcomp.cpp
bivariatemodularcomp/src/mat_ZZX.cpp
bivariatemodularcomp/src/mat_ZZ_pX.cpp
bivariatemodularcomp/test/test_hankeltest.cpp
bivariatemodularcomp/test/test_test.cpp
cauchy_like_geometric_special/cauchy_geometric_special.h
cauchy_like_geometric_special/src/cauchy_geometric_special.cpp
cauchy_like_geometric_special/src/cauchy_like_geometric_special.cpp
cauchy_like_geometric_special/src/mat_addmul.cpp
cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_invert.cpp
cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_invert_dac.cpp
cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_mul_left.cpp
cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_mul_right.cpp
cauchy_like_geometric_special/test/test_cauchy_like_geometric_special_to_dense.cpp
cauchy_like_geometric_special/test/test_init_cauchy_geometric_special.cpp
cauchy_like_geometric_special/test/test_init_cauchy_like_geometric_special.cpp
hermite_pade/hermite_pade.h
hermite_pade/src/hermite_pade.cpp
include/ZZXY.h
include/ZZ_CRT.h
include/ZZ_pX_CRT.h
include/bivariatemodularcomp.h
include/cauchy_geometric_special.h
include/hermite_pade.h
include/lzz_pEX_augmented.h
include/lzz_pXY.h
include/lzz_pX_CRT.h
include/lzz_pX_middle_product.h
include/lzz_p_extra.h
include/magma_output.h
include/mat_ZZX.h
include/mat_ZZ_pX.h
include/mat_lzz_pX_extra.h
include/mosaic_hankel.h
include/ratrecon.h
include/sage_output.h
include/vec_lzz_p_extra.h
lzz_pX_CRT/lzz_pX_CRT.h
lzz_pX_CRT/src/lzz_pX_CRT.cpp
lzz_pX_CRT/src/lzz_pX_Multipoint_FFT.cpp
lzz_pX_CRT/src/lzz_pX_Multipoint_General.cpp
lzz_pX_CRT/src/lzz_pX_Multipoint_Geometric.cpp
lzz_pX_CRT/test/test_CRT.cpp
lzz_pX_CRT/test/test_FFT_evaluate_interpolate.cpp
lzz_pX_CRT/test/test_evaluate.cpp
lzz_pX_CRT/test/test_geometric_evaluate.cpp
lzz_pX_CRT/test/test_geometric_evaluate_matrix.cpp
lzz_pX_CRT/test/test_geometric_evaluate_shifted.cpp
lzz_pX_CRT/test/test_geometric_evaluate_small_degree.cpp
lzz_pX_CRT/test/test_geometric_interpolate.cpp
lzz_pX_CRT/test/test_geometric_interpolate_shifted.cpp
lzz_pX_CRT/test/test_geometric_to_dense.cpp
lzz_pX_CRT/test/test_interpolate.cpp
lzz_pX_CRT/test/test_points.cpp
lzz_pX_CRT/test/test_zz_pX_Multipoint.cpp
lzz_pX_middle_product/lzz_pX_middle_product.h
lzz_pX_middle_product/src/lzz_pX_middle_product.cpp
lzz_pX_middle_product/test/test_middle_product_FFT.cpp
lzz_pX_middle_product/test/test_middle_product_non_FFT.cpp
lzz_p_extra/lzz_p_extra.h
lzz_p_extra/src/lzz_p_extra.cpp
lzz_p_extra/test/test_element_of_order.cpp
lzz_p_extra/test/test_order.cpp
magma_output/magma_output.h
magma_output/src/magma_output.cpp
magma_output/test/test_magma_output.cpp
mat_lzz_pX_extra/mat_lzz_pX_extra.h
mat_lzz_pX_extra/src/mat_lzz_pX_extra.cpp
mat_lzz_pX_extra/test/test_magma_output.cpp
mat_lzz_pX_extra/test/test_multiply.cpp
mat_lzz_pX_extra/test/test_random.cpp
mosaic_hankel/mosaic_hankel.h
mosaic_hankel/src/hankel.cpp
mosaic_hankel/src/mosaic_hankel.cpp
mosaic_hankel/test/test_first_column_of_block.cpp
mosaic_hankel/test/test_first_row_of_block.cpp
mosaic_hankel/test/test_hankel_init.cpp
mosaic_hankel/test/test_hankel_mul_left.cpp
mosaic_hankel/test/test_hankel_mul_right.cpp
mosaic_hankel/test/test_hankel_to_dense.cpp
mosaic_hankel/test/test_last_column_of_block.cpp
mosaic_hankel/test/test_last_row_of_block.cpp
mosaic_hankel/test/test_mosaic_first_column_of_block.cpp
mosaic_hankel/test/test_mosaic_first_row_of_block.cpp
mosaic_hankel/test/test_mosaic_generators.cpp
mosaic_hankel/test/test_mosaic_init.cpp
mosaic_hankel/test/test_mosaic_last_column_of_block.cpp
mosaic_hankel/test/test_mosaic_last_row_of_block.cpp
mosaic_hankel/test/test_mosaic_mul_left.cpp
mosaic_hankel/test/test_mosaic_mul_right.cpp
mosaic_hankel/test/test_mosaic_to_dense.cpp
mosaic_hankel/test/test_mul_left.cpp
mosaic_hankel/test/test_mul_left_mosaic.cpp
mosaic_hankel/test/test_mul_right.cpp
mosaic_hankel/test/test_mul_right_mosaic.cpp
mosaic_hankel/test/test_to_cauchy_grp.cpp
sage_output/sage_output.h
sage_output/src/sage_output.cpp
sage_output/test/test_sage_output.cpp
vec_lzz_p_extra/src/vec_lzz_p_extra.cpp
vec_lzz_p_extra/test/test_inv.cpp
vec_lzz_p_extra/vec_lzz_p_extra.h
/usr/include/assert.h
/usr/include/string.h
/usr/include/time.h
/usr/include/features.h
/usr/include/xlocale.h
/usr/include/stdc-predef.h
